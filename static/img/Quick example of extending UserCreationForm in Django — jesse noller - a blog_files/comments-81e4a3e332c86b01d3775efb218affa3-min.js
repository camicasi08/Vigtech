YUI.add("squarespace-comments",function(a){a.namespace("Squarespace");a.Squarespace.Comments=Class.create({initialize:function(b){this.settings={likesAllowed:b.likesAllowed,flagsAllowed:b.flagsAllowed,threaded:b.threaded,approvalRequired:b.approvalRequired,allowAnon:b.allowAnon,avatarsHidden:!b.avatarsOn,readOnly:b.readOnly};this.commentData=new a.Squarespace.CommentData({target:b.identifier,targetType:b.type,settings:this.settings,formatter:a.bind(this.formatData,this)});this.targetId=b.identifier;
this.params=b||{design:{}};this.replyCompleteEvents={};this.threadState=!1;this.lastSortTime=new Date;this.lastHashChangeTime=new Date;this.PaginationModes={EXTEND:1,PAGE:2};this.containerEl=a.one(this.params.containerEl);this.params.paginationMode=this.PaginationModes.EXTEND;this.type=a.Squarespace.BlockType.COMMENT;this.currentPage=1;this.maxComments=50;this.sortOrderLookup=[null];this.sortOrderLookup.push("Oldest First","Newest First","Most Liked","Least Liked");this.sortOrder=this.params.sortType;
this.commentsEl=a.DB.DIV("comments-content",a.DB.DIV("comment-list"));this.settings.readOnly&&this.commentsEl.addClass("read-only");this.commentsEl.appendTo(this.containerEl);this.loadMoreNode=a.DB.DIV("load-more",a.DB.DIV("view-more-btn",{html:"Load More Comments"}));this.fullViewNode=a.DB.DIV("full-view-btn",{html:"View full comment thread"});this.history=new a.HistoryHash;this.commentsEl.delegate("click",this.onReplyToggleClick,".reply",this);this.commentsEl.delegate("click",this.onLikeClick,".comment:not(.liked):not(.read-only) .like",
this);this.commentsEl.delegate("click",this.onUnlikeClick,".comment.liked:not(.read-only) .like",this);this.commentsEl.delegate("click",this.onFlagClick,".comment:not(.flagged):not(.read-only) .flag",this);this.commentsEl.delegate("click",this.onUnflagClick,".comment.flagged:not(.read-only) .flag",this);this.commentsEl.delegate("click",this.onApproveClick,".comment.unmoderated:not(.read-only) .approve",this);this.commentsEl.delegate("click",this.onDeleteClick,".comment:not(.read-only) .delete",this);
this.commentsEl.delegate("click",this.replyBtnOnClick,".reply-area-wrapper .comment-btn:not(.read-only)",this);this.commentsEl.delegate("click",this.togglePreview,".reply-area-wrapper .preview-comment",this);this.commentsEl.delegate("click",this.showSubscribe,".subscribe",this);this.commentsEl.delegate("click",this.unsubscribe,".unsubscribe",this);this.history.on("commentIdChange",this.commentIdHashOnChange,this);this.history.on("commentIdRemove",this.commentIdHashOnRemove,this);this.containerEl.delegate("click",
function(){var a,b,f;return function(c){SQUARESPACE_LOGIN.configure({redirectAfterLogin:!1,reloadAfterLogin:!1,allowAnonymous:this.settings.allowAnon,overlayOpacity:0.5});c=function(){this.onLoading();this.commentData.visibleComments=0;this.retrieveComments({onSuccess:function(a){this.fullDataRender(a)},page:1,order:this.sortOrder},this);a.detach();f.detach()};a=SQUARESPACE_LOGIN.once("cancel",function(){b.detach();f.detach()},this);b=SQUARESPACE_LOGIN.once("login",c,this);f=SQUARESPACE_LOGIN.once("guestLogin",
c,this);SQUARESPACE_LOGIN.show()}}(),".squarespace-comment-login",this);SQUARESPACE_LOGIN.on("login",function(){this.updateLikedFlaggedState();this.refreshCommentPostButtons();this.moderationMode=a.Squarespace.Utils.userHasAccessPermission(a.Squarespace.AccessPermissions.CONFIG_ACTIVITY_COMMENTS)},this);SQUARESPACE_LOGIN.on("logout",function(){this.updateLikedFlaggedState();this.refreshCommentPostButtons();this.refreshSubscribeControl();this.moderationMode=!1},this);this.containerEl.delegate("click",
function(a){SQUARESPACE_LOGIN.onLogoutClick()},".squarespace-comment-logout",this);this.containerEl.delegate("focus",function(){this.set("text","");this.setAttribute("data-edited",!0)},".comment-input");this.containerEl.delegate("blur",function(){""===this.get("value")&&this.setAttribute("data-edited",!1)},".comment-input");this.containerEl.delegate("focus",function(a){a.target.setAttribute("data-edited",!0)},".new-comment-area textArea",this);this.containerEl.delegate("click",this.extendComments,
".view-more-btn",this);this.containerEl.delegate("click",this.fullViewOnClick,".full-view-btn",this);this.containerEl.delegate("click",this.commentBtnOnClick,".top-level-comment-area .comment-btn:not(.read-only)",this);this.containerEl.delegate("click",this.togglePreview,".top-level-comment-area .preview-comment",this);this.containerEl.delegate("change",function(a){this.sort(a.target.get("value"))},".hidden-ordering",this);a.Cookie.remove("displayName",{path:"/"});this.subscribeDialogParams={name:"subscribe",
style:"flyout",flyoutPointerDirection:"top",width:320,position:"center",closeable:!0,overlay:0.5,top:200,discardChangesConfirmation:!1,title:"Subscribe by Email",primaryTabs:[{title:"Subscribe by Email",icon:"/universal/images-v6/standard/icon_invites_24_light.png",fields:[{type:"text",required:!0,name:"email",title:"Email",fieldStyle:"normal",titleStyle:"inline",submitOnEnter:!0,style:"major"},{ctor:a.Squarespace.DialogFields.Description,config:{text:"Subscribe to this comment thread by email.",
padding:[0,0]}}]}],buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:"Submit"}]}},doAfterLogin:function(a,d,g){var f,c,h;c=a.once("login",function(){d.call(this);h.detach();f.detach()},g);h=a.once("guestLogin",function(){c.detach();f.detach()});f=a.once("cancel",function(){c.detach();h.detach()})},doAfterGuestLogin:function(a,d,g){var f,c,h;c=a.once("guestLogin",function(){d.call(this);h.detach();f.detach()},g);h=a.once("login",function(){c.detach();f.detach()});f=a.once("cancel",
function(){c.detach();h.detach()})},fullViewOnClick:function(){this.history.addValue("commentId",null)},updateTopLevelButton:function(){var b=a.one(".top-level-comment-area .comment-btn"),d=this.renderToFragment({newCommentAreaTop:{authenticatedAccount:null===SQUARESPACE_LOGIN.account?void 0:SQUARESPACE_LOGIN.account},comments:[{}]}).one(".top-level-comment-area .comment-btn");b&&(b.ancestor(".comment-btn-wrapper").append(d),b.remove(!0))},updateReplyAreaButtons:function(){var a=this.renderToFragment({comments:[{authenticatedAccount:SQUARESPACE_LOGIN.account}]}).one(".reply-area-wrapper .comment-btn");
a&&this.commentsEl.all(".reply-area-wrapper .comment-btn").each(function(d){d.insert(a.cloneNode(!0),"after");d.remove(!0)})},refreshCommentPostButtons:function(){this.updateTopLevelButton();this.updateReplyAreaButtons()},refreshSubscribeControl:function(){SQUARESPACE_LOGIN.account||(Static.SQUARESPACE_CONTEXT.subscribed=!1);var b,d=this.renderToFragment(this.scatterData({subscribed:Static.SQUARESPACE_CONTEXT.subscribed,comments:[{}]})).one(".subscribe-control");d&&(b=a.one(".subscribe-control"),
b.insert(d,"after"),b.remove(!0))},generatePreview:function(b){var d=a.Squarespace.Escaping.escapeForHtml(b.get("value")),g={comments:[{}]},f=null,c=null,f=g.comments[0];b.ancestor(".reply-area-wrapper");var h=!b.ancestor(".reply-area-wrapper"),k;h?b=0:(k=a.one('.comment[data-commentId="'+b.ancestor(".reply-area-wrapper").getAttribute("data-commentId")+'"]'),b=k.hasAttribute("data-depth")?parseInt(k.getAttribute("data-depth"),10)+1:1);f.body=a.Squarespace.Lang.markdownToHTML(a.Squarespace.Utils.preFormatMarkdown(d));
f.memberAccount=a.clone(SQUARESPACE_LOGIN.account);f.authorName=(SQUARESPACE_LOGIN.account?SQUARESPACE_LOGIN.account.displayName:a.Cookie.get("displayName"))||"Not Logged In";f.addedOn=(new Date).getTime();f.depth=b;c=this.renderToFragment(this.scatterData(g));f=c.one(".comment");f.addClass("comment-preview");h?f.addClass("top-level"):(f.setAttribute("data-previewId",k.getAttribute("data-commentId")),f.setAttribute("data-replyTo",k.getAttribute("data-commentId")));return c},replyBtnOnClick:function(b){var d=
b.target.ancestor(".reply-area-wrapper"),g=d.getAttribute("data-commentId"),f=a.one('.comment[data-commentId="'+g+'"]'),g=d.one("textArea"),c=g.get("value");""===c.trim()?this.showEmptyText():(f=this.injectReply(c,f),this.replyTo(d.getAttribute("data-commentId"),c,f,g));b.stopImmediatePropagation()},subscribe:function(b){a.Data.post({url:"/api/comment/Subscribe",secure:!0,data:{targetId:this.targetId},success:function(){Static.SQUARESPACE_CONTEXT.subscribed=!0;this.refreshSubscribeControl();new a.Squarespace.Widgets.Information({"strings.title":"Subscribed",
"strings.message":"Successfully subscribed"})},failure:function(){SQUARESPACE_LOGIN.configure({redirectAfterLogin:!1,reloadAfterLogin:!1,overlayOpacity:0.5});this.doAfterLogin(SQUARESPACE_LOGIN,function(){this.subscribe(b)},this);SQUARESPACE_LOGIN.showCommentLogin("Log In to Subscribe","Subscribe",!1)}},this)},unsubscribe:function(b){a.Data.post({url:"/api/comment/Unsubscribe",secure:!0,data:{targetId:this.targetId},success:function(){Static.SQUARESPACE_CONTEXT.subscribed=!1;this.refreshSubscribeControl();
new a.Squarespace.Widgets.Information({"strings.title":"Unsubscribed","strings.message":"Successfully unsubscribed"})},failure:function(a){a.loginRequired&&(SQUARESPACE_LOGIN.configure({redirectAfterLogin:!1,reloadAfterLogin:!1,overlayOpacity:0.5}),this.doAfterLogin(SQUARESPACE_LOGIN,function(){this.unsubscribe(b)},this),SQUARESPACE_LOGIN.showCommentLogin("Log In to Unsubscribe","Unsubscribe",!1))}},this)},showSubscribe:function(b){(new a.Squarespace.Widgets.Confirmation({"strings.confirm":"Subscribe",
"strings.title":"Subscribe to Thread","strings.message":"Are you sure you wish to subscribe to this comment thread?You will receive updates via the email on file in your profile."})).on("confirm",this.subscribe,this)},togglePreview:function(a){var d=a.target.ancestor(".reply-area-wrapper"),d=d?d.one("textArea"):a.target.ancestor(".top-level-comment-area").one("textArea");""!==d.get("value")&&("open"===a.target.getAttribute("data-state")?(a.target.setAttribute("data-state","closed"),this.hidePreview(d)):
(a.target.setAttribute("data-state","open"),this.showPreview(d)))},showPreview:function(b){if(b){var d=this.generatePreview(b).one(".comment"),c=b.ancestor(".reply-area-wrapper"),f=b.ancestor(".input"),e=!c,h;d.wrap('<div class="new comment-preview-wrapper closed"></div>');h=d.ancestor(".comment-preview-wrapper");e?(h.addClass("top-level"),a.one(".comment-list").prepend(h)):(c.insert(h,"after"),h.setAttribute("data-commentId",c.getAttribute("data-commentId")));b.ancestor(".new-comment-area").one(".preview-comment").set("innerHTML",
"Edit");f.setStyle("height",f.get("offsetHeight"));b=new a.Anim({node:f,duration:0.3,easing:a.Easing.easeOutStrong,to:{height:0}});b.on("start",function(){this._node.setStyle("overflow","hidden")});b.run();d=new a.Anim({node:h,duration:0.3,easing:a.Easing.easeOutStrong,to:{height:d.get("offsetHeight")+parseInt(d.getComputedStyle("paddingBottom"),10)+parseInt(d.getComputedStyle("marginBottom"),10)}});d.on("end",function(){this._node.addClass("open")});d.run()}},hideAllPreviews:function(){a.all(".comment-preview-wrapper:not(.top-level)").each(function(b){b=
new a.Anim({node:b,duration:0.3,easing:a.Easing.easeOutStrong,to:{height:0}});b.on("end",function(){this._node.remove(!0)});b.run()},this);a.all('.preview-comment[data-state="open"]:not(.top-level-preview-btn)').each(function(a){a.setAttribute("data-state","closed");a.set("innerHTML","Preview")},this)},hidePreview:function(b){if(b){var d=b.ancestor(".reply-area-wrapper"),d=d?a.one('.comment-preview[data-previewId="'+d.getAttribute("data-commentId")+'"]'):a.one(".comment-preview.top-level");b.ancestor(".new-comment-area").one(".preview-comment").set("innerHTML",
"Preview");b=new a.Anim({node:b.ancestor(".input"),duration:0.3,easing:a.Easing.easeOutStrong,to:{height:b.get("offsetHeight")}});b.on("end",function(){this._node.setStyle("overflow","visible")});b.run();d&&(b=d.ancestor(".comment-preview-wrapper"),b=new a.Anim({node:b,duration:0.3,easing:a.Easing.easeOutStrong,to:{height:0}}),b.on("start",function(){this._node.removeClass("open");this._node.addClass("closed")}),b.on("end",function(){this._node.remove(!0)}),b.run())}},getTemplateData:function(b,d){a.Data.get({url:"/api/template/GetTemplateSchema",
data:{type:a.Squarespace.BlockType.COMMENTS,componentType:"widget"},success:function(d){this._template=new a.JSONTemplate.Template(d.html);b.call(this)},failure:d},this)},updateLikedFlaggedState:function(){(this.settings.flagsAllowed||this.settings.likesAllowed)&&this.commentData.getLikesAndFlags({success:function(b){a.one(".comment-list").all(".comment").each(function(a){var c=a.getAttribute("data-commentId");this.settings.flagsAllowed&&(b.flagMap[c]?a.addClass("flagged"):a.removeClass("flagged"));
this.settings.likesAllowed&&(b.likeMap[c]?a.addClass("liked"):a.removeClass("liked"))},this)}},this)},create:function(){a.Squarespace.Utils.userHasAccessPermission(a.Squarespace.AccessPermissions.CONFIG_ACTIVITY_COMMENTS)&&(this.moderationMode=!0);this.getTemplateData(function(){var b=this.history.get("commentId");a.Lang.isUndefined(b)?(this.onLoading(),this.retrieveComments({onSuccess:function(a){this.fullDataRender(a)},page:1,order:this.sortOrder})):(this.onLoading(),this.retrieveThread({onSuccess:this.threadRender,
onFailure:function(a){this.onLoading();this.retrieveComments({onSuccess:function(a){this.fullDataRender(a)},page:1,order:this.sortOrder})},order:this.sortOrder,commentId:b}))},function(){})},updateCommentCounts:function(){var b=this.renderToFragment({visibleComments:this.commentData.visibleComments,totalComments:this.commentData.totalComments,comments:[]});0===this.commentData.visibleComments?this.containerEl.addClass("empty"):this.containerEl.removeClass("empty");a.one(".comment-count").set("innerHTML",
b.one(".comment-count").get("innerHTML"))},truncateAt:function(a,d){if(!a)return"";if(void 0===d)return a;var c=a.split(" ").slice(0,d).join(" ");return c+(c.length>d?"."===c.substr(c.length-1)?"..":"...":"")},buildInfoPane:function(b){var d=a.DB.DIV("squarespace-user-info",a.DB.DIV("user-info-header",a.DB.DIV("avatar",a.DB.IMG("",{src:(b.avatarAssetUrl?b.avatarAssetUrl:"/universal/images-v6/default-avatar.png")+"?format=50w"})),a.DB.DIV("info",a.DB.DIV("name",{html:b.displayName}),a.DB.A("website",
{href:b.websiteUrl?"http://"+a.Squarespace.Escaping.escapeForHtml(b.websiteUrl):"",html:b.websiteUrl||""}))),a.DB.DIV("user-info-body",{html:"<p>"+this.truncateAt(a.Squarespace.Escaping.escapeForHtml(b.bio,60))+"</p>"}),a.DB.DIV("user-social-opts",a.DB.DIV("social-leftcol"),a.DB.DIV("social-rightcol"),a.DB.DIV("clearfix"))),c=d.one(".social-leftcol"),f=d.one(".social-rightcol"),e=function(){var a=function(a,b){return function(b){return"http://"+a+".com/"+b}};return{foursquare:function(a){return null===
/[a-zA-Z]/.exec(a)?"http://www.foursquare.com/user/"+a:"http://www.foursquare.com/"+a},facebook:a("facebook"),twitter:a("twitter")}}();if(b.socialOptions)for(var h=0;h<b.socialOptions.length;h++){var k=a.DB.DIV("social-widget",a.DB.A("",{href:e[b.socialOptions[h].type](b.socialOptions[h].username)},a.DB.IMG("social-icon",{src:"foursquare"===b.socialOptions[h].type?"/universal/images-v6/member/icon-foursquare-small.png":"/universal/images-v6/social/"+b.socialOptions[h].type+"_16.png"})),a.DB.A("social-name",
{html:b.socialOptions[h].type,href:e[b.socialOptions[h].type](b.socialOptions[h].username)}));0===h%2?c.append(k):f.append(k)}return d},showClickOverlay:function(){var b=a.one(document),d=b.get("winHeight"),b=b.get("winWidth");this.overlayEl=a.DB.DIV("user-profile-overlay");this.overlayEl.setStyles({position:"fixed",background:"#000",height:d+"px",width:b+"px",opacity:"0",top:"0px",left:"0px",zIndex:999});a.one(a.config.doc.body).append(this.overlayEl);a.on("click",this.hideUserProfileFlyout,this.overlayEl,
this)},showUserProfileFlyout:function(b){if(!b.target.hasClass("squarespace-comment-user-flyout")&&!b.target.ancestor(".squaresapce-comment-user-flyout")&&!this.flyoutOpen){var d=b.target.ancestor(".comment").getAttribute("data-commentid"),d=this.commentData.getCommentById(d).memberAccount;if(!d)return;d=a.DB.DIV("squarespace-comment-user-flyout",this.buildInfoPane(d),a.DB.DIV("squarespace-user-activity",a.DB.DIV("squarespace-activity-header",a.DB.DIV("title",{html:"Activity"}),a.DB.DIV("description",
{html:"Comments and likes across the Squarespace platform"})),a.DB.DIV("feed")),a.DB.DIV("squarespace-comment-user-clearfix"));a.one(document.body).append(d);d.setStyles({position:"fixed",left:"50%",top:"50%",opacity:0,zIndex:1E3,transform:"scale(.95)"});d.setStyles({marginTop:-(parseInt(d.get("offsetHeight"),10)/2),marginLeft:-(parseInt(d.get("offsetWidth"),10)/2)});d.transition({WebkitTransform:{duration:0.3,easing:"ease-out",value:"scale(1)"},opacity:{duration:0.3,easing:"ease-out",value:1}})}this.flyoutOpen=
!0;this.showClickOverlay();b.stopImmediatePropagation()},hideUserProfileFlyout:function(b){if(this.flyoutOpen){var d=a.one(".squarespace-comment-user-flyout");d&&d.transition({WebkitTransform:{duration:0.3,easing:"ease-out",value:"scale(1.08)"},opacity:{duration:0.4,easing:"ease-out",value:0},on:{end:a.bind(function(){d.remove(!0);b.target.remove(!0);this.flyoutOpen=!1},this)}})}},getThreadNodes:function(b,d){var c=b.getAttribute("data-commentId");d.push(b);a.all('.comment[data-replyTo="'+c+'"]').each(function(a){this.getThreadNodes(a,
d)},this)},actualDelete:function(b,d,c){var f=b.target.ancestor(".comment"),e=f.getAttribute("data-commentId"),h,k,m=this.lastSortTime,s=this.lastHashChangeTime;this.commentData._delete({comments:[e],spam:d,success:function(b){m===this.lastSortTime&&s===this.lastHashChangeTime&&(h=a.DB.DIV("delete-anim-wrapper"),f.insert(h,"after"),c.forEach(function(b){h.append(b);(b=a.one('.reply-area-wrapper[data-commentId="'+b.getAttribute("data-commentId")+'"]'))&&b.remove(!0)}),k=new a.Anim({node:h,duration:0.5,
easing:a.Easing.easeOutStrong,to:{height:0}}),k.on("end",function(){h.remove(!0);1<c.length&&this.commentData.removeCommentsByIds(c.map(function(a){return a.getAttribute("data-commentId")}).filter(function(a){return a!==e}));this.updateCommentCounts()},this),k.run())},failure:function(f){f.loginRequired?(SQUARESPACE_LOGIN.configure({redirectAfterLogin:!1,reloadAfterLogin:!1,overlayOpacity:0.5}),this.doAfterLogin(SQUARESPACE_LOGIN,function(){this.actaulDelete(b,d,c)},this),SQUARESPACE_LOGIN.showCommentLogin("Log In to Delete Comments",
"Delete Comments",!1)):f.authorizationFail&&new a.Squarespace.Widgets.Alert({"strings.title":"Authorization Failure","strings.message":"You are not allowed to perform that action."})}},this)},onDeleteClick:function(b){var d,c=b.target.ancestor(".comment"),f=function(){var a=[];this.getThreadNodes(c,a);return a}.call(this),e=function(){f.forEach(function(b){b.hasClass("unmoderated")?b.removeClass("pending-delete"):(b=new a.Anim({node:b,duration:0.3,easing:a.Easing.easeOutStrong,to:{opacity:1}}),b.on("end",
function(){this._node.removeClass("pending-delete")}),b.run())})};f.forEach(function(b){b.hasClass("unmoderated")?b.addClass("pending-delete"):(b=new a.Anim({node:b,duration:0.3,easing:a.Easing.easeOutStrong,to:{opacity:0.5}}),b.on("end",function(){this._node.addClass("pending-delete")}),b.run())});d=new a.Squarespace.Widgets.Confirmation({style:a.Squarespace.Widgets.Confirmation.TYPE.CONFIRM_OR_REJECT,"strings.reject":"Delete","strings.confirm":"Delete & Report Spam","strings.title":1===f.length?
"Delete Comment":"Delete "+f.length+" Comments","strings.message":1<f.length?"Are you sure you wish to delete these comments?":"Are you sure you wish to delete this comment?"});d.on("cancel",function(){e()},this);d.on("reject",function(){e();this.actualDelete(b,!1,f)},this);d.on("confirm",function(){e();this.actualDelete(b,!0,f)},this)},onApproveClick:function(a){var d=a.target.ancestor(".comment");this.approve(d.getAttribute("data-commentId"),d);a.stopImmediatePropagation()},approve:function(a,d){d.removeClass("unmoderated");
this.commentData.approve({comments:[a],success:function(a){this.updateCommentCounts()},failure:function(c){c.loginRequired&&(d.addClass("unmoderated"),SQUARESPACE_LOGIN.configure({redirectAfterLogin:!1,reloadAfterLogin:!1,overlayOpacity:0.5}),this.doAfterLogin(SQUARESPACE_LOGIN,function(){this.approve(a,d)},this),SQUARESPACE_LOGIN.showCommentLogin("Log In to Approve Comments","Approve Comments",!1))}},this)},onUnlikeClick:function(a){var d=a.target.ancestor(".comment");this.unlike(d.getAttribute("data-commentId"),
d);a.stopImmediatePropagation()},unlike:function(a,d){var c=d.one(".likes");d.removeClass("liked");this.commentData.unlike({id:a,success:function(){if(c){var d={comments:[{likesAllowed:{likeCount:this.commentData.getCommentById(a).likeCount}}]},d=this.renderToFragment(this.scatterData(d)).one(".likes");c.replace(d)}},failure:function(f){d.addClass("liked");f.loginRequired&&(SQUARESPACE_LOGIN.configure({redirectAfterLogin:!1,reloadAfterLogin:!1,overlayOpacity:0.5}),this.doAfterLogin(SQUARESPACE_LOGIN,
function(){this.unlike(a,d)},this),SQUARESPACE_LOGIN.showCommentLogin("Log In to Dislike Comment","Dislike Comment",!1))}},this)},onFlagClick:function(b){(new a.Squarespace.Widgets.Confirmation({"strings.title":"Flag Comment","strings.message":"Are you sure you wish to flag this comment as inappropriate?"})).on("confirm",function(){var a=b.target.ancestor(".comment");this.flag(a.getAttribute("data-commentId"),a)},this);b.stopImmediatePropagation()},flag:function(b,d){d.addClass("flagged");this.commentData.flag({id:b,
success:function(){},failure:function(c){d.removeClass("flagged");if(c.loginRequired){SQUARESPACE_LOGIN.configure({redirectAfterLogin:!1,reloadAfterLogin:!1,overlayOpacity:0.5});var f;this.doAfterLogin(SQUARESPACE_LOGIN,function(){this.flag(b,d);f.detach()},this);f=SQUARESPACE_LOGIN.once("cancel",function(){d.removeClass("flagged")},this);SQUARESPACE_LOGIN.showCommentLogin("Log In to Flag Comment","Flag Comment",!1)}else c.error&&new a.Squarespace.Widgets.Alert({"strings.title":"Failed to Flag Comment",
"strings.message":c.error})}},this)},onUnflagClick:function(a){var d=a.target.ancestor(".comment");this.unflag(d.getAttribute("data-commentId"),d);a.stopImmediatePropagation()},unflag:function(a,d){d.removeClass("flagged");this.commentData.unflag({id:a,success:function(){},failure:function(c){d.addClass("flagged");c.loginRequired&&(SQUARESPACE_LOGIN.configure({redirectAfterLogin:!1,reloadAfterLogin:!1,opacity:0.5}),this.doAfterLogin(SQUARESPACE_LOGIN,function(){this.unflag(a,d)},this),SQUARESPACE_LOGIN.showCommentLogin("Log In to Unflag Comment",
"Unflag Comment",!1))}},this)},onLikeClick:function(a){var d=a.target.ancestor(".comment");this.like(d.getAttribute("data-commentId"),d);a.stopImmediatePropagation()},like:function(b,d){var c=d.one(".likes"),f=d.getAttribute("data-commentid");d.addClass("liked");this.commentData.like({id:b,success:function(){if(c&&!a.Lang.isNull(d._node)){var b={comments:[{likesAllowed:{likeCount:this.commentData.getCommentById(f).likeCount}}]},b=this.renderToFragment(this.scatterData(b)).one(".likes");c.replace(b)}},
failure:function(f){d.removeClass("liked");f.loginRequired?(SQUARESPACE_LOGIN.configure({redirectAfterLogin:!1,reloadAfterLogin:!1,overlayOpacity:0.5}),this.doAfterLogin(SQUARESPACE_LOGIN,function(){this.like(b,d)},this),SQUARESPACE_LOGIN.showCommentLogin("Log In to Like Comment","Like Comment",!1)):f.error&&new a.Squarespace.Widgets.Alert({"strings.title":"Failed to Like Comment","strings.message":f.error})}},this)},addLoadMoreControls:function(b){(b=a.one(".load-more"))&&b.remove(!0);!this.threadState&&
this.commentData.page<this.commentData.numPages&&this.containerEl.append(this.loadMoreNode.cloneNode(!0))},addFullViewControls:function(b){(b=a.one(".full-view-btn"))&&b.remove(!0);this.threadState&&this.containerEl.one(".comment-list").insert(this.fullViewNode.cloneNode(!0),"before")},onReplyToggleClick:function(b){var d=b.target.ancestor(".comment"),c=d.getAttribute("data-commentid"),f=a.one('.reply-area-wrapper[data-commentid="'+c+'"]'),e=a.one(a.config.doc.body),h,k,m=a.bind(function(b,d){b&&
(b.setStyles({overflow:"hidden",height:b.get("offsetHeight")}),b.one(".input").setStyle("height","auto"),a.one('.comment[data-commentid="'+b.getAttribute("data-commentId")+'"]').fire("reply-close"),h=new a.Anim({node:b,duration:0.3,easing:a.Easing.easeOutStrong,to:{height:0}}),h.on("end",function(){},this),h.run())},this),s=a.bind(function(b){if(b){var f,c;c=b.one(".new-comment-area").cloneNode(!0);c.setStyles({visibility:"hidden",display:"block",position:"absolute"});d.append(c);f=c.get("offsetHeight");
c.remove(!0);a.one('.comment[data-commentid="'+b.getAttribute("data-commentId")+'"]').fire("reply-open");this.hideAllPreviews();k=new a.Anim({node:b,duration:0.3,easing:a.Easing.easeOutStrong,to:{height:Math.max(f,190)+15}});k.on("end",function(){this._node.setStyle("height","auto");var b=this._node.getY()+this._node.get("offsetHeight")-(e.get("docScrollY")+e.get("winHeight")),d=e.get("scrollTop");0<=b&&(b=new a.Anim({node:e,duration:0.3,easing:a.Easing.easeOutStrong,to:{scrollTop:d+b}}),b.run())});
k.run()}},this);d.hasClass("reply-open")?(d.removeClass("reply-open"),this.hideAllPreviews(),m(f)):(f.one(".reply-area").setAttribute("replyid",c),a.all(".comment.reply-open").each(function(b){b.removeClass("reply-open");b=a.one('.reply-area-wrapper[data-commentid="'+b.getAttribute("data-commentid")+'"]');m(b)}),c=f.one("textArea"),this.replyCompleteEvents[d.getAttribute("data-commentId")]||(this.replyCompleteEvents[d.getAttribute("data-commentId")]=this.once("reply-complete",function(a){m(f,function(){this.one(".input").setStyle("height",
"auto")});this.replyCompleteEvents[d.getAttribute("data-commentId")]=null},this)),c.on("focus",function(){this.setAttribute("data-edited",!0)}),c.on("blur",function(){""===this.get("value")&&this.setAttribute("data-edited",!1)}),d.addClass("reply-open"),s(f));b.stopImmediatePropagation()},escapeComment:function(b){b.authorName=a.Squarespace.Escaping.escapeForHtml(b.authorName);b.authorUrl=a.Squarespace.Escaping.escapeForHtml(b.authorUrl);b.authorEmail=a.Squarespace.Escaping.escapeForHtml(b.authorEmail);
b.memberAccount&&(b.memberAccount.displayName=a.Squarespace.Escaping.escapeForHtml(b.memberAccount.displayName),b.memberAccount.bio=a.Squarespace.Escaping.escapeForHtml(b.memberAccount.bio))},addReplyArea:function(b){var d=a.one(".reply-area-wrapper");d?(d.one(".preview-comment").setAttribute("data-state","closed").set("innerHTML","Preview"),d=d.cloneNode(!0),d.setAttribute("data-commentId",b.getAttribute("data-commentId")),d.setAttribute("data-depth",b.getAttribute("data-depth"))):(d={comments:[{id:b.getAttribute("data-commentId"),
depth:b.getAttribute("data-depth")}]},d=this.renderToFragment(d),d=d.one(".reply-area-wrapper").cloneNode(!0));d.setStyle("height",null);b.insert(d,"after")},prependComment:function(b){var d=(SQUARESPACE_LOGIN.account?SQUARESPACE_LOGIN.account.displayName:a.Cookie.get("displayName"))||"Not Logged In";b=a.one(".top-level-comment-area .comment-input");var c=a.one(".top-level.comment-preview"),f=!1;c?(c.one(".author").set("innerHTML",d),d=c.ancestor(".comment-preview-wrapper")):(c=this.generatePreview(b).one(".comment-preview"),
f=!0,c.wrap('<div class="comment-preview-wrapper"></div>'),d=c.ancestor(".comment-preview-wrapper"),a.one(".comment-list").prepend(d));c.removeClass("comment-preview");c.addClass("pending");a.one(".top-level-comment-area .preview-comment").setAttribute("data-state","closed");this.hidePreview(b);f?(b=new a.Anim({node:d,duration:0.3,easing:a.Easing.easeOutStrong,to:{height:c.get("offsetHeight")+parseInt(c.getComputedStyle("marginBottom"),10)}}),b.on("end",function(){c.unwrap()}),b.run()):c.unwrap();
this.containerEl.removeClass("empty");this.makeMostRecent(c);return c},injectReply:function(b,d){var c=d.getAttribute("data-commentId"),f=a.one('.comment-preview-wrapper[data-commentId="'+c+'"]'),c=a.one('.reply-area-wrapper[data-commentId="'+c+'"]').one("textArea"),e=(SQUARESPACE_LOGIN.account?SQUARESPACE_LOGIN.account.displayName:a.Cookie.get("displayName"))||"Not Logged In",h=!1;f?(f=f.one(".comment-preview"),f.one(".author").set("innerHTML",e)):(f=this.generatePreview(c).one(".comment-preview"),
h=!0,f.wrap('<div class="comment-preview-wrapper"></div>'),f.ancestor(".comment-preivew-wrapper"));d.hasAttribute("data-depth")&&f.setAttribute("data-depth",parseInt(d.getAttribute("data-depth"),10)+1);f.unwrap();f.removeClass("comment-preview");f.addClass("pending");d.removeClass("reply-open");d.fire("reply-complete");h&&(c.ancestor(".reply-area-wrapper").cloneNode(!0),c.ancestor(".reply-area-wrapper").insert(f,"after"));this.makeMostRecent(f);this.fire("reply-complete",{node:f});return f},makeMostRecent:function(b){b.hasClass("comment")&&
(a.all(".comment.pending.most-recent").each(function(a){a.ancestor(".most-recent-anim-wrapper")||a.removeClass("most-recent")}),b.addClass("most-recent"))},fullDataRender:function(){this.render(this.commentData.formatted);this.commentList=a.one(".comment-list")},threadRender:function(){this.render(this.commentData.formattedThread);this.commentList=a.one(".comment-list");this.commentList.one('.comment[data-commentId="'+this.commentData.currentThreadRoot+'"]').addClass("target")},showEmptyText:function(){new a.Squarespace.Widgets.Alert({"strings.title":"Enter Comment Text",
"strings.message":"Enter text in the field above to post a comment."})},showModerationNotification:function(){new a.Squarespace.Widgets.Alert({className:"okay","strings.title":"Comment Awaiting Moderation","strings.message":"Your comment has been successfully posted and is awaiting moderation."})},showCommentSuccessNotification:function(){new a.Squarespace.Widgets.Alert({className:"okay","strings.title":"Comment Posted","strings.message":"Your comment has been successfully posted."})},showPostCommentNotification:function(b){b.status===
a.Squarespace.CommentStatuses.AWAITING_MODERATION&&this.showModerationNotification()},squarespaceAdminOnly:function(){return Static.SQUARESPACE_CONTEXT.website.cloneable&&!a.Squarespace.Utils.isSquarespaceAdmin()},commentBtnOnClick:function(b){var d=a.one(".top-level-comment-area .comment-input"),c=d.get("value");if(""===c.trim())this.showEmptyText();else{var f=this.prependComment(c);this.submitTopLevel(c,f,d)}b.stopImmediatePropagation()},updateWithMemberAccount:function(a,d){if(d&&!SQUARESPACE_LOGIN.account){var c=
a.one(".author");c&&c.setContent(d.displayName);(c=a.one(".avatar img"))&&d.avatarAssetUrl&&c.setAttribute("src",d.avatarAssetUrl)}},submitTopLevel:function(b,d,c){this.setPosting(d,!this.approvalRequired||!this.moderationMode);var f=c.get("value");c.set("value","");console.log("submitTopLevel");this.addComment({onSuccess:function(b){this.updateCommentCounts();a.Lang.isNull(d._node)||(this.setPosted(d),d.setAttribute("data-commentId",b.comment.id),b.comment.status===a.Squarespace.CommentStatuses.APPROVED&&
d.removeClass("pending"),this.addReplyArea(d),this.updateWithMemberAccount(d,b.comment.memberAccount),this.showPostCommentNotification(b.comment))},onFailure:function(e){c.set("value",f);if(e.errors)if(e.errors.anonEmail||e.errors.authorEmail||e.errors.authorName){var h=d.one(".author");e.errors.anonEmail&&new a.Squarespace.Widgets.Alert({className:"okay","strings.title":"Comment Failed","strings.message":e.errors.anonEmail});SQUARESPACE_LOGIN.configure({redirectAfterLogin:!1,reloadAfterLogin:!1,
overlayOpacity:0.5});this.doAfterLogin(SQUARESPACE_LOGIN,function(){this.submitTopLevel(b,d,c);(!a.Lang.isNull(h)||a.Lang.isNull(h._node))&&h.set("innerHTML",SQUARESPACE_LOGIN.account.displayName);SQUARESPACE_LOGIN.account.avatarAssetUrl&&d.one(".avatar").one("img").setAttribute("src",SQUARESPACE_LOGIN.account.avatarAssetUrl);k.detach()},this);this.doAfterGuestLogin(SQUARESPACE_LOGIN,function(){this.submitTopLevel(b,d,c);var f=a.Cookie.get("displayName");!a.Lang.isNull(h)&&(!a.Lang.isNull(h._node)&&
!a.Lang.isNull(f))&&h.set("innerHTML",f);k.detach()},this);var k=SQUARESPACE_LOGIN.once("cancel",function(){this.removeMostRecentPending()},this);console.log("show login");SQUARESPACE_LOGIN.showCommentLogin("Post Comment","Post Comment",this.settings.allowAnon)}else console.log("failed to send comment",e),this.showPostCommentNotification(e.comment)},body:b},this)},removeMostRecentPending:function(){var b=a.one(".comment.most-recent"),d;b.ancestor(".comment-preview-wrapper")&&b.unwrap();b.wrap('<div class="most-recent-anim-wrapper"></div>');
d=b.ancestor(".most-recent-anim-wrapper");d.setStyles({overflow:"hidden",height:b.get("offsetHeight")});b=new a.Anim({node:d,duration:0.3,easing:a.Easing.easeOutStrong,to:{height:0}});b.on("end",function(){this._node.remove(!0)});b.run()},onLoading:function(){var b=a.one(".comments-content"),d=a.DB.DIV("comment-event-capture");d.setStyles({position:"absolute",top:b.getY(),left:b.getX(),width:b.get("offsetWidth"),height:b.get("offsetHeight"),zIndex:1E3});d.on("hover",function(a){a.stopImmediatePropagation()});
d.on("click",function(a){a.stopImmediatePropagation()});a.one(a.config.doc.body).append(d);(new a.Anim({node:b,duration:0.3,easing:a.Easing.easeOutStrong,to:{opacity:0.3}})).run()},commentIdHashOnChange:function(b){!a.Lang.isNull(b.newVal)&&!a.Lang.isUndefined(b.newVal)&&(this.threadState=!0,this.lastHashChangeTime=new Date,this.onLoading(),this.retrieveThread({commentId:b.newVal,order:this.sortOrder,onSuccess:function(){this.threadRender()}}))},commentIdHashOnRemove:function(){this.threadState=!1;
this.lastHashChangeTime=new Date;this.onLoading();this.retrieveComments({onSuccess:function(a){this.fullDataRender(a)},page:1,order:this.sortOrder},this)},retrieveThread:function(a,d){this.threadState=!0;this.commentData.getThread({order:a.order,commentId:a.commentId,success:a.onSuccess,failure:function(c){this.threadState=!1;a.onFailure.call(d||this,c)}},d||this)},retrieveComments:function(b,d){var c=a.bind(function(a){this.lastPollTime=new Date;b.onSuccess.call(d||this,a);this.updateLikedFlaggedState()},
this);this.commentData.get({order:b.order,page:b.page,since:b.since||"",success:c,failure:b.onFailure},this)},addComment:function(b,d){var c=a.bind(function(c){a.Lang.isFunction(b.onSuccess)&&(b||noop).onSuccess.call(d||this,c);a.Cookie.remove("displayName",{path:"/"})},this);console.log("call commentData.post");this.commentData.post({body:b.body,replyTo:b.replyTo,name:SQUARESPACE_LOGIN.account?SQUARESPACE_LOGIN.account.displayName:a.Cookie.get("displayName"),email:SQUARESPACE_LOGIN.account?SQUARESPACE_LOGIN.account.email:
a.Cookie.get("email"),authorUrl:SQUARESPACE_LOGIN.account?SQUARESPACE_LOGIN.account.websiteUrl:a.Cookie.get("websiteUrl"),success:c,failure:b.onFailure},d||this)},setPosting:function(a,d){a.all(".posting-text").each(function(a){a.removeClass("visible")});var c=a.one(".posting-text"+(d?".moderated":""));c&&c.addClass("visible")},setPosted:function(a){(a=a.all(".posting-text"))&&a.each(function(a){a.removeClass("visible")})},replyTo:function(b,d,c,f){this.setPosting(c,!this.approvalRequired||!this.moderationMode);
var e=f.get("value");f.set("value","");this.addComment({body:d,replyTo:b,onSuccess:function(b){this.updateCommentCounts();a.Lang.isNull(f._node)||(this.setPosted(c),c.setAttribute("data-commentId",b.comment.id),b.comment.status===a.Squarespace.CommentStatuses.APPROVED&&c.removeClass("pending"),this.addReplyArea(c),this.updateWithMemberAccount(c,b.comment.memberAccount),this.showPostCommentNotification(b.comment))},onFailure:function(h){f.set("value",e);if(h.errors&&(h.errors.anonEmail||h.errors.authorEmail||
h.errors.authorName)){h.errors.anonEmail&&new a.Squarespace.Widgets.Alert({className:"okay","strings.title":"Comment Failed","strings.message":h.errors.anonEmail});SQUARESPACE_LOGIN.configure({redirectAfterLogin:!1,reloadAfterLogin:!1,overlayOpacity:0.5});this.doAfterLogin(SQUARESPACE_LOGIN,function(){this.replyTo(b,d,c,f);a.one('.comment[data-replyTo="'+b+'"] .author').set("innerHTML",SQUARESPACE_LOGIN.account.displayName);c.one(".author").set("innerHTML",SQUARESPACE_LOGIN.account.displayName);SQUARESPACE_LOGIN.account.avatarAssetUrl&&
c.one(".avatar").one("img").setAttribute("src",SQUARESPACE_LOGIN.account.avatarAssetUrl);k.detach()},this);this.doAfterGuestLogin(SQUARESPACE_LOGIN,function(){this.replyTo(b,d,c,f);var e=a.Cookie.get("displayName");a.Lang.isNull(e)||a.one('.comment[data-replyTo="'+b+'"] .author').set("innerHTML",e);k.detach()},this);var k=SQUARESPACE_LOGIN.once("cancel",function(){this.removeMostRecentPending()},this);SQUARESPACE_LOGIN.showCommentLogin("Log In to Post Reply","Post Reply",this.settings.allowAnon)}}},
this)},extendComments:function(){this.currentPage+=1;var a=this.lastSortTime,d=this.lastHashChangeTime;this.retrieveComments({order:this.sortOrder,onSuccess:function(){a===this.lastSortTime&&d===this.lastHashChangeTime&&this.attachComments.call(this)},page:this.currentPage},this)},attachComments:function(){var b=this.commentData.formatted;b.comments=this.commentData.getFormattedPage(this.currentPage);b=this.renderToFragment(b);this.updateCommentCounts();var d=a.one(".comment-list");b.all(".comment, .reply-area-wrapper").each(function(a){d.append(a)});
this.containerEl.one(".load-more").remove(!0);this.addLoadMoreControls()},sort:function(b){var d=this.sortOrderLookup[b];a.Cookie.set("commentSortOrder",b);this.sortOrder=b;this.currentPage=1;this.onLoading();this.retrieveComments({order:this.sortOrder,onSuccess:function(b){this.lastSortTime=new Date;this.fullDataRender(b);b=a.one(".comment-sort");b.one("span").set("innerHTML",d);b.one("select").set("value",this.sortOrder)},page:this.currentPage})},formatData:function(b,d,c){var f,e={comments:[]},
h;d=d||{};c=c||{};var k=this.squarespaceAdminOnly()||this.settings.readOnly;e.noAvatars=this.settings.avatarsHidden;e.likesAllowed=this.settings.likesAllowed;e.newCommentAreaTop={authenticatedAccount:SQUARESPACE_LOGIN.account,readOnly:k};e.commentSortTitle=this.sortOrderLookup[this.sortOrder];e.sortOldestFirst=this.sortOrder===a.Squarespace.CommentSortTypes.OLDEST_FIRST;e.sortNewestFirst=this.sortOrder===a.Squarespace.CommentSortTypes.NEWEST_FIRST;e.sortMostLiked=this.sortOrder===a.Squarespace.CommentSortTypes.MOST_LIKED;
e.sortLeastLiked=this.sortOrder===a.Squarespace.CommentSortTypes.LEAST_LIKED;e.totalComments=this.commentData.totalComments;e.visibleComments=this.commentData.visibleComments;e.subscribed=Static.SQUARESPACE_CONTEXT.subscribed;for(var m=0;m<b.length;m++)h=b[m],h.unmoderated=h.status===a.Squarespace.CommentStatuses.AWAITING_MODERATION,h.moderationMode=this.moderationMode,h.readOnly=k,h.flagsAllowed=this.settings.flagsAllowed,h.memberAccount&&(h.authorName=h.memberAccount.displayName,h.authorUrl=h.memberAccount.websiteUrl),
h.authorUrl&&(!h.authorUrl.startsWith("http://")&&!h.authorUrl.startsWith("https://"))&&(h.authorUrl="http://"+h.authorUrl),f=h.id,this.settings.likesAllowed&&(h.likesAllowed={likeCount:h.likeCount},d[f]&&(h.likesAllowed.liked=!0)),c[f]&&(h.flagged=!0),h.threaded=this.settings.threaded,e.comments.push(h);return e},scatterData:function(a){var d=this.squarespaceAdminOnly()||this.settings.readOnly;a.noAvatars=this.settings.avatarsHidden;a.likesAllowed=this.settings.likesAllowed;a.newCommentAreaTop={};
a.newCommentAreaTop.readOnly=d;a.newCommentAreaTop.authenticatedAccount=SQUARESPACE_LOGIN.account;a.commentSortTitle=this.sortOrderLookup[this.sortOrder];a.subscribed=Static.SQUARESPACE_CONTEXT.subscribed;0===this.commentData.totalComments&&(a.noComments=!0);for(var c={},f=0;f<a.comments.length;f++)c=a.comments[f],c.flagsAllowed=this.settings.flagsAllowed,c.moderationMode=this.moderationMode,c.memberAccount&&(c.authorName=c.memberAccount.displayName,c.authorUrl=c.memberAccount.websiteUrl),c.authorUrl&&
(!c.authorUrl.startsWith("http://")&&!c.authorUrl.startsWith("https://"))&&(c.authorUrl="http://"+c.authorUrl),c.readOnly=d,this.settings.likesAllowed&&(c.likesAllowed||(c.likesAllowed={likeCount:0}),c.likesAllowed.likeCount=0===c.likesAllowed.likeCount?void 0:c.likesAllowed.likeCount),c.threaded=this.settings.threaded,a.likeMap&&(a.likeMap[c.id]&&void 0!==c.likesAllowed)&&(c.likesAllowed.liked=!0),a.flagMap&&a.flagMap[c.id]&&(c.flagged=!0),a.comments[f]=c;return a},render:function(b){var d=this.renderToFragment(b),
c=this.commentsEl,f=a.one(".comment-event-capture");b.comments.length?this.containerEl.removeClass("empty"):this.containerEl.addClass("empty");c.empty();c.append(d);b=new a.Anim({node:c,duration:0.3,easing:a.Easing.easeOutStrong,to:{opacity:1}});b.on("end",function(){f.remove(!0)});b.run();this.addFullViewControls();switch(this.params.paginationMode){case this.PaginationModes.EXTEND:this.addLoadMoreControls()}this.fire("render")},renderToFragment:function(b){for(var d=0;d<b.comments.length;d++){this.escapeComment(b.comments[d]);
var c=b.comments[d].body,c=a.Squarespace.Utils.preFormatMarkdown(c);b.comments[d].body=c}d=a.Node.create(this._template.expand(b));d.all(".comment").each(function(a,d){a.setAttribute("data-commentId",b.comments[d].id)});return d}});a.augment(a.Squarespace.Comments,a.EventTarget);var c=null;a.config.win.Squarespace.onInitialize(a,function(){var b=a.config.win.Static,d=b.SQUARESPACE_CONTEXT.websiteSettings.disqusShortname;if(d){var g=a.one(".squarespace-comments");g&&(d&&""!==d)&&(window.disqus_shortname=
d,"disqus_thread"!==g.getAttribute("id")&&g.setAttribute("id","disqus_thread"),a.Get.script("//"+d+".disqus.com/embed.js",{win:a.config.win}))}else{var g=a.one(".squarespace-comments"),f,e,h=b.SQUARESPACE_CONTEXT.websiteSettings;if(g&&!h.disqusShortname&&(f=b.SQUARESPACE_CONTEXT.itemId||b.SQUARESPACE_CONTEXT.collectionId)){e=b.SQUARESPACE_CONTEXT.itemId?a.Squarespace.CommentTargetTypes.ITEM:a.Squarespace.CommentTargetTypes.COLLECTION;var k=d=!1;if(e===a.Squarespace.CommentTargetTypes.ITEM){var m=
b.SQUARESPACE_CONTEXT.item;m&&m.commentState===a.Squarespace.CommentStates.DISABLED&&(0===m.publicCommentCount?d=!0:k=!0)}if(!d){var s=function(){a.use("squarespace-comments","cookie",function(a){c=(new a.Squarespace.Comments({containerEl:g,identifier:f,type:e,likesAllowed:h.commentLikesAllowed,flagsAllowed:h.commentFlagsAllowed,threaded:h.commentThreaded,approvalRequired:h.commentApprovalRequired,allowAnon:h.commentAnonAllowed,avatarsOn:h.commentAvatarsOn,readOnly:k,sortType:a.Cookie.get("commentSortOrder")||
h.commentSortType})).create()})},d=function(){a.use("squarespace-comments","cookie",function(a){var d=function(){a.Data.get({url:"/api/auth/CheckAuthentication",secure:!0,success:function(d){null!==d.member&&a.use("squarespace-management",function(a){b.SQUARESPACE_CONTEXT.authenticatedAccount=d.member;SQUARESPACE_LOGIN.params=a.merge(SQUARESPACE_LOGIN.params,{redirectAfterCancel:!1,redirectAfterLogin:!1});SQUARESPACE_LOGIN.onLoginComplete(d.member)});s()},failure:s})};a.Data.TRANSPORT_READY?d():(console.warn("Flash cross-domain transport not initialized yet. Delaying comment initialization until flash is ready."),
a.once("io:xdrReady",d))})};b.SQUARESPACE_CONTEXT.authenticatedAccount||b.SQUARESPACE_CONTEXT.website.cloneable?s():d()}}}});a.config.win.Squarespace.onDestroy(a,function(){c&&c.destroy()})},"1.0",{requires:"history squarespace-dialog squarespace-comment-data squarespace-util squarespace-markdown squarespace-login squarespace-ui-base node event selector-css3 squarespace-json-template anim transition squarespace-widgets-alert squarespace-widgets-confirmation squarespace-widgets-information".split(" ")});
YUI.add("squarespace-comment-data",function(a){a.namespace("Squarespace");a.Squarespace.CommentData=Class.create({initialize:function(a){if(void 0===a)throw Error("You must provide a configuration object.");if(void 0===a.target)throw Error("You must provide a target id.");if(void 0===a.targetType)throw Error("You must provide a target type.");this.settings=a.settings||{approvalRequired:!1,allowAnon:!0,threaded:!0};this.formatter=a.formatter||function(a){return a};this.page=1;this.data={comments:[]};
this.visibleComments=this.topLevelComments=0;this.totalComments=Static.SQUARESPACE_CONTEXT.item?Static.SQUARESPACE_CONTEXT.item.publicCommentCount:Static.SQUARESPACE_CONTEXT.collection?Static.SQUARESPACE_CONTEXT.collection.publicCommentCount:0;this.commentsPerPage=50;this.target=a.target;this.targetType=a.targetType;this.idToIndex={};this.comments=[];this.likeMap={};this.flagMap={};this.formatted={};this.currentThreadRoot="";this.formattedThread={};this.pageIntervals=[]},useSecure:function(){return window.SQUARESPACE_LOGIN&&
window.SQUARESPACE_LOGIN.isLoggedIn()},getCommentById:function(a){return this.comments[this.idToIndex[a]]},removeCommentById:function(c){c=this.idToIndex[c];a.Lang.isUndefined(c)||(this.comments.splice(c,1),this.calculatePagination())},removeCommentsByIds:function(c){c.forEach(function(b){b=this.idToIndex[b];a.Lang.isUndefined(b)||(this.comments.splice(b,1),this.visibleComments-=1,this.totalComments-=1)},this);this.calculatePagination()},getFormattedPage:function(a){return(a=this.pageIntervals[a-
1])?Array.prototype.slice.apply(this.comments,a):null},fullBookkeeping:function(a){var b=0,d={};this.comments=[];this.pageIntervals=[];this.idToIndex={};for(b=0;b<a.comments.length;b++)d=a.comments[b],this.idToIndex[d.id]=b,this.comments[b]=d;this.pageIntervals.push([0,void 0]);this.flagMap=a.flagMap;this.likeMap=a.likeMap;this.commentSettings=a.commentSettings;this.visibleComments=a.visibleComments;this.topLevelComments=this.formatted.topLevelComments||this.topLevelComments;this.totalComments=a.totalComments?
a.totalComments:this.totalComments;this.reformat();this.topLevelComments=a.topLevelComments;this.numLikes=a.numLikes;this.numPages=Math.ceil(this.topLevelComments/this.commentsPerPage)},addCommentData:function(a){this.comments.splice((this.idToIndex[a.parentId]||-1)+1,0,a);this.calculatePagination()},calculatePagination:function(){var a=0,b,d;this.idToIndex={};this.pageIntervals=[[0,void 0]];for(d=0;d<this.comments.length;d++)b=this.comments[d],this.idToIndex[b.id]=d,b.parentId||(a+=1,50<a&&(b=this.pageIntervals[this.pageIntervals.length-
1],b[1]=a-1,this.pageIntervals.push([b[1],void 0]),a=0))},appendBookkeeping:function(c){var b=0,d={};this.pageIntervals[this.pageIntervals.length-1][1]=this.comments.length;for(b=0;b<c.comments.length;b++)d=c.comments[b],this.idToIndex[d.id]=this.comments.length+1,this.comments.push(d);this.pageIntervals.push([this.pageIntervals[this.pageIntervals.length-1][1],void 0]);this.likeMap=a.merge(this.likeMap,c.likeMap);this.flagMap=a.merge(this.flagMap,c.flagMap);this.visibleComments+=c.visibleComments;
this.reformat()},reformat:function(){this.formatted=this.formatter(this.comments,this.likeMap,this.flagMap)},like:function(c,b){a.Data.post({url:"/api/comment/LikeComment",secure:!0,data:{commentId:c.id},success:function(a){var g=this.getCommentById(c.id);g&&(g.likeCount+=1,this.reformat());(c.success||noop).call(b||this,a)},failure:function(a){(c.failure||noop).call(b||this,a)}},this)},unlike:function(c,b){a.Data.post({url:"/api/comment/UnlikeComment",secure:!0,data:{commentId:c.id},success:function(a){var g=
this.getCommentById(c.id);g&&(g.likeCount=Math.max(g.likeCount-1,0),this.reformat());(c.success||noop).call(b||this,a)},failure:c.failure},this)},flag:function(c,b){a.Data.post({url:"/api/comment/FlagComment",secure:!0,data:{commentId:c.id},success:function(a){var g=this.getCommentById(c.id);g&&(g.flagCount+=1,this.reformat());(c.success||noop).call(b||this,a)},failure:function(a){(c.failure||noop).call(b||this,a)}},this)},_delete:function(c,b){a.Data.post({url:"/api/comment/admin/DeleteComments",
secure:!0,data:{markAsSpam:c.spam,comments:a.Lang.isArray(c.comments)?c.comments:[c.comments]},success:function(a){c.comments.forEach(function(a){this.removeCommentById(a.id)},this);this.visibleComments-=c.comments.length;this.totalComments-=c.comments.length;(c.success||noop).call(b||this,a)},failure:c.failure?a.bind(c.failure,b||this):void 0},this)},approve:function(c,b){a.Data.post({url:"/api/comment/admin/ApproveComments",secure:!0,data:{comments:a.Lang.isArray(c.comments)?c.comments:[c.comments]},
success:function(d){c.comments.forEach(function(b){if(b=this.getCommentById(b.id))b.status=a.Squarespace.CommentStatuses.APPROVED},this);this.totalComments+=1;(c.success||noop).call(b||this,d)},failure:c.failure?a.bind(c.failure,b||this):void 0},this)},unflag:function(c,b){a.Data.post({url:"/api/comment/UnflagComment",secure:!0,data:{commentId:c.id},success:function(a){var g=this.getCommentById(c.id);g&&(g.flagCount=Math.max(g.flagCount-1,0),this.reformat());(c.success||noop).call(b||this,a)},failure:function(a){(c.failure||
noop).call(b||this,a)}},this)},post:function(c,b){var d={targetId:this.target,targetType:this.targetType,body:c.body,replyToId:c.replyTo,authorName:c.name||"",authorEmail:c.email||"",authorUrl:c.authorUrl||""};console.log("post comment to API");a.Data.post({url:"/api/comment/CreateComment",secure:!!Static.SQUARESPACE_CONTEXT.authenticatedAccount,data:d,success:function(d){d.comment.status===a.Squarespace.CommentStatuses.APPROVED&&(this.addCommentData(d.comment),this.visibleComments+=1,this.totalComments+=
1,c.replyTo||(this.topLevelComments+=1),this.reformat());(c.success||noop).call(b||this,d)},failure:c.failure?a.bind(c.failure,b||this):void 0},this)},getPage:function(a,b,d){b<=this.numPages&&this.get({sortBy:a.order,page:b,success:a.success,failure:a.failure},d)},getSince:function(a,b,d){this.get({since:b,success:a.success,failure:a.failure},d)},getThread:function(c,b){a.Data.get({url:"/api/comment/GetThread",secure:this.useSecure(),data:{sortBy:c.order,commentId:c.commentId},success:function(d){this.currentThreadRoot=
c.commentId;var g=d.comments[0].comment.depth;d.comments=a.Array.map(d.comments,function(a){return a.comment});d.comments.forEach(function(a){a.depth-=g});this.formattedThread=this.formatter(d.comments,{},{});a.Lang.isFunction(c.success)&&c.success.call(b||this,d)},failure:function(d){a.Lang.isFunction(c.failure)&&c.failure.call(b||this,d)}},this)},get:function(c,b){a.Data.get({url:"/api/comment/GetComments",secure:this.useSecure(),data:{targetId:this.target,targetType:this.targetType,since:c.since||
"",page:c.page,sortBy:c.order},success:function(a){this.page=c.page;1>=c.page?this.fullBookkeeping(a):1<c.page&&this.appendBookkeeping(a);c.success&&c.success.call(b||this,a)},failure:c.failure},this)},getLikesAndFlags:function(c,b){var d=a.Array.map(this.comments,function(a){return a.id});a.Data.get({url:"/api/comment/GetLikesFlags",secure:this.useSecure(),data:{ids:d},success:function(d){c.success&&a.Lang.isFunction(c.success)&&c.success.call(b||this,d)},failure:function(d){c.failure&&a.Lang.isFunction(c.failure)&&
c.failure.call(b||this,d)}})}})},"1.0",{requires:["squarespace-util"]});
(function(){var a;a=function(){var a,b,d,g=0;this.makeHtml=function(g){a=[];b=[];d=[];g=g.replace(/~/g,"~T");g=g.replace(/\$/g,"~D");g=g.replace(/\r\n/g,"\n");g=g.replace(/\r/g,"\n");g=M("\n\n"+g+"\n\n");g=g.replace(/^[ \t]+$/mg,"");g=e(g);g=f(g);g=k(g);g=l(g);g=g.replace(/~D/g,"$$");return g=g.replace(/~T/g,"~")};var f=function(d){return d=d.replace(/^[ ]{0,3}\[(.+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?[ \t]*\n?[ \t]*(?:(\n*)[ \t]+["'(](.+?)["')][ \t]*)?(?:\n+|$)/gm,function(d,f,e,g,h){f=f.toLowerCase();a[f]=
O(e);if(g)return g+h;h&&(b[f]=h.replace(/"/g,"&quot;"));return""})},e=function(a){a=a.replace(/\n/g,"\n\n");a=a.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\b[^\r]*?\n<\/\2>[ \t]*(?=\n+))/gm,h);a=a.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math)\b[^\r]*?.*<\/\2>[ \t]*(?=\n+)\n)/gm,h);a=a.replace(/(\n[ ]{0,3}(<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,h);a=a.replace(/(\n\n[ ]{0,3}<!(--[^\r]*?--\s*)+>[ \t]*(?=\n{2,}))/g,
h);a=a.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,h);return a=a.replace(/\n\n/g,"\n")},h=function(a,b){var c;c=b.replace(/\n\n/g,"\n");c=c.replace(/^\n/,"");c=c.replace(/\n+$/g,"");return c="\n\n~K"+(d.push(c)-1)+"K\n\n"},k=function(a){a=p(a);var b=H("<hr />");a=a.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm,b);a=a.replace(/^[ ]{0,2}([ ]?\-[ ]?){3,}[ \t]*$/gm,b);a=a.replace(/^[ ]{0,2}([ ]?\_[ ]?){3,}[ \t]*$/gm,b);a=w(a);a=D(a);a=N(a);a=e(a);a=a.replace(/^\n+/g,"");a=a.replace(/\n+$/g,
"");var c=a.split(/\n{2,}/g);a=[];for(var b=c.length,f=0;f<b;f++){var g=c[f];0<=g.search(/~K(\d+)K/g)?a.push(g):0<=g.search(/\S/)&&(g=m(g),g=g.replace(/^([ \t]*)/g,"<p>"),g+="</p>",a.push(g))}b=a.length;for(f=0;f<b;f++)for(;0<=a[f].search(/~K(\d+)K/);)c=d[RegExp.$1],c=c.replace(/\$/g,"$$$$"),a[f]=a[f].replace(/~K\d+K/,c);return a=a.join("\n\n")},m=function(a){a=K(a);a=s(a);a=a.replace(/\\(\\)/g,R);a=a.replace(/\\([`*_{}\[\]()>#+-.!])/g,R);a=a.replace(/(!\[(.*?)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,
x);a=a.replace(/(!\[(.*?)\]\s?\([ \t]*()<?(\S+?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,x);a=a.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,r);a=a.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\]\([ \t]*()<?(.*?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,r);a=a.replace(/(\[([^\[\]]+)\])()()()()()/g,r);a=u(a);a=O(a);a=a.replace(/(\*\*|__)(?=\S)([^\r]*?\S[*_]*)\1/g,"<strong>$2</strong>");a=a.replace(/(\*|_)(?=\S)([^\r]*?\S)\1/g,"<em>$2</em>");return a=a.replace(/  +\n/g," <br />\n")},s=function(a){return a=
a.replace(/(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--.*?--\s*)+>)/gi,function(a){a=a.replace(/(.)<\/?code>(?=.)/g,"$1`");return a=n(a,"\\`*_")})},r=function(d,f,e,g,h,t,k,l){void 0==l&&(l="");d=g.toLowerCase();if(""==h)if(""==d&&(d=e.toLowerCase().replace(/ ?\n/g," ")),void 0!=a[d])h=a[d],void 0!=b[d]&&(l=b[d]);else if(-1<f.search(/\(\s*\)$/m))h="";else return f;h=n(h,"*_");f='<a href="'+h+'"';""!=l&&(l=l.replace(/"/g,"&quot;"),l=n(l,"*_"),f+=' title="'+l+'"');return f+(">"+e+"</a>")},x=function(d,
f,e,g,h,l,t,k){d=e;g=g.toLowerCase();k||(k="");if(""==h)if(""==g&&(g=d.toLowerCase().replace(/ ?\n/g," ")),void 0!=a[g])h=a[g],void 0!=b[g]&&(k=b[g]);else return f;d=d.replace(/"/g,"&quot;");h=n(h,"*_");f='<img src="'+h+'" alt="'+d+'"';k=k.replace(/"/g,"&quot;");k=n(k,"*_");return f=f+(' title="'+k+'"')+" />"},p=function(a){function b(a){return a.replace(/[^\w]/g,"").toLowerCase()}a=a.replace(/^(.+)[ \t]*\n=+[ \t]*\n+/gm,function(a,d){return H('<h1 id="'+b(d)+'">'+m(d)+"</h1>")});a=a.replace(/^(.+)[ \t]*\n-+[ \t]*\n+/gm,
function(a,d){return H('<h2 id="'+b(d)+'">'+m(d)+"</h2>")});return a=a.replace(/^(\#{1,6})[ \t]*(.+?)[ \t]*\#*\n+/gm,function(a,d,c){a=d.length;return H("<h"+a+' id="'+b(c)+'">'+m(c)+"</h"+a+">")})},v,w=function(a){a+="~0";var b=/^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;g?a=a.replace(b,function(a,b,d){a=b;d=-1<d.search(/[*+-]/g)?"ul":"ol";a=a.replace(/\n{2,}/g,"\n\n\n");a=v(a);a=a.replace(/\s+$/,"");return"<"+d+">"+a+"</"+d+">\n"}):(b=/(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/g,
a=a.replace(b,function(a,b,d,c){a=d;c=-1<c.search(/[*+-]/g)?"ul":"ol";a=a.replace(/\n{2,}/g,"\n\n\n");a=v(a);return b+"<"+c+">\n"+a+"</"+c+">\n"}));return a=a.replace(/~0/,"")};v=function(a){g++;a=a.replace(/\n{2,}$/,"\n");a=(a+"~0").replace(/(\n)?(^[ \t]*)([*+-]|\d+[.])[ \t]+([^\r]+?(\n{1,2}))(?=\n*(~0|\2([*+-]|\d+[.])[ \t]+))/gm,function(a,b,d,c,f){a=f;b||-1<a.search(/\n{2,}/)?a=k(L(a)):(a=w(L(a)),a=a.replace(/\n$/,""),a=m(a));return"<li>"+a+"</li>\n"});a=a.replace(/~0/g,"");g--;return a};var D=
function(a){a=(a+"~0").replace(/(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g,function(a,b,d){a=Q(L(b));a=M(a);a=a.replace(/^\n+/g,"");a=a.replace(/\n+$/g,"");a="<pre><code>"+a+"\n</code></pre>";return H(a)+d});return a=a.replace(/~0/,"")},H=function(a){a=a.replace(/(^\n+|\n+$)/g,"");return"\n\n~K"+(d.push(a)-1)+"K\n\n"},K=function(a){return a=a.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(a,b,d,c,f){a=c.replace(/^([ \t]*)/g,"");a=a.replace(/[ \t]*$/g,"");a=Q(a);return b+
"<code>"+a+"</code>"})},Q=function(a){a=a.replace(/&/g,"&amp;");a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");return a=n(a,"*_{}[]\\",!1)},N=function(a){return a=a.replace(/((^[ \t]*>[ \t]?.+\n(.+\n)*\n*)+)/gm,function(a,b){var d;d=b.replace(/^[ \t]*>[ \t]?/gm,"~0");d=d.replace(/~0/g,"");d=d.replace(/^[ \t]+$/gm,"");d=k(d);d=d.replace(/(^|\n)/g,"$1  ");d=d.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(a,b){var d;d=b.replace(/^  /mg,"~0");return d=d.replace(/~0/g,"")});return H("<blockquote>\n"+
d+"\n</blockquote>")})},O=function(a){a=a.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;");return a=a.replace(/<(?![a-z\/?\$!])/gi,"&lt;")},u=function(a){a=a.replace(/<((https?|ftp|dict):[^'">\s]+)>/gi,'<a href="$1">$1</a>');return a=a.replace(/<(?:mailto:)?([-.\w]+\@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)>/gi,function(a,b){return t(l(b))})},t=function(a){var b=[function(a){return"&#"+a.charCodeAt(0)+";"},function(a){a=a.charCodeAt(0);return"&#x"+("0123456789ABCDEF".charAt(a>>4)+"0123456789ABCDEF".charAt(a&
15))+";"},function(a){return a}];a=("mailto:"+a).replace(/./g,function(a){if("@"==a)a=b[Math.floor(2*Math.random())](a);else if(":"!=a){var d=Math.random();a=0.9<d?b[2](a):0.45<d?b[1](a):b[0](a)}return a});a='<a href="'+a+'">'+a+"</a>";return a=a.replace(/">.+:/g,'">')},l=function(a){return a=a.replace(/~E(\d+)E/g,function(a,b){var d=parseInt(b);return String.fromCharCode(d)})},L=function(a){a=a.replace(/^(\t|[ ]{1,4})/gm,"~0");return a=a.replace(/~0/g,"")},M=function(a){a=a.replace(/\t(?=\t)/g,"    ");
a=a.replace(/\t/g,"~A~B");a=a.replace(/~B(.+?)~A/g,function(a,b,d){a=b;b=4-a.length%4;for(d=0;d<b;d++)a+=" ";return a});a=a.replace(/~A/g,"    ");return a=a.replace(/~B/g,"")},n=function(a,b,d){b="(["+b.replace(/([\[\]\\])/g,"\\$1")+"])";d&&(b="\\\\"+b);return a=a.replace(RegExp(b,"g"),R)},R=function(a,b){return"~E"+b.charCodeAt(0)+"E"}};YUI.add("squarespace-markdown",function(c){c.namespace("Squarespace.Lang");c.Squarespace.Lang.markdownToHTML=function(b){return!b?"":(new a).makeHtml(b)}},"1.0",
{requires:[]})})();
YUI.add("squarespace-login",function(a){var c,b,d,g;switch(!1){case "loginWithSocialAccounts":c=!0;g=d=b=void 0;break;case "commentsLogin":g=d=b=c=!0;break;case "acceptInvitation":d=!0,g=b=c=void 0}a.config.win.SQUARESPACE_LOGIN||(a.config.win.SQUARESPACE_LOGIN=Singleton.create({ready:function(){Static.SQUARESPACE_CONTEXT&&(this.account=Static.SQUARESPACE_CONTEXT.authenticatedAccount);this.params=this.defaultParams={redirectAfterCancel:!0,redirectAfterLogin:!0,minimal:!1,cancelable:!0,overlayOpacity:0.8,
disableOverlayCancel:!1,forgotPassword:!0,disableCreateAccount:!0,globalLogin:!0,allowSocialLogins:!0};this.dialogParameters=null},configure:function(b){this.params=this.defaultParams;this.params=a.merge(this.params,b)},reset:function(){this.params=this.defaultParams},isLoggedIn:function(){return!!this.account},getAccount:function(){return this.account},_getNoLoginDialogParmas:function(){return{style:"flyout",discardChangesConfirmation:!1,overlay:this.params.overlayOpacity,width:400,closeOthers:!1,
closeable:!this.params.disableOverlayCancel,disableOverlayCancel:this.params.disableOverlayCancel,tabs:[{title:"Squarespace Login",icon:"/universal/images-v6/dialog/login-icon.png?4",fields:[{ctor:a.Squarespace.DialogFields.Description,config:{text:"This browser does not accept cookies, which is a requirement for login. You can allow cookies by changing your browser's settings."}}]}]}},showCommentLogin:function(a,b,d){this.iFrameCommentLoginShow(a,b,d)},_showCommentLoginIniFrame:function(b,d,c,g){console.log("show login in frame");
if(a.Squarespace.Utils.areCookiesEnabled()){var m=["squarespace","google","twitter","facebook"],s="squarespace";c&&(m.splice(0,0,"guest"),s="guest");c=a.Node.create('<div class="login-wrapper-node"></div>');a.one("body").append(c);var r=new a.Squarespace.Widgets.Login({srcNode:c,render:!0,tabsEnabled:m,activeLoginMethod:s,returnWebsiteList:!1,canCreateAccount:!0,canCancel:!0,title:b,targetIdentifier:g,className:"comments","strings.loginButonTitle":d});console.log("Login widget created");r.on("loginSuccess",
function(a){SQUARESPACE_LOGIN.loginRPCProvider.commentLoginSuccess({type:a.type,displayName:a.displayName,email:a.email,authorUrl:a.authorUrl,account:a.account,website:a.website});SQUARESPACE_LOGIN.loginRPCProvider.remove(!1);r.destroy()},this);r.on("destroy",function(){SQUARESPACE_LOGIN.loginRPCProvider.remove(!1)},this);r.on("cancel",function(){SQUARESPACE_LOGIN.loginRPCProvider.remove(!0)},this);a.soon(function(){a.one(a.config.doc.body).addClass("login-visible")});a.later(1E3,{},function(){a.one("body .sqs-widgets-login")?
console.log("widget in DOM"):console.log("widget not in DOM")})}else b=this._getNoLoginDialogParmas(),(new a.Squarespace.EditingDialog(b)).show(),console.log("Need to have cookies turned on to be able to comment")},showGoogleWebhostingLogin:function(){var b=a.bind(function(a){this._redirectToWebsite(a,this._getGoogleWebhostingConfirmUrl())},this);this._showSimpleLogin({enableGoogleLoginLink:!0,returnWebsiteList:!0}).then(a.bind(function(d){this._websiteDisambiguation(d.websites,d.account,"Select the website you would like to add the domain to").then(b,
function(a){console.log("Failed to Disambiguate",a)});a.Squarespace.Analytics.trackInternal("engagement_site_disambiguation",{disambiguationType:"domain_linkage"})},this))},_getGoogleWebhostingConfirmUrl:function(){var b=a.Squarespace.GoogleDomains.getGoogleDomainUrlParams();return"/auth/google-web-hosting/add-domain-confirmation?domainName="+b.domainName+"&userId="+b.userId},showReferralDisambigLogin:function(b){var d={returnWebsiteList:!0};a.Lang.isString(b)&&(d.email=b,d.disableEmailChange=!0);
this._showSimpleLogin(d).then(a.bind(function(b){var d=b.websites;b=b.account;var c="/auth/referral/"+Static.SQUARESPACE_CONTEXT.referralSecretToken+"/disambiguate",f=a.bind(function(a){this._redirectToWebsite(a,c)},this);this._websiteDisambiguation(d,b,"Select a website to credit with a free month of Squarespace",!1,function(){var b=new a.Squarespace.Widgets.Button({"strings.text":"+&nbsp;&nbsp;Start New Site"});b.on("click",function(){a.Squarespace.Analytics.trackInternal("referral_newsite_selected",
{source:"login"},function(){window.location="http://www.squarespace.com/templates/?sourceIdentifier="+d[0].identifier})});var c=a.Node.create('<div class="create-new-site-btn-wrapper"></div>');a.one(".sqs-website-selector .websites-wrapper").insert(c,"after");b.render(c)}).then(f,function(){console.log("Failed to Disambiguate",error)})},this))},_redirectToWebsite:function(b,d){var c=b.get("loginUrl");a.Lang.isString(d)&&(c+="&redirectUrl="+encodeURIComponent(d));a.config.win.location=c},_showSimpleLogin:function(b){return new a.Promise(function(d,
c){if(a.Squarespace.Utils.areCookiesEnabled()){b=a.merge({render:!0},b);var g=new a.Squarespace.Widgets.Login(b);g.on("loginSuccess",function(a){g.destroy({remove:!0});d(a)},this);a.Squarespace.Analytics.trackInternal("engagement_login_overview_view");a.soon(function(){a.one(a.config.doc.body).addClass("login-visible")})}else{var m=this._getNoLoginDialogParmas();(new a.Squarespace.EditingDialog(m)).show();c()}})},_websiteDisambiguation:function(b,d,c,g,m){a.Lang.isBoolean(g)||(g=!0);return new a.Promise(function(s,
r){var x=new a.Squarespace.Models.ModelList;a.Array.each(b,function(b){x.add(new a.Model(b))});g&&1===x.size()&&s(x.item(0));var p=new a.Squarespace.Widgets.WebsiteSelector({memberAccount:new a.Squarespace.Models.MemberAccount(d),websites:x,title:c});a.Lang.isFunction(m)&&p.after("render",m,this);p.render();p.on("selectedWebsiteChange",function(b){a.Lang.isValue(b.newVal)&&(p.destroy({remove:!0}),s(b.newVal))},this)})},acceptInvitationSignin:function(b){if(a.Squarespace.Utils.areCookiesEnabled()){var d=
Static.SQUARESPACE_CONTEXT.website.identifier;b="<p>You have been invited to manage "+a.Escape.html(Static.SQUARESPACE_CONTEXT.website.authenticUrl)+" by <strong>"+a.Escape.html(b.displayName)+"</strong>. Sign in or create an account below to get started.</p>";var c=new a.Squarespace.Widgets.Login({render:!0,tabsEnabled:[],canCreateAccount:!0,targetIdentifier:d,title:"<h1>Accept Invitation</h1>"+b});c.on("loginSuccess",function(a){c.destroy();a=a.website.loginUrl+"&redirectUrl="+encodeURIComponent(window.location.pathname+
window.location.search);window.location.replace(a)});a.soon(function(){a.one(a.config.doc.body).addClass("login-visible")})}else d=this._getNoLoginDialogParmas(),(new a.Squarespace.EditingDialog(d)).show()},show:function(){if(a.Squarespace.Utils.areCookiesEnabled()){var f=a.Cookie.get("email"),e=["squarespace"],h=!0;if(Static.SQUARESPACE_CONTEXT.hasSocialAccounts||c)e=["squarespace","google","twitter","facebook"],h=!1;b&&e.push("guest");var k={};d&&(k.canCreateAccount=!0);g&&(k.canCancel=!0);var m=
new a.Squarespace.Widgets.Login(a.merge({render:!0,enableGoogleLoginLink:h,tabsEnabled:e,returnWebsiteList:!0,email:f},k));m.plug(a.Squarespace.Plugin.V5Login);if(this.loginRPCProvider)m.on("destroy",function(a){this.loginRPCProvider.remove()},this);m.on("loginSuccess",function(b){a.one(a.config.doc.body).removeClass("login-visible");a.Lang.isObject(b.account)&&a.Lang.isString(b.account.email)&&("v6"===b.type||"v5"===b.type)&&a.Cookie.set("email",b.account.email);if("v5"===b.type)top.window.location.replace(b.url);
else if(a.Lang.isString(b.redirectUrl))top.window.location.replace(b.redirectUrl);else if(a.Lang.isObject(b.website)){b=b.website;var d="/config",c=location.host,c=c.substr(0,c.indexOf("."));b.identifier===c&&(d=location.pathname+location.search+location.hash);b=b.loginUrl+"&redirectUrl="+encodeURIComponent(d);top.window.location.replace(b)}else new a.Squarespace.Widgets.Alert({position:a.Squarespace.Widgets.Confirmation.ANCHOR.CENTER,"strings.title":"Login Failed","strings.message":"We could not find a website you have access to for the account you signed in with."}),
a.soon(function(){a.one(a.config.doc.body).addClass("login-visible")})},this);a.soon(function(){a.one(a.config.doc.body).addClass("login-visible");var b=m.get("boundingBox").one(".body.squarespace .mode.squarespace input[name=email]");if(b)a.one(a.config.win).on("click",function(a){a.target.ancestor(".sqs-widgets-login")||b.focus()})})}else f=this._getNoLoginDialogParmas(),(new a.Squarespace.EditingDialog(f)).show()},onEscape:function(){a.one("body").removeClass("login-visible");a.later(300,this,
function(){a.config.win.location.href="http://"+a.config.win.location.host+"/"})},getPasswordResetDialogParams:function(b){var d={loadingText:"Loading...",savingText:"",closingText:"",style:"minimal",width:460,top:280,closeOthers:!1,closeable:!this.params.disableOverlayCancel,disableOverlayCancel:this.params.disableOverlayCancel,buttons:[b.invalidRecoveryId?{type:"login",title:"Back To Login"}:{type:"saveAndClose",title:"Update"}],tabs:[{title:"",fields:[]}]};d.tabs[0].fields=b.invalidRecoveryId?
[{ctor:a.Squarespace.DialogFields.Description,config:{text:"This URL is no longer valid, please go back to login and start over."}}]:[{ctor:a.Squarespace.DialogFields.Description,config:{text:"Hi, <strong>"+a.Escape.html(b.displayName)+"</strong>"}},{ctor:a.Squarespace.DialogFields.Description,config:{text:"Please enter your new account password for the account with email: <strong>"+b.email+"</strong>."}},{ctor:a.Squarespace.DialogFields.Text,config:{name:"password",strings:{placeholder:"New Password"},
password:!0,submitOnEnter:!0}}];d.tabs[0].title="Password Reset";d.tabs[0].icon="/universal/images-v6/dialog/dialog-icon-member.png";return d},bindPasswordResetDialog:function(b,d){b.on("button-login",function(){document.location.replace(document.location.pathname)});b.on("send-requested",function(){var d=this.dialog.getData();d.email=this.params.email;d.recoveryId=this.params.recoveryId;a.Data.sendForm(this.dialog,{data:d,url:"/api/auth/PasswordReset",secure:!0,success:function(a){this.dialog.close();
document.location.replace(document.location.pathname)}},{that:this.that,dialog:b})},{dialog:b,params:d})},passwordResetConfirmation:function(b){var d=this.getPasswordResetDialogParams(b),d=new a.Squarespace.EditingDialog(d);this.bindPasswordResetDialog(d,b);d.show()},accountActivationConfirmation:function(b){b.recoveryId=b.activationId;var d=this.getPasswordResetDialogParams(b);b.invalidRecoveryId||(d.tabs[0].fields=[{ctor:a.Squarespace.DialogFields.Description,config:{text:"Welcome, <strong>"+a.Escape.html(b.displayName)+
"</strong>"}},{ctor:a.Squarespace.DialogFields.Description,config:{text:"To Activate your account you need to first set your account password associated with the email: <strong>"+b.email+"</strong>."}},{type:"text",required:!0,name:"password",password:!0,title:"New Password",style:"title",titleStyle:"inline",submitOnEnter:!0}],d.tabs[0].title="Activate Account");d=new a.Squarespace.EditingDialog(d);this.bindPasswordResetDialog(d,b);d.show()},onLoginComplete:function(b,d){a.config.win.SQUARESPACE_LOGIN.account=
b;a.Squarespace.Utils.userHasAccessPermission(a.Squarespace.AccessPermissions.CONFIG);SQUARESPACE_LOGIN.loginRPCProvider&&d?a.config.win.SQUARESPACE_LOGIN.fire("iframeLogin",d):this.params.redirectAfterLogin||this.params.reloadAfterLogin?d?d===a.config.win.location.href?a.config.win.location.reload():a.config.win.location.replace(d):new a.Squarespace.Widgets.Alert({"strings.title":"No Administrative Privileges","strings.message":"Your Squarespace account is not listed as an administrator on any sites."}):
(a.config.win.SQUARESPACE_LOGIN.fire("login"),this.params.globalLogin&&a.Global.fire("squarespace:login"),this.reset())},onCommentLoginSuccess:function(b){if("guest"===b.type){var d=new Date;d.setSeconds(d.getSeconds()+30);a.Cookie.set("email",b.email,{path:"/",expires:d});a.Cookie.set("displayName",b.displayName,{path:"/",expires:d});a.Cookie.set("websiteUrl",b.authorUrl,{path:"/",expires:d});a.config.win.SQUARESPACE_LOGIN.fire("guestLogin");this.params.globalLogin&&a.Global.fire("squarespace:login")}else{var c=
b.account;a.Data.get({url:b.website.loginUrl,secure:!0,success:function(){Static.SQUARESPACE_CONTEXT.authenticatedAccount=c;a.config.win.SQUARESPACE_LOGIN.account=c;a.config.win.SQUARESPACE_LOGIN.fire("login");this.params.globalLogin&&a.Global.fire("squarespace:login")},failure:function(b){new a.Squarespace.Widgets.Alert({position:a.Squarespace.Widgets.Confirmation.ANCHOR.CENTER,"strings.title":"Login Failed","strings.message":"An unexpected error happened, please try again."});console.error("failed to sign in with token",
b)}},this)}},_buildIFrameLoginDialog:function(){this.buildDialog()},_showLoginInIframe:function(b,d,c){this.show();a.Lang.isValue(this.loginRPCProvider)?(b=a.Node.create('<div class="login-overlay"><div class="close-x"></div></div>'),a.one("body").append(b),b.on("click",function(a){SQUARESPACE_LOGIN.loginRPCProvider.remove()},this)):(a.one("html").addClass("squarespace-damask"),a.one("html").removeClass("squarespace-cameron"),a.one("body").addClass("squarespace-login"))},loadRPCProvider:function(){try{this.loginRPCProvider=
new easyXDM.Rpc({},{local:{show:function(){SQUARESPACE_LOGIN._showLoginInIframe()},showCommentLogin:SQUARESPACE_LOGIN._showCommentLoginIniFrame},remote:{remove:{},v5LoginRequest:{},commentLoginSuccess:{}}})}catch(a){console.log("failed to load RPC",a)}},_loadRPCConsumer:function(b,d){this.loginRPCConsumer=new easyXDM.Rpc({remote:"https://oauth."+Static.SQUARESPACE_CONTEXT.appDomain+"/config/iframeLogin",container:b,onReady:d,props:{style:{width:"100%",height:"100%",top:0,left:0,position:"fixed",zIndex:30040}}},
{local:{remove:function(a){SQUARESPACE_LOGIN.iFrameLoginRemove(a)},v5LoginRequest:function(b,d,c,f){a.Squarespace.Auth.loginV5(b,d).then(c,f)},commentLoginSuccess:a.bind(this.onCommentLoginSuccess,this)},remote:{show:{},showCommentLogin:{}}})},iFrameLoginLoad:function(b){var d=a.Node.create('<div class="login-wrapper hidden" ></div>');a.one("body").append(d);this._loadRPCConsumer(d.getDOMNode(),b)},_getLoginOverlayNode:function(){var b=a.Node.create('<div class="login-overlay" style="position: fixed; top: 0; right:0; height: 100%; width: 100%; z-index: 30000; background: rgba(204, 204, 204, 0.65);"></div>');
this._loginOverlaySpinner=new a.Squarespace.Spinner({render:b,size:"large",color:"dark"});this._loginOverlaySpinner.get("boundingBox").setStyles({position:"fixed",top:"50%",left:"50%",marginLeft:"-11px",marginTop:"-11px"});return b},iFrameLoginShow:function(b){b&&b.preventDefault();b=this._getLoginOverlayNode();a.one("body").append(b);this.loginRPCConsumer?this._iFrameLoginShow():SQUARESPACE_LOGIN.iFrameLoginLoad(a.bind(this._iFrameLoginShow,this))},_iFrameLoginShow:function(){this.loginRPCConsumer.show();
a.one(".login-wrapper").removeClass("hidden");this._loginOverlaySpinner&&this._loginOverlaySpinner.destroy()},iFrameCommentLoginShow:function(b,d,c){var g=this._getLoginOverlayNode();a.one("body").append(g);this.loginRPCConsumer?this._iFrameCommentLoginShow(b,d,c):SQUARESPACE_LOGIN.iFrameLoginLoad(a.bind(this._iFrameCommentLoginShow,this,b,d,c))},_iFrameCommentLoginShow:function(b,d,c){var g=Static.SQUARESPACE_CONTEXT.website.identifier,m=this.loginRPCConsumer.showCommentLogin;a.soon(function(){m(b,
d,c,g)});a.one(".login-wrapper").removeClass("hidden");this._loginOverlaySpinner&&this._loginOverlaySpinner.destroy()},iFrameLoginHide:function(){this.overlay.hideScreenOverlay();a.one(".login-wrapper").addClass("hidden")},iFrameLoginRemove:function(b){this.loginRPCConsumer.destroy();delete this.loginRPCConsumer;a.one(".login-overlay").remove();a.one(".login-wrapper").remove();b&&this.fire("cancel")}}),a.augment(a.config.win.SQUARESPACE_LOGIN,a.EventTarget))},"1.0",{requires:"squarespace-util squarespace-dialog squarespace-dialog-hidden squarespace-external-authentication squarespace-enum thirdparty-easyxdm thirdparty-sha1 squarespace-dialog-description squarespace-external-authentication squarespace-dialog-multi-option squarespace-dialog-check squarespace-google-domains-utils squarespace-models-member-account squarespace-widgets-website-selector squarespace-widgets-login squarespace-plugin-v5login squarespace-widgets-website-selector squarespace-widgets-alert squarespace-dialog-text squarespace-spinner".split(" ")});
YUI.add("squarespace-dialog-hidden",function(a){var c=function(){};a.namespace("Squarespace.DialogFields").Hidden=a.Base.create("hidden",a.Squarespace.DialogField2,[],{initializer:function(){this.unplug(a.Plugin.WidgetAnim)},focus:null,enable:null,disable:null,blur:null,renderUI:c,bindUI:c,syncUI:c},{CSS_PREFIX:"sqs-hidden",ATTRS:{visible:{value:!1},focusable:{value:!1}}});a.Squarespace.DialogFields.HiddenField=a.Squarespace.DialogFields.Hidden},"1.0",{requires:["base","base-build","squarespace-dialog-field-2"]});
YUI.add("squarespace-external-authentication",function(a){a.namespace("Squarespace");a.Squarespace.ExternalAuthentication=a.Base.create("externalAuthentication",a.Base,[],{initializer:function(){this.publish("completed")},openPopupWindow:function(c,b,d){c="/auth/ExternalAuthenticationInitiate?"+this._buildQueryParams(c,b,d);this._oauthWindow=window.open(c,"ConnectWithOAuth","location=0,status=0,scrollbars=1,width=1020,height=520");this._checkClosedOnInterval();c=window.addEventListener?"addEventListener":
"attachEvent";(0,window[c])("attachEvent"==c?"onmessage":"message",a.bind(this._receiveMessage,this),!1)},_buildQueryParams:function(c,b,d){var g="serviceProvider="+c;a.Lang.isValue(b)&&a.Lang.isValue(d)&&(g+="&"+b+"="+d);this.get("useLoginFlag")&&(g+="&loginFlag=true");this.get("includeWebsiteList")&&(g+="&includeWebsiteList=true");b=this.get("targetIdentifier");a.Lang.isString(b)&&(g+="&targetIdentifier="+b);b=this.get("authenticationType");a.Lang.isValue(b)&&(g+="&type="+b);(b=this._getInviteCode())&&
(g+="&"+b);c===a.Squarespace.ExternalServiceProviders.FACEBOOK&&(g+="&redirArgs="+encodeURIComponent("scope"+a.Squarespace.FacebookExtendedPermissions));return g+="&uuid="+this.get("uuid")},_getInviteCode:function(){var c=document.location.search;"?"===c[0]&&(c=c.slice(1));return a.Array.find(c.split("&"),function(a){return 0===a.indexOf("invitation=")},this)},_receiveMessage:function(c){c=JSON.parse(c.data);a.Lang.isObject(c)&&this.setAttrs({websites:c.websites,website:c.website,memberAccount:c.memberAccount,
socialConfig:c.socialConfig,messageReceived:!0})},_checkClosedOnInterval:function(){this._oauthWindow.closed||window.callbackFinished?(window.callbackFinished=!1,this.get("messageReceived")?this.fire("completed"):a.Data.get({url:"/auth/ExternalAuthenticationGetResult?uuid="+this.get("uuid"),success:function(a){this.setAttrs({websites:a.websites,account:a.memberAccount,website:a.website,socialConfig:a.socialConfig});this.fire("completed")},failure:function(a){this.fire("completed")}},this)):a.later(200,
this,this._checkClosedOnInterval)}},{ATTRS:{useLoginFlag:{value:!1,validator:a.Squarespace.AttrValidators.isBoolean},includeWebsiteList:{value:!1,validator:a.Squarespace.AttrValidators.isBoolean},targetIdentifier:{value:null,validator:a.Squarespace.AttrValidators.isNullOrString},uuid:{value:null,valueFn:function(){var a=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var d=(a+16*Math.random())%16|0;a=Math.floor(a/16);return("x"==b?d:d&7|8).toString(16)})},
validator:a.Squarespace.AttrValidators.isNullOrString},authenticationType:{value:null},websites:{value:null},website:{value:null},memberAccount:{value:null},socialConfig:{value:null},messageReceived:{value:!1,validator:a.Squarespace.AttrValidators.isBoolean}}})},"1.0",{requires:["base","squarespace-attr-validators","squarespace-enum","squarespace-util"]});
(function(a,c,b,d,g,f){function e(a,b){var d=typeof a[b];return"function"==d||!!("object"==d&&a[b])||"unknown"==d}function h(){if(!v(navigator.plugins)&&"object"==typeof navigator.plugins["Shockwave Flash"]){var a=navigator.plugins["Shockwave Flash"].description;a&&(!v(navigator.mimeTypes)&&navigator.mimeTypes["application/x-shockwave-flash"]&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)&&(y=a.match(/\d+/g))}if(!y){var b;try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),
y=Array.prototype.slice.call(b.GetVariable("$version").match(/(\d+),(\d+),(\d+),(\d+)/),1)}catch(d){}}if(!y)return!1;a=parseInt(y[0],10);b=parseInt(y[1],10);G=9<a&&0<b;return!0}function k(){if(!q){q=!0;for(var a=0;a<I.length;a++)I[a]();I.length=0}}function m(a,b){q?a.call(b):I.push(function(){a.call(b)})}function s(){var a=parent;if(""!==M)for(var b=0,d=M.split(".");b<d.length;b++)a=a[d[b]];return a.easyXDM}function r(a){var b=a.toLowerCase().match(t);a=b[2];var d=b[3],b=b[4]||"";if("http:"==a&&":80"==
b||"https:"==a&&":443"==b)b="";return a+"//"+d+b}function x(a){a=a.replace(L,"$1/");if(!a.match(/^(http||https):\/\//)){var d="/"===a.substring(0,1)?"":b.pathname;"/"!==d.substring(d.length-1)&&(d=d.substring(0,d.lastIndexOf("/")+1));a=b.protocol+"//"+b.host+d+a}for(;l.test(a);)a=a.replace(l,"");return a}function p(a,b){var d="",c=a.indexOf("#");-1!==c&&(d=a.substring(c),a=a.substring(0,c));var c=[],g;for(g in b)b.hasOwnProperty(g)&&c.push(g+"="+f(b[g]));return a+(P?"#":-1==a.indexOf("?")?"?":"&")+
c.join("&")+d}function v(a){return"undefined"===typeof a}function w(a,b,d){var c,f;for(f in b)b.hasOwnProperty(f)&&(f in a?(c=b[f],"object"===typeof c?w(a[f],c,d):d||(a[f]=b[f])):a[f]=b[f]);return a}function D(a){if(v(F)){var b=c.body.appendChild(c.createElement("form")),d=b.appendChild(c.createElement("input"));d.name=C+"TEST"+O;F=d!==b.elements[d.name];c.body.removeChild(b)}F?b=c.createElement('<iframe name="'+a.props.name+'"/>'):(b=c.createElement("IFRAME"),b.name=a.props.name);b.id=b.name=a.props.name;
delete a.props.name;"string"==typeof a.container&&(a.container=c.getElementById(a.container));a.container||(w(b.style,{position:"absolute",top:"-2000px",left:"0px"}),a.container=c.body);d=a.props.src;a.props.src="javascript:false";w(b,a.props);b.border=b.frameBorder=0;b.allowTransparency=!0;a.container.appendChild(b);a.onLoad&&E(b,"load",a.onLoad);if(a.usePost){var f=a.container.appendChild(c.createElement("form")),g;f.target=b.name;f.action=d;f.method="POST";if("object"===typeof a.usePost)for(var e in a.usePost)a.usePost.hasOwnProperty(e)&&
(F?g=c.createElement('<input name="'+e+'"/>'):(g=c.createElement("INPUT"),g.name=e),g.value=a.usePost[e],f.appendChild(g));f.submit();f.parentNode.removeChild(f)}else b.src=d;a.props.src=d;return b}function H(d){var f=d.protocol,g;d.isHost=d.isHost||v(A.xdm_p);P=d.hash||!1;d.props||(d.props={});if(d.isHost)d.remote=x(d.remote),d.channel=d.channel||"default"+O++,d.secret=Math.random().toString(16).substring(2),v(f)&&(f=r(b.href)==r(d.remote)?"4":e(a,"postMessage")||e(c,"postMessage")?"1":d.swf&&e(a,
"ActiveXObject")&&h()?"6":"Gecko"===navigator.product&&"frameElement"in a&&-1==navigator.userAgent.indexOf("WebKit")?"5":d.remoteHelper?"2":"0");else{d.channel=A.xdm_c.replace(/["'<>\\]/g,"");d.secret=A.xdm_s;d.remote=A.xdm_e.replace(/["'<>\\]/g,"");var f=A.xdm_p,l;if(l=d.acl){a:{l=d.acl;var t=d.remote;"string"==typeof l&&(l=[l]);for(var u,k=l.length;k--;)if(u=l[k],u=RegExp("^"==u.substr(0,1)?u:"^"+u.replace(/(\*)/g,".$1").replace(/\?/g,".")+"$"),u.test(t)){l=!0;break a}l=!1}l=!l}if(l)throw Error("Access denied for "+
d.remote);}d.protocol=f;switch(f){case "0":w(d,{interval:100,delay:2E3,useResize:!0,useParent:!1,usePolling:!1},!0);if(d.isHost){if(!d.local){f=b.protocol+"//"+b.host;g=c.body.getElementsByTagName("img");for(t=g.length;t--;)if(l=g[t],l.src.substring(0,f.length)===f){d.local=l.src;break}d.local||(d.local=a)}f={xdm_c:d.channel,xdm_p:0};d.local===a?(d.usePolling=!0,d.useParent=!0,d.local=b.protocol+"//"+b.host+b.pathname+b.search,f.xdm_e=d.local,f.xdm_pa=1):f.xdm_e=x(d.local);d.container&&(d.useResize=
!1,f.xdm_po=1);d.remote=p(d.remote,f)}else w(d,{channel:A.xdm_c,remote:A.xdm_e,useParent:!v(A.xdm_pa),usePolling:!v(A.xdm_po),useResize:d.useParent?!1:d.useResize});g=[new n.stack.HashTransport(d),new n.stack.ReliableBehavior({}),new n.stack.QueueBehavior({encode:!0,maxLength:4E3-d.remote.length}),new n.stack.VerifyBehavior({initiate:d.isHost})];break;case "1":g=[new n.stack.PostMessageTransport(d)];break;case "2":d.remoteHelper=x(d.remoteHelper);g=[new n.stack.NameTransport(d),new n.stack.QueueBehavior,
new n.stack.VerifyBehavior({initiate:d.isHost})];break;case "3":g=[new n.stack.NixTransport(d)];break;case "4":g=[new n.stack.SameOriginTransport(d)];break;case "5":g=[new n.stack.FrameElementTransport(d)];break;case "6":y||h(),g=[new n.stack.FlashTransport(d)]}g.push(new n.stack.QueueBehavior({lazy:d.lazy,remove:!0}));return g}function K(a){for(var b,d={incoming:function(a,b){this.up.incoming(a,b)},outgoing:function(a,b){this.down.outgoing(a,b)},callback:function(a){this.up.callback(a)},init:function(){this.down.init()},
destroy:function(){this.down.destroy()}},c=0,f=a.length;c<f;c++)b=a[c],w(b,d,!0),0!==c&&(b.down=a[c-1]),c!==f-1&&(b.up=a[c+1]);return b}function Q(a){a.up.down=a.down;a.down.up=a.up;a.up=a.down=null}var N=this,O=Math.floor(1E4*Math.random()),u=Function.prototype,t=/^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/,l=/[\-\w]+\/\.\.\//,L=/([^:])\/\//g,M="",n={},R=a.easyXDM,C="easyXDM_",F,P=!1,y,G,E,z;if(e(a,"addEventListener"))E=function(a,b,d){a.addEventListener(b,d,!1)},z=function(a,b,d){a.removeEventListener(b,
d,!1)};else if(e(a,"attachEvent"))E=function(a,b,d){a.attachEvent("on"+b,d)},z=function(a,b,d){a.detachEvent("on"+b,d)};else throw Error("Browser not supported");var q=!1,I=[],B;"readyState"in c?(B=c.readyState,q="complete"==B||~navigator.userAgent.indexOf("AppleWebKit/")&&("loaded"==B||"interactive"==B)):q=!!c.body;if(!q){if(e(a,"addEventListener"))E(c,"DOMContentLoaded",k);else if(E(c,"readystatechange",function(){"complete"==c.readyState&&k()}),c.documentElement.doScroll&&a===top){var J=function(){if(!q){try{c.documentElement.doScroll("left")}catch(a){d(J,
1);return}k()}};J()}E(a,"load",k)}var A=function(a){a=a.substring(1).split("&");for(var b={},d,c=a.length;c--;)d=a[c].split("="),b[d[0]]=g(d[1]);return b}(/xdm_e=/.test(b.search)?b.search:b.hash),S=function(){var a={},b={a:[1,2,3]};if("undefined"!=typeof JSON&&"function"===typeof JSON.stringify&&'{"a":[1,2,3]}'===JSON.stringify(b).replace(/\s/g,""))return JSON;Object.toJSON&&'{"a":[1,2,3]}'===Object.toJSON(b).replace(/\s/g,"")&&(a.stringify=Object.toJSON);"function"===typeof String.prototype.evalJSON&&
(b='{"a":[1,2,3]}'.evalJSON(),b.a&&(3===b.a.length&&3===b.a[2])&&(a.parse=function(a){return a.evalJSON()}));return a.stringify&&a.parse?(S=function(){return a},a):null};w(n,{version:"2.4.16.3",query:A,stack:{},apply:w,getJSONObject:S,whenReady:m,noConflict:function(b){a.easyXDM=R;(M=b)&&(C="easyXDM_"+M.replace(".","_")+"_");return n}});n.DomHelper={on:E,un:z,requiresJSON:function(b){"object"==typeof a.JSON&&a.JSON||c.write('<script type="text/javascript" src="'+b+'">\x3c/script>')}};(function(){var a=
{};n.Fn={set:function(b,d){a[b]=d},get:function(b,d){var c=a[b];d&&delete a[b];return c}}})();n.Socket=function(a){var b=K(H(a).concat([{incoming:function(b,d){a.onMessage(b,d)},callback:function(b){if(a.onReady)a.onReady(b)}}])),d=r(a.remote);this.origin=r(a.remote);this.destroy=function(){b.destroy()};this.postMessage=function(a){b.outgoing(a,d)};b.init()};n.Rpc=function(a,b){if(b.local)for(var d in b.local)if(b.local.hasOwnProperty(d)){var c=b.local[d];"function"===typeof c&&(b.local[d]={method:c})}var f=
K(H(a).concat([new n.stack.RpcBehavior(this,b),{callback:function(b){if(a.onReady)a.onReady(b)}}]));this.origin=r(a.remote);this.destroy=function(){f.destroy()};f.init()};n.stack.SameOriginTransport=function(a){var c,f,g,e;return c={outgoing:function(a,b,d){g(a);d&&d()},destroy:function(){f&&(f.parentNode.removeChild(f),f=null)},onDOMReady:function(){e=r(a.remote);a.isHost?(w(a.props,{src:p(a.remote,{xdm_e:b.protocol+"//"+b.host+b.pathname,xdm_c:a.channel,xdm_p:4}),name:C+a.channel+"_provider"}),
f=D(a),n.Fn.set(a.channel,function(a){g=a;d(function(){c.up.callback(!0)},0);return function(a){c.up.incoming(a,e)}})):(g=s().Fn.get(a.channel,!0)(function(a){c.up.incoming(a,e)}),d(function(){c.up.callback(!0)},0))},init:function(){m(c.onDOMReady,c)}}};n.stack.FlashTransport=function(a){function f(a,b){d(function(){e.up.incoming(a,l)},0)}function g(b){var d=a.swf+"?host="+a.isHost,f="easyXDM_swf_"+Math.floor(1E4*Math.random());n.Fn.set("flash_loaded"+b.replace(/[\-.]/g,"_"),function(){n.stack.FlashTransport[b].swf=
u=k.firstChild;for(var a=n.stack.FlashTransport[b].queue,d=0;d<a.length;d++)a[d]();a.length=0});a.swfContainer?k="string"==typeof a.swfContainer?c.getElementById(a.swfContainer):a.swfContainer:(k=c.createElement("div"),w(k.style,G&&a.swfNoThrottle?{height:"20px",width:"20px",position:"fixed",right:0,top:0}:{height:"1px",width:"1px",position:"absolute",overflow:"hidden",right:0,top:0}),c.body.appendChild(k));var e="callback=flash_loaded"+b.replace(/[\-.]/g,"_")+"&proto="+N.location.protocol+"&domain="+
N.location.href.match(t)[3]+"&port="+(N.location.href.match(t)[4]||"")+"&ns="+M;k.innerHTML="<object height='20' width='20' type='application/x-shockwave-flash' id='"+f+"' data='"+d+"'><param name='allowScriptAccess' value='always'></param><param name='wmode' value='transparent'><param name='movie' value='"+d+"'></param><param name='flashvars' value='"+e+"'></param><embed type='application/x-shockwave-flash' FlashVars='"+e+"' allowScriptAccess='always' wmode='transparent' src='"+d+"' height='1' width='1'></embed></object>"}
var e,h,l,u,k;return e={outgoing:function(b,d,c){u.postMessage(a.channel,b.toString());c&&c()},destroy:function(){try{u.destroyChannel(a.channel)}catch(b){}u=null;h&&(h.parentNode.removeChild(h),h=null)},onDOMReady:function(){l=a.remote;n.Fn.set("flash_"+a.channel+"_init",function(){d(function(){e.up.callback(!0)})});n.Fn.set("flash_"+a.channel+"_onMessage",f);a.swf=x(a.swf);var c=a.swf.match(t)[3],k=function(){n.stack.FlashTransport[c].init=!0;u=n.stack.FlashTransport[c].swf;u.createChannel(a.channel,
a.secret,r(a.remote),a.isHost);a.isHost&&(G&&a.swfNoThrottle&&w(a.props,{position:"fixed",right:0,top:0,height:"20px",width:"20px"}),w(a.props,{src:p(a.remote,{xdm_e:r(b.href),xdm_c:a.channel,xdm_p:6,xdm_s:a.secret}),name:C+a.channel+"_provider"}),h=D(a))};n.stack.FlashTransport[c]&&n.stack.FlashTransport[c].init?k():n.stack.FlashTransport[c]?n.stack.FlashTransport[c].queue.push(k):(n.stack.FlashTransport[c]={queue:[k]},g(c))},init:function(){m(e.onDOMReady,e)}}};n.stack.PostMessageTransport=function(c){function f(a){var d;
if(a.origin)d=r(a.origin);else if(a.uri)d=r(a.uri);else if(a.domain)d=b.protocol+"//"+a.domain;else throw"Unable to retrieve the origin of the event";d==l&&a.data.substring(0,c.channel.length+1)==c.channel+" "&&g.up.incoming(a.data.substring(c.channel.length+1),d)}var g,e,h,l;return g={outgoing:function(a,b,d){h.postMessage(c.channel+" "+a,b||l);d&&d()},destroy:function(){z(a,"message",f);e&&(h=null,e.parentNode.removeChild(e),e=null)},onDOMReady:function(){l=r(c.remote);if(c.isHost){var t=function(b){b.data==
c.channel+"-ready"&&(h="postMessage"in e.contentWindow?e.contentWindow:e.contentWindow.document,z(a,"message",t),E(a,"message",f),d(function(){g.up.callback(!0)},0))};E(a,"message",t);w(c.props,{src:p(c.remote,{xdm_e:r(b.href),xdm_c:c.channel,xdm_p:1}),name:C+c.channel+"_provider"});e=D(c)}else E(a,"message",f),h="postMessage"in a.parent?a.parent:a.parent.document,h.postMessage(c.channel+"-ready",l),d(function(){g.up.callback(!0)},0)},init:function(){m(g.onDOMReady,g)}}};n.stack.FrameElementTransport=
function(f){var g,e,h,l;return g={outgoing:function(a,b,d){h.call(this,a);d&&d()},destroy:function(){e&&(e.parentNode.removeChild(e),e=null)},onDOMReady:function(){l=r(f.remote);f.isHost?(w(f.props,{src:p(f.remote,{xdm_e:r(b.href),xdm_c:f.channel,xdm_p:5}),name:C+f.channel+"_provider"}),e=D(f),e.fn=function(a){delete e.fn;h=a;d(function(){g.up.callback(!0)},0);return function(a){g.up.incoming(a,l)}}):(c.referrer&&r(c.referrer)!=A.xdm_e&&(a.top.location=A.xdm_e),h=a.frameElement.fn(function(a){g.up.incoming(a,
l)}),g.up.callback(!0))},init:function(){m(g.onDOMReady,g)}}};n.stack.NameTransport=function(a){function b(d){l.contentWindow.sendMessage(d,a.remoteHelper+(h?"#_3":"#_2")+a.channel)}function c(){h?(2===++u||!h)&&e.up.callback(!0):(b("ready"),e.up.callback(!0))}function f(a){e.up.incoming(a,L)}function g(){k&&d(function(){k(!0)},0)}var e,h,l,t,u,k,L,K;return e={outgoing:function(a,d,c){k=c;b(a)},destroy:function(){l.parentNode.removeChild(l);l=null;h&&(t.parentNode.removeChild(t),t=null)},onDOMReady:function(){h=
a.isHost;u=0;L=r(a.remote);a.local=x(a.local);h?(n.Fn.set(a.channel,function(b){h&&"ready"===b&&(n.Fn.set(a.channel,f),c())}),K=p(a.remote,{xdm_e:a.local,xdm_c:a.channel,xdm_p:2}),w(a.props,{src:K+"#"+a.channel,name:C+a.channel+"_provider"}),t=D(a)):(a.remoteHelper=a.remote,n.Fn.set(a.channel,f));var b=function(){var f=l||this;z(f,"load",b);n.Fn.set(a.channel+"_load",g);(function U(){"function"==typeof f.contentWindow.sendMessage?c():d(U,50)})()};l=D({props:{src:a.local+"#_4"+a.channel},onLoad:b})},
init:function(){m(e.onDOMReady,e)}}};n.stack.HashTransport=function(b){function c(){if(u){var a=u.location.href,b="",d=a.indexOf("#");-1!=d&&(b=a.substring(d));b&&b!=l&&(l=b,f.up.incoming(l.substring(l.indexOf("_")+1),n))}}var f,g,e,h,l,t,u,k,p,n;return f={outgoing:function(a,d){if(k){var c=b.remote+"#"+t++ +"_"+a;(g||!p?k.contentWindow:k).location=c}},destroy:function(){a.clearInterval(e);(g||!p)&&k.parentNode.removeChild(k);k=null},onDOMReady:function(){g=b.isHost;h=b.interval;l="#"+b.channel;t=
0;p=b.useParent;n=r(b.remote);if(g){w(b.props,{src:b.remote,name:C+b.channel+"_provider"});if(p)b.onLoad=function(){u=a;e=setInterval(c,h);f.up.callback(!0)};else{var L=0,m=b.delay/50;(function T(){if(++L>m)throw Error("Unable to reference listenerwindow");try{u=k.contentWindow.frames[C+b.channel+"_consumer"]}catch(a){}u?(e=setInterval(c,h),f.up.callback(!0)):d(T,50)})()}k=D(b)}else u=a,e=setInterval(c,h),p?(k=parent,f.up.callback(!0)):(w(b,{props:{src:b.remote+"#"+b.channel+new Date,name:C+b.channel+
"_consumer"},onLoad:function(){f.up.callback(!0)}}),k=D(b))},init:function(){m(f.onDOMReady,f)}}};n.stack.ReliableBehavior=function(a){var b,d,c=0,f=0,g="";return b={incoming:function(a,e){var h=a.indexOf("_"),l=a.substring(0,h).split(",");a=a.substring(h+1);l[0]==c&&(g="",d&&(d(!0),d=null));0<a.length&&(b.down.outgoing(l[1]+","+c+"_"+g,e),f!=l[1]&&(f=l[1],b.up.incoming(a,e)))},outgoing:function(a,e,h){g=a;d=h;b.down.outgoing(f+","+ ++c+"_"+a,e)}}};n.stack.QueueBehavior=function(a){function b(){if(a.remove&&
0===e.length)Q(c);else if(!h&&!(0===e.length||t)){h=!0;var f=e.shift();c.down.outgoing(f.data,f.origin,function(a){h=!1;f.callback&&d(function(){f.callback(a)},0);b()})}}var c,e=[],h=!0,l="",t,u=0,k=!1,p=!1;return c={init:function(){v(a)&&(a={});a.maxLength&&(u=a.maxLength,p=!0);a.lazy?k=!0:c.down.init()},callback:function(a){h=!1;var d=c.up;b();d.callback(a)},incoming:function(b,d){if(p){var f=b.indexOf("_"),e=parseInt(b.substring(0,f),10);l+=b.substring(f+1);0===e&&(a.encode&&(l=g(l)),c.up.incoming(l,
d),l="")}else c.up.incoming(b,d)},outgoing:function(d,g,h){a.encode&&(d=f(d));var l=[],t;if(p){for(;0!==d.length;)t=d.substring(0,u),d=d.substring(t.length),l.push(t);for(;t=l.shift();)e.push({data:l.length+"_"+t,origin:g,callback:0===l.length?h:null})}else e.push({data:d,origin:g,callback:h});k?c.down.init():b()},destroy:function(){t=!0;c.down.destroy()}}};n.stack.VerifyBehavior=function(a){function b(){c=Math.random().toString(16).substring(2);d.down.outgoing(c)}var d,c,f;return d={incoming:function(g,
e){var h=g.indexOf("_");-1===h?g===c?d.up.callback(!0):f||(f=g,a.initiate||b(),d.down.outgoing(g)):g.substring(0,h)===f&&d.up.incoming(g.substring(h+1),e)},outgoing:function(a,b,f){d.down.outgoing(c+"_"+a,b,f)},callback:function(d){a.initiate&&b()}}};n.stack.RpcBehavior=function(a,b){function d(a){a.jsonrpc="2.0";g.down.outgoing(e.stringify(a))}function c(a,b){var f=Array.prototype.slice;return function(){var c=arguments.length,g,e={method:b};0<c&&"function"===typeof arguments[c-1]?(1<c&&"function"===
typeof arguments[c-2]?(g={success:arguments[c-2],error:arguments[c-1]},e.params=f.call(arguments,0,c-2)):(g={success:arguments[c-1]},e.params=f.call(arguments,0,c-1)),l[""+ ++h]=g,e.id=h):e.params=f.call(arguments,0);a.namedParams&&1===e.params.length&&(e.params=e.params[0]);d(e)}}function f(a,b,c,g){if(c){var e,h;b?(e=function(a){e=u;d({id:b,result:a})},h=function(a,c){h=u;var f={id:b,error:{code:-32099,message:a}};c&&(f.error.data=c);d(f)}):e=h=u;"[object Array]"!==Object.prototype.toString.call(g)&&
(g=[g]);try{var l=c.method.apply(c.scope,g.concat([e,h]));v(l)||e(l)}catch(t){h(t.message)}}else b&&d({id:b,error:{code:-32601,message:"Procedure not found."}})}var g,e=b.serializer||S(),h=0,l={};return g={incoming:function(a,c){var g=e.parse(a);if(g.method)b.handle?b.handle(g,d):f(g.method,g.id,b.local[g.method],g.params);else{var h=l[g.id];g.error?h.error&&h.error(g.error):h.success&&h.success(g.result);delete l[g.id]}},init:function(){if(b.remote)for(var d in b.remote)b.remote.hasOwnProperty(d)&&
(a[d]=c(b.remote[d],d));g.down.init()},destroy:function(){for(var d in b.remote)b.remote.hasOwnProperty(d)&&a.hasOwnProperty(d)&&delete a[d];g.down.destroy()}}};N.easyXDM=n})(window,document,location,window.setTimeout,decodeURIComponent,encodeURIComponent);YUI.add("thirdparty-easyxdm",function(a){},"2.4.16");var hexcase=0,b64pad="=",chrsz=8;function hex_sha1(a){return binb2hex(core_sha1(str2binb(a),a.length*chrsz))}function b64_sha1(a){return binb2b64(core_sha1(str2binb(a),a.length*chrsz))}
function str_sha1(a){return binb2str(core_sha1(str2binb(a),a.length*chrsz))}function hex_hmac_sha1(a,c){return binb2hex(core_hmac_sha1(a,c))}function b64_hmac_sha1(a,c){return binb2b64(core_hmac_sha1(a,c))}function str_hmac_sha1(a,c){return binb2str(core_hmac_sha1(a,c))}function sha1_vm_test(){return"a9993e364706816aba3e25717850c26c9cd0d89d"==hex_sha1("abc")}
function core_sha1(a,c){a[c>>5]|=128<<24-c%32;a[(c+64>>9<<4)+15]=c;for(var b=Array(80),d=1732584193,g=-271733879,f=-1732584194,e=271733878,h=-1009589776,k=0;k<a.length;k+=16){for(var m=d,s=g,r=f,x=e,p=h,v=0;80>v;v++){b[v]=16>v?a[k+v]:rol(b[v-3]^b[v-8]^b[v-14]^b[v-16],1);var w=safe_add(safe_add(rol(d,5),sha1_ft(v,g,f,e)),safe_add(safe_add(h,b[v]),sha1_kt(v))),h=e,e=f,f=rol(g,30),g=d,d=w}d=safe_add(d,m);g=safe_add(g,s);f=safe_add(f,r);e=safe_add(e,x);h=safe_add(h,p)}return[d,g,f,e,h]}
function sha1_ft(a,c,b,d){return 20>a?c&b|~c&d:40>a?c^b^d:60>a?c&b|c&d|b&d:c^b^d}function sha1_kt(a){return 20>a?1518500249:40>a?1859775393:60>a?-1894007588:-899497514}function core_hmac_sha1(a,c){var b=str2binb(a);16<b.length&&(b=core_sha1(b,a.length*chrsz));for(var d=Array(16),g=Array(16),f=0;16>f;f++)d[f]=b[f]^909522486,g[f]=b[f]^1549556828;b=core_sha1(d.concat(str2binb(c)),512+c.length*chrsz);return core_sha1(g.concat(b),672)}
function safe_add(a,c){var b=(a&65535)+(c&65535);return(a>>16)+(c>>16)+(b>>16)<<16|b&65535}function rol(a,c){return a<<c|a>>>32-c}function str2binb(a){for(var c=[],b=(1<<chrsz)-1,d=0;d<a.length*chrsz;d+=chrsz)c[d>>5]|=(a.charCodeAt(d/chrsz)&b)<<24-d%32;return c}function binb2str(a){for(var c="",b=(1<<chrsz)-1,d=0;d<32*a.length;d+=chrsz)c+=String.fromCharCode(a[d>>5]>>>24-d%32&b);return c}
function binb2hex(a){for(var c=hexcase?"0123456789ABCDEF":"0123456789abcdef",b="",d=0;d<4*a.length;d++)b+=c.charAt(a[d>>2]>>8*(3-d%4)+4&15)+c.charAt(a[d>>2]>>8*(3-d%4)&15);return b}function binb2b64(a){for(var c="",b=0;b<4*a.length;b+=3)for(var d=(a[b>>2]>>8*(3-b%4)&255)<<16|(a[b+1>>2]>>8*(3-(b+1)%4)&255)<<8|a[b+2>>2]>>8*(3-(b+2)%4)&255,g=0;4>g;g++)c=8*b+6*g>32*a.length?c+b64pad:c+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(d>>6*(3-g)&63);return c}
YUI.add("thirdparty-sha1",function(a){},"2.97.0");
YUI.add("squarespace-dialog-description",function(a){var c=a.namespace("Squarespace.DialogFields").Description=a.Base.create("descriptionField",a.Squarespace.DialogField2,[],{destructor:function(){this._descEl=null},renderUI:function(){c.superclass.renderUI.call(this);var b=this.get("padding");this._descEl=this.get("contentBox").one(".custom-field-description");a.Lang.isArray(b)&&0<b.length&&this._descEl.setStyles({paddingTop:b[0],paddingBottom:b[1]});this._attachNode("title");this._attachNode("text")},
bindUI:function(){c.superclass.bindUI.call(this);this.after(["titleChange","textChange"],this.syncUI,this)},syncUI:function(){c.superclass.syncUI.call(this);this._descEl.empty();this._attachNode("title");this._attachNode("text")},_attachNode:function(b){var d=this.get(b);a.Lang.isString(d)&&0<d.length&&(attrNode=a.Node.create('<div class="'+b+'">'+d+"</div>"),this._descEl.append(attrNode))},_getAsString:function(b){return!a.Lang.isValue(b)?"":b+""},setTitle:function(a){this.set("title",a)},setText:function(a){this.set("text",
a)}},{CSS_PREFIX:"sqs-description",TEMPLATE:'<div class="custom-field-description"></div>',ATTRS:{title:{value:"",getter:this._getAsString},text:{value:"",getter:this._getAsString},className:{value:"",validator:a.Lang.isString},padding:{value:[],validator:a.Lang.isArray},focusable:{value:!1}}})},"1.0.0",{requires:["node","base","squarespace-dialog-field-2"]});
YUI.add("squarespace-dialog-multi-option",function(a){var c=a.namespace("Squarespace.DialogFields").MultiOption=a.Base.create("multiOption",a.Squarespace.DialogField2,[],{initializer:function(b){this.get("data");!this.get("data")&&!a.Lang.isUndefined(b.defaultValue)&&this.set("data",b.defaultValue);this._selectedOptionEl=null;this.publish("option-click",{broadcast:2})},renderUI:function(){c.superclass.renderUI.call(this);this._calculateMargins();this._renderTitle();this._renderOptions()},bindUI:function(){this.get("contentBox").delegate("click",
this._onOptionClick,".option",this);this.after("optionsChange",this._renderOptions,this);this.after("stringsChange",this._renderTitle,this)},syncUI:function(){c.superclass.syncUI.call(this);this._setupOptionWidths()},getBBInnerWidth:function(){var a=this.get("boundingBox");return a.get("offsetWidth")-(parseInt(a.getComputedStyle("paddingLeft"),10)+parseInt(a.getComputedStyle("paddingRight"),10))},selectOption:function(a){this.get("contentBox").all(".option").each(function(d){this._optionMatchesData(d,
a)&&this._selectOption(d)},this)},addOption:function(a){a=this.get("options");a.push(optionOjb);this.set("options",a)},_renderTitle:function(){var b=this.get("strings.title"),d=this.get("contentBox"),c=d.one(".title");b&&a.Lang.isNull(c)?d.append(a.Node.create('<div class="title">'+this.get("strings.title")+"</div>")):b?c.empty().setHTML(this.get("strings.title")):!b&&!a.Lang.isNull(c)&&c.remove(!0)},_renderOptions:function(){var b=this.get("contentBox"),d=this.get("options"),c=this._getOptionWidth();
b.all(".option").remove();a.Array.each(d,function(d){if(d.section)b.append(a.Node.create('<div class="option-label">'+d.section+"</div>"));else{var e=a.Node.create(a.Lang.sub('<div class="option" data-value="{value}"><div class="option-content"><div class="option-title">{title}</div></div></div>',d));e.setData(d);e.setStyles({width:c});var h=d.description;h&&e.one(".option-content").append(a.Node.create('<div class="option-description">'+h+"</div>"));d.icon?e.addClass("icon-"+d.icon):e.addClass("no-icon");
b.append(e);this._optionMatchesData(e)&&this._markSelected(e);d.upgradeLocked&&(e.addClass("upgrade-locked"),new a.Squarespace.ToolTip({target:".option.upgrade-locked",title:"Upgrade to Connect",body:"You must be on the Business Plan to use this feature.",dialogTooltip:!0,showTimeout:350}),e.on("click",function(){(new a.Squarespace.Widgets.Confirmation({"strings.cancel":"Not Now","strings.confirm":"Go to Upgrade","strings.title":"Do you want to upgrade?","strings.message":"Upgrading to the Business Plan will enable this feature."})).on("confirm",
d.upgradeConfirmCb)}))}},this)},_selectOptions:function(){this.get("contentBox").all(".option").each(function(a){this._optionMatchesData(a)&&this._selectOption(a)},this)},_optionMatchesData:function(b,d){a.Lang.isUndefined(d)&&(d=this.get("data"));var c=b.getData("value");if(this.get("numeric"))return d===a.Number.parse(c);a.Lang.isObject(c)&&a.Lang.isObject(d)&&console.warn("Trying to compare to objects, which is a bit out of scope.");return d===c},_onOptionClick:function(b){b.halt();b=b.target.hasClass("option")?
b.target:b.target.ancestor(".option");var d=this.get("optionClickCb");b.hasClass("upgrade-locked")||this._selectOption(b);a.Lang.isFunction(d)&&d(this.get("data"));this.fire("option-click",{option:this.get("data")})},_markSelected:function(a){a!=this._selectedOptionEl&&(this._selectedOptionEl&&this._selectedOptionEl.removeClass("selected"),a.addClass("selected"),this._selectedOptionEl=a)},_selectOption:function(b){if(b!=this._selectedOptionEl){this._markSelected(b);b=b.getData("value");if(this.get("numeric")){var d=
a.Number.parse(b);a.Lang.isNumber(d)&&(b=d)}this.set("data",b);this.get("submitOnSelect")&&(b=this.get("dialog"),a.Lang.isValue(b)&&b.saveAndClose())}},_getOptionWidth:function(){var b=this.get("optionWidth");if(a.Lang.isValue(b))return b;b=this.get("options");b=parseInt(this.get("columns"),10)||b.length;return this.getBBInnerWidth()/b-this.get("marginOffset")},_calculateMargins:function(){var b=a.Node.create('<div class="option" style="visibility:hidden;"></div>');this.get("contentBox").append(b);
var d=parseInt(b.getStyle("marginLeft"),10),c=parseInt(b.getStyle("marginRight"),10);this.set("marginOffset",d+c);b.remove()},_setupOptionWidths:function(){var a=this.get("columns")||this.get("options").length;0<parseInt(a,10)&&this.get("boundingBox").addClass("columns-"+a);this.get("contentBox").all(".option").setStyle("width",this._getOptionWidth())}},{CSS_PREFIX:"sqs-multi-option",ATTRS:{data:{setter:function(b){return this.get("numeric")?a.Number.parse(b):b}},options:{value:null},optionClickCb:{value:null,
setter:function(b){return!a.Lang.isFunction(b)?null:b}},optionWidth:{value:null},submitOnSelect:{value:!1},columns:{value:null},marginOffset:{value:0,validator:a.Lang.isNumber},numeric:{value:!1,validator:a.Lang.isBoolean},readOnly:{value:!0}}})},"1.0",{requires:["base","datatype-number-parse","squarespace-dialog-field-2","squarespace-widgets-confirmation"]});
YUI.add("datatype-number-parse",function(a,c){var b=a.Escape.regex;a.mix(a.namespace("Number"),{_buildParser:a.cached(function(a,c,f,e){var h=[],k;a&&h.push("^\\s*"+b(a)+"\\s*");c&&h.push("\\s*"+b(c)+"\\s*$");f&&h.push(b(f)+"(?=\\d)");k=RegExp("(?:"+h.join("|")+")","g");"."===e&&(e=null);return function(a){a=a.replace(k,"");return e?a.replace(e,"."):a}}),parse:function(b,c){var f;c&&"string"===typeof b&&(f=this._buildParser(c.prefix,c.suffix,c.thousandsSeparator,c.decimalSeparator),b=f(b));"string"===
typeof b&&""!==a.Lang.trim(b)&&(b=+b);if("number"!==typeof b||!isFinite(b))b=null;return b}});a.namespace("Parsers").number=a.Number.parse;a.namespace("DataType");a.DataType.Number=a.Number},"3.17.2",{requires:["escape"]});
YUI.add("squarespace-dialog-check",function(a){a.namespace("Squarespace.DialogFields");var c=function(a,d){return function(c){c.halt();a.call(d,c)}};a.Squarespace.DialogFields.Check=a.Base.create("check",a.Squarespace.DialogField2,[],{initializer:function(b){!a.Lang.isValue(b.data)&&a.Lang.isValue(b.defaultValue)&&this.set("data",b.defaultValue)},bindUI:function(){a.Squarespace.DialogFields.Check.superclass.bindUI.call(this);a.Squarespace.Utils.onPointerAction(this.get("boundingBox"),c(this._toggleActive,
this));this.get("boundingBox").after("mousedown",function(a){a.halt()},this)},syncUI:function(){a.Squarespace.DialogFields.Check.superclass.syncUI.call(this);this.get("contentBox").empty().setHTML(this.renderTemplate());a.Lang.isValue(this.get("strings.description"))?this.get("boundingBox").addClass("has-description"):this.get("boundingBox").addClass("has-no-description")},_toggleActive:function(a){this.set("data",!this.get("data"),{click:a})}},{CSS_PREFIX:"sqs-check",HANDLEBARS_TEMPLATE:"dialog-check.html",
ATTRS:{data:{value:!1}}})},"1.0",{requires:"base base-build event-tap squarespace-dialog-field-2 squarespace-dialog-check-template squarespace-util".split(" ")});
YUI.add("squarespace-dialog-check-template",function(a){var c=a.Handlebars;(function(){var a=c.template;(c.templates=c.templates||{})["dialog-check.html"]=a(function(a,b,c,e,h){this.compilerInfo=[4,">= 1.0.0"];c=this.merge(c,a.helpers);h=h||{};var k,m=this.escapeExpression;a='<div class="check-element ';if((e=c["if"].call(b,b.data,{hash:{},inverse:this.noop,fn:this.program(1,function(a,b){return"active"},h),data:h}))||0===e)a+=e;a+='">\n  ';if((k=c["if"].call(b,(e=b.strings,null==e||!1===e?e:e.title),
{hash:{},inverse:this.noop,fn:this.program(3,function(a,b){var d,c;return d=""+('\n    <div class="title">'+m((c=(c=a.strings,null==c||!1===c?c:c.title),"function"===typeof c?c.apply(a):c))+"</div>\n  ")},h),data:h}))||0===k)a+=k;a+="\n  ";if((k=c["if"].call(b,(e=b.strings,null==e||!1===e?e:e.description),{hash:{},inverse:this.noop,fn:this.program(5,function(a,b){var d,c,f;d='\n    <div class="description">';if((f=(c=(c=a.strings,null==c||!1===c?c:c.description),"function"===typeof c?c.apply(a):c))||
0===f)d+=f;return d+"</div>\n  "},h),data:h}))||0===k)a+=k;return a+"\n</div>"})})();a.Handlebars.registerPartial("dialog-check.html".replace("/","."),c.templates["dialog-check.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-google-domains-utils",function(a){a.namespace("Squarespace.GoogleDomains");var c=function(b){a.Lang.isString(b)||(b="");(new a.Squarespace.Lightbox({disableNormalClose:!0,clickAnywhereToExit:!1,content:'<div class="bigtext"><div class="title">Failed to add domain</div><div class="description">'+b+'</div><div class="buttons"></div></div>',margin:100,noHeightConstrain:!0})).show()};a.Squarespace.GoogleDomains.getGoogleDomainUrlParams=function(){var b=window.location.search;return{userId:a.QueryString.parse(b.substr(1)).userId||
null,domainName:a.QueryString.parse(b.substr(1)).domainName||null}};a.Squarespace.GoogleDomains.isGoogleDomainFlow=function(){var b=a.Squarespace.SessionStorage.getSessionData("googleDomain");if(a.Lang.isObject(b))return!0;b=a.Squarespace.GoogleDomains.getGoogleDomainUrlParams();return!a.Lang.isNull(b.userId)&&!a.Lang.isNull(b.domainName)?!0:!1};a.Squarespace.GoogleDomains.showConfirmMessage=function(b,d){var c=a.Squarespace.GoogleDomains.getGoogleDomainUrlParams(),f=c.domainName,e=c.userId,c="http://"+
window.location.hostname,h=new a.Squarespace.Lightbox({disableNormalClose:!0,clickAnywhereToExit:!1,content:'<div class="bigtext"><div class="title">Link Domain: '+encodeURI(f)+'</div><div class="description">Your site <strong>'+c+"</strong> will be available at <strong>http://www."+f+'</strong>.</div><div class="buttons"><input type="button" class="login-button" name="login" value="Link Domain"/></div></div>',noHeightConstrain:!0});h.show();h.getContentEl().on("click",function(){h.hide();d(b,e,f)})};
a.Squarespace.GoogleDomains.startConsentFlow=function(b,d,g){var f=new a.Squarespace.Spinner({color:"light",size:"large",render:a.one(".spinner-wrapper")});f.spin();a.Squarespace.Analytics.trackInternal("domain_link_google_domain_start");return a.Squarespace.GoogleDomainsConsentService.getConsent(g,d,b).then(function(b){(new a.Squarespace.Models.GoogleDomain({googleAuthRequestId:b.requestId})).save({},function(b){f.stop();a.Lang.isValue(b)?c(b.responseJSON.message):window.location="/config#module=settings&settings-subpanelName=domain-settings"})},
function(b){a.Squarespace.Analytics.trackInternal("domain_link_domain_failure",{host:"google"});f.stop();c(b)})}},"1.0",{requires:["querystring","squarespace-google-domains-consent-service","squarespace-models-google-domain","squarespace-session-storage"]});
YUI.add("squarespace-google-domains-consent-service",function(a){a.namespace("Squarespace");a.Squarespace.GoogleDomainsConsentService=new (a.Base.create("domainConsentService",a.Base,[],{initializer:function(){this._openWindows={};this._messageCallbacks={};this._messageEventHandler=window.addEventListener("message",a.bind(this._routeMessage,this))},destructor:function(){window.removeEventListener("message",this._messageEventHandler);this._endMonitor()},getConsent:function(c,b,d){return a.Squarespace.Promises.create(function(a,
f){this._messageCallbacks[c]=function(b){b.consentGranted?a({requestId:b.requestId}):f()};this._openConsentWindow(c,b,d)},this)},getConsentForNewSite:function(c,b){return a.Squarespace.Promises.create(function(a,g){this._messageCallbacks[c]=function(b){b.consentGranted?a({requestId:b.requestId}):g()};this._openSignupConsentWindow(c,b)},this)},getDomainOnlyConsent:function(c,b,d){return a.Squarespace.Promises.create(function(a,f){this._messageCallbacks[c]=function(b){b.consentGranted?a({requestId:b.requestId}):
f()};this._openDomainConsentOnlyWindow(c,b,d)},this)},getConsentForList:function(){return a.Squarespace.Promises.create(function(c,b){var d=a.guid();this._messageCallbacks[d]=function(a){a.consentGranted?c({requestId:a.requestId}):b()};this._openListConsentWindow(d)},this)},_routeMessage:function(c){var b=c.data.domain;if(a.Lang.isString(b)){var d=this._messageCallbacks[b];a.Lang.isFunction(d)&&(d.call(this,c.data),delete this._messageCallbacks[b])}},_registerOpenWindow:function(c,b){0>=a.Object.size(this._openWindows)&&
this._beginMonitor();this._openWindows[c]=b},_unregisterOpenWindow:function(c){delete this._openWindows[c];0>=a.Object.size(this._openWindows)&&this._endMonitor()},_endMonitor:function(){this._monitor&&this._monitor.cancel()},_beginMonitor:function(){this._monitor=a.later(300,this,function(){var c=[];a.Object.each(this._openWindows,function(a,d){a.closed&&(this._routeMessage({data:{domain:d,consentGranted:!1}}),c.push(d))},this);a.Array.each(c,this._unregisterOpenWindow,this)},null,!0)},_openListConsentWindow:function(c){var b=
a.Lang.sub("https://oauth.{appDomain}/auth/google-web-hosting/list-domains-consent-initialize?requestIdentifier={identifier}",{identifier:c,appDomain:Static.SQUARESPACE_CONTEXT.appDomain});this._openConsentPopup(b,c)},_openDomainConsentOnlyWindow:function(c,b,d){b=a.Lang.sub("https://oauth.{appDomain}/auth/google-web-hosting/domain-consent-initialize?domain={domain}&requestId={requestId}",{requestId:b,domain:c,websiteId:d,appDomain:Static.SQUARESPACE_CONTEXT.appDomain});this._openConsentPopup(b,c)},
_openConsentWindow:function(c,b,d){b=a.Lang.sub("https://oauth.{appDomain}/auth/google-web-hosting/consent-initialize?domain={domain}&websiteId={websiteId}&userId={userId}",{domain:c,appDomain:Static.SQUARESPACE_CONTEXT.appDomain,websiteId:d||"",userId:b});this._openConsentPopup(b,c)},_openSignupConsentWindow:function(c,b){var d=a.Lang.sub("https://oauth.{appDomain}/auth/google-web-hosting/signup-consent-initialize?domain={domain}&userId={userId}",{domain:c,userId:b,appDomain:Static.SQUARESPACE_CONTEXT.appDomain});
this._openConsentPopup(d,c)},_openConsentPopup:function(a,b){var d=window.open(a,"Google Domains Consent","status=0,width=1020,height=520");this._registerOpenWindow(b,d)}}))},"1.0",{requires:["base","promise","squarespace-promises"]});
YUI.add("squarespace-promises",function(a){function c(){}var b=a.namespace("Squarespace.Promises");b.all=function(){var b=new a.Array(arguments);return new a.Promise(function(c,f){var e=[],h=b.length,k=0,m=function(a){return function(b){k++;e[a]=b;k>=h&&c(e)}};a.Array.each(b,function(b,d){a.when(b).then(m(d),f)})})};b.resolve=function(a,b){return a.then(b)};b.reject=function(a,b){return a.then(c,b)};b.rejectWith=function(b){return a.Squarespace.Promises.create(function(a,c){c(b)})};b.finish=function(a,
b){return a.then(b,b)};b.chainFns=function(b,c){return function(){c=c||this;var f=0<b.length?b.shift().apply(c,arguments):a.when();return a.Array.reduce(b,f,function(b,d){return a.Squarespace.Promises.resolve(a.when(b),a.bind(d,c))})}};b.create=function(b,c){return new a.Promise(a.bind(b,c))}},"1.0",{requires:["promise"]});
YUI.add("squarespace-models-google-domain",function(a){var c=a.namespace("Squarespace.Models");c.GoogleDomain=a.Base.create("googleDomain",c.Domain,[],{root:a.Squarespace.REST_API_ROOT+"domains/google",isNew:function(){return a.Lang.isValue(this.get("googleAuthRequestId"))}},{ATTRS:{googleAuthRequestId:{validator:a.Squarespace.AttrValidators.isString}}})},"1.0",{requires:["base","squarespace-models-domain"]});
YUI.add("squarespace-models-domain",function(a){var c=a.Base.create("domain",a.Model,[a.Squarespace.ModelSync.REST],{url:a.Squarespace.REST_API_ROOT+"domains/{id}",root:a.Squarespace.REST_API_ROOT+"domains",getUnlockKey:function(){return new a.Promise(a.bind(function(b,d){a.Data.get({url:this.getURL("update")+"/unlock-key",success:function(a){b(a.key)},failure:d},this)},this))}},{ATTRS:{websiteId:{validator:a.Lang.isString},applicationSupplied:{value:!1,validator:a.Lang.isBoolean},dnsActive:{value:!1,
validator:a.Lang.isBoolean},googleDnsActive:{value:!1,validator:a.Lang.isBoolean},managed:{value:!1,validator:a.Lang.isBoolean},revokable:{value:!1,validator:a.Lang.isBoolean},withinPropagationWindow:{value:!1,validator:a.Lang.isBoolean},id:{validator:a.Lang.isString},name:{validator:a.Lang.isString},isVerified:{validator:a.Lang.isBoolean},verificationCode:{validator:a.Lang.isString}}});a.namespace("Squarespace.Models").Domain=c},"1.0",{requires:["base","model","promise","squarespace-model-sync-rest",
"squarespace-util"]});
YUI.add("squarespace-session-storage",function(a){a.namespace("Squarespace");var c=function(){return a.Lang.isValue(window.localStorage)};a.Squarespace.SessionStorage={saveSessionData:function(b,d,g){d={value:d};a.Lang.isDate(g)?d.expires=g.getTime():g=null;d=btoa(a.JSON.stringify(d));c()?window.localStorage.setItem(b,d):null===g?a.Cookie.set(b,d,{path:"/"}):a.Cookie.set(b,d,{path:"/",expires:g})},getSessionData:function(b){var d;d=c()?window.localStorage.getItem(b):a.Cookie.get(b);if(!a.Lang.isValue(d))return null;
d=a.JSON.parse(atob(d));return a.Lang.isNumber(d.expires)&&d.expires<(new Date).getTime()?(c()&&window.localStorage.removeItem(b),null):d.value},removeSessionData:function(b){c()&&window.localStorage.removeItem(b);a.Cookie.remove(b)}}},"1.0",{requires:["base","cookie"]});
YUI.add("squarespace-widgets-website-selector",function(a){a.namespace("Squarespace.Widgets");var c=a.Squarespace.Widgets.WebsiteSelector=a.Base.create("WebsiteSelector",a.Squarespace.Widgets.DialogField2,[],{initializer:function(){},renderUI:function(){c.superclass.renderUI.call(this);var b=this.get("title"),d=this.get("websites");d.isEmpty()&&(b=this.get("strings.noWebsitesError"));var g=this.get("contentBox");a.Lang.isString(b)&&g.append(a.Node.create('<div class="select-title">'+b+"</div>"));
b=a.Node.create('<div class="member-account"></div><div class="websites-wrapper"><div class="websites"></div></div>');g.append(b);(new a.Squarespace.Widgets.MemberAccount({model:this.get("memberAccount"),boundingBox:g.one(".member-account")})).render();var d=this._segmentWebsites(d),f=g.one(".websites");a.Array.each(d,function(b){if(0<b.websites.size()){var d=a.Node.create('<div class="website-sublist"></div>');f.append(d);b=new a.Squarespace.Widgets.WebsiteList({models:b.websites,boundingBox:d,"strings.title":b.name});
b.render(f);this.add(b)}},this);this._set("errorFlyoutAnchor",f)},bindUI:function(){c.superclass.bindUI.call(this);this.on("WebsiteList:selectedWebsiteChange",function(b){a.Lang.isValue(b.newVal)&&this.set("selectedWebsite",b.newVal)},this)},_segmentWebsites:function(b){var d=new a.Squarespace.Models.ModelList,c=new a.Squarespace.Models.ModelList,f=new a.Squarespace.Models.ModelList,e=new a.Squarespace.Models.ModelList;b.each(function(b){var k=b.get("siteStatus");switch(a.Lang.isNumber(k)?k:a.Object.getValue(k,
["value"])){case a.Squarespace.StatusConstants.PASTDUE:case a.Squarespace.StatusConstants.COMPED:case a.Squarespace.StatusConstants.ACTIVE:d.add(b);break;case a.Squarespace.StatusConstants.EXPIRED:c.add(b);break;case a.Squarespace.StatusConstants.TRIAL:f.add(b);break;case a.Squarespace.StatusConstants.INTERNAL:e.add(b)}b.get("faviconURL")||b.set("faviconURL",b.get("authenticUrl")+"/favicon.ico")});return[{name:"Internal",websites:e},{name:"Active",websites:d},{name:"Trial",websites:f},{name:"Expired",
websites:c}]},isEmpty:function(){return!this.get("selectedWebsite")}},{CSS_PREFIX:"sqs-website-selector",ATTRS:{strings:{value:{noWebsitesError:"You do not have any existing websites, is this the right account?"}},title:{validator:a.Squarespace.AttrValidators.isString,writeOnce:"initOnly"},memberAccount:{validator:a.Squarespace.AttrValidators.isInstanceOf(a.Squarespace.Models.MemberAccount),writeOnce:"initOnly"},websites:{validator:a.Squarespace.AttrValidators.isInstanceOf(a.Squarespace.Models.ModelList),
writeOnce:"initOnly"},selectedWebsite:{value:null,validator:a.Squarespace.AttrValidators.isNullOrInstanceOf(a.Model)},data:{getter:function(){return this.get("selectedWebsite")}},required:{value:!1,validator:a.Lang.isBoolean}}})},"1.0",{requires:"base model squarespace-widgets-website-list squarespace-widgets-member-account squarespace-widgets-model-list squarespace-models-member-account widget-parent".split(" ")});
YUI.add("squarespace-widgets-website-list",function(a){a.namespace("Squarespace.Widgets");var c=a.Squarespace.Widgets.WebsiteList=a.Base.create("WebsiteList",a.Squarespace.Widgets.ModelList,[a.WidgetChild],{syncUI:function(){c.superclass.syncUI.call(this);var b=this.get("strings.title");a.Lang.isString(b)&&this.get("contentBox").insert(a.Node.create('<div class="list-title">'+b+"</div>"),0)},bindUI:function(){this.after("selectionChange",function(b){b=b.newVal;a.Lang.isNull(b)?this.set("selectedWebsite",
null):this.set("selectedWebsite",b.get("model"))},this)}},{CSS_PREFIX:"sqs-website-list",ATTRS:{selectedWebsite:{value:null},defaultChildType:{value:a.Squarespace.Widgets.Website}}})},"1.0",{requires:["base","squarespace-widgets-website","squarespace-widgets-model-list","widget-child"]});
YUI.add("squarespace-widgets-website",function(a){a.namespace("Squarespace.Widgets");var c=a.Squarespace.Widgets.Website=a.Base.create("Website",a.Squarespace.Widgets.Model,[],{renderUI:function(){c.superclass.renderUI.call(this)},bindUI:function(){c.superclass.bindUI.call(this);this.get("boundingBox").on("click",function(){this.set("selected",1)},this)},_getHBTemplateContext:function(){var b=this.get("model").toJSON();a.Lang.isValue(b.authenticUrl)&&!a.Lang.isValue(b.url)&&(b.url=b.authenticUrl);
return b}},{CSS_PREFIX:"sqs-website",HANDLEBARS_TEMPLATE:"widgets-website.html"})},"1.0",{requires:["base","squarespace-util","squarespace-widgets-model","squarespace-widgets-website-template"]});
YUI.add("squarespace-widgets-model",function(a){a.namespace("Squarespace.Widgets");var c=a.Squarespace.Widgets.Model=a.Base.create("Model",a.Squarespace.Widgets.SSWidget,[a.WidgetChild],{bindUI:function(){c.superclass.bindUI.call(this);this._registerEvent(this.get("model").after("change",this.syncUI,this))},_getHBTemplateContext:function(){var a=c.superclass._getHBTemplateContext.call(this);a.model=a.model.toJSON();return a}},{CSS_PREFIX:"sqs-model",ATTRS:{model:{valueFn:function(){return new a.Model},
validator:a.Squarespace.AttrValidators.isInstanceOf(a.Model),writeOnce:"initOnly"}}})},"1.0",{requires:["base","model","widget-child","squarespace-attr-validators","squarespace-ss-widget"]});
YUI.add("squarespace-widgets-website-template",function(a){var c=a.Handlebars;(function(){var a=c.template;(c.templates=c.templates||{})["widgets-website.html"]=a(function(a,b,c,e,h){this.compilerInfo=[4,">= 1.0.0"];c=this.merge(c,a.helpers);h=h||{};e=this.escapeExpression;a='<div class="website" data-site-id="';(c=c.id)?c=c.call(b,{hash:{},data:h}):(c=b.id,c="function"===typeof c?c.apply(b):c);return a+=e(c)+'">\n\n  <div class="favicon"><img src="'+e((c=b.faviconURL,"function"===typeof c?c.apply(b):
c))+'" alt="'+e((c=b.siteTitle,"function"===typeof c?c.apply(b):c))+' favicon">\n  </div>\n\n  <div class="site-desc">\n    <span class="title">'+e((c=b.siteTitle,"function"===typeof c?c.apply(b):c))+'</span>\n    <span class="url">'+e((c=b.url,"function"===typeof c?c.apply(b):c))+"</span>\n  </div>\n\n</div>\n"})})();a.Handlebars.registerPartial("widgets-website.html".replace("/","."),c.templates["widgets-website.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-widgets-model-list",function(a){a.namespace("Squarespace.Widgets");var c=a.Squarespace.Widgets.ModelList=a.Base.create("ModelList",a.Squarespace.Widgets.SSWidget,[a.WidgetParent,a.Squarespace.Mixins.Loadable],{destructor:function(){this._loadingTimer&&this._loadingTimer.cancel()},bindUI:function(){c.superclass.bindUI.call(this);this._bindModels();this.after("modelsChange",function(){this._bindModels();this.syncUI()},this)},syncUI:function(){c.superclass.syncUI.call(this);this.get("loading")?
this._renderLoadingState():this._renderLoadedState()},_bindModels:function(){var a=this.get("models");this._registerEvent([a.after("add",function(d){1===a.size()&&this._empty();this._addWidgetForModel(d.model)},this),a.after("remove",function(d){this._removeWidgetForModel(d.model);a.isEmpty()&&this._renderEmptyState()},this),a.after("reset",this._renderLoadedState,this)])},_renderLoadingState:function(){this._loadingTimer&&this._loadingTimer.cancel();this._loadingTimer=a.later(500,this,function(){this._empty();
new a.Squarespace.Spinner({render:this.get("contentBox"),size:44,color:"dark"})})},_renderLoadedState:function(){this._loadingTimer&&this._loadingTimer.cancel();this._empty();var a=this.get("models");a.isEmpty()?this._renderEmptyState():a.each(this._addWidgetForModel,this)},_renderEmptyState:function(){var b=this.get("emptyStateIconSrc"),d=this.get("strings.modelName")+"s",c=a.Node.create('<div class="no-models"></div>');a.Lang.isValue(b)&&""!==b&&c.append('<img class="icon large" src="'+b+'" />');
c.append('<div class="no-models-text">'+this.getEmptyStateMessage(d)+"</div>");this.get("contentBox").append(c)},getEmptyStateMessage:function(a){return"There are no "+a+"."},_empty:function(){this.removeAll().each(function(a){a.destroy()});this._childrenContainer.empty()},_addWidgetForModel:function(a){var d=this.get("models").indexOf(a);this.add({model:a},d)},_removeWidgetForModel:function(a){var d;this.some(function(c){if(c.get("model")===a)return d=c,!0})&&d.destroy()}},{CSS_PREFIX:"sqs-model-list",
ATTRS:{models:{valueFn:function(){return new a.Squarespace.Models.ModelList},validator:a.Squarespace.AttrValidators.isInstanceOf(a.Squarespace.Models.ModelList)},emptyStateIconSrc:{value:null,validator:a.Squarespace.AttrValidators.isNullOrString,writeOnce:"initOnly"},loadable:{getter:function(){return this.get("models")},readOnly:!0},strings:{value:{modelName:"model"},validator:function(b){return!a.Lang.isObject(b)?(console.error('ModelList: Invalid "strings" attribute. Must be an object.'),!1):!a.Object.hasKey(b,
"modelName")?(console.error('ModelList: Invalid "strings" attribute. Must have key "modelName".'),!1):!0},writeOnce:"initOnly"},defaultChildType:{value:a.Squarespace.Widgets.Model,writeOnce:"initOnly"}}})},"1.0",{requires:"base event-custom squarespace-attr-validators squarespace-mixins-loadable squarespace-models-model-list squarespace-spinner squarespace-ss-widget squarespace-widgets-model widget-parent".split(" ")});
YUI.add("squarespace-mixins-loadable",function(a){a.namespace("Squarespace.Mixins");a.Squarespace.Mixins.Loadable=a.Base.create("Loadable",a.Base,[],{initializer:function(){var c=this.get("loadable"),b=this.get("loadOnInitialize");a.Lang.isValue(c)?(this._bindLoadable(),b&&c.load()):b&&console.error("Squarespace.Mixins.Loadable: You set loadOnInitialize to true, but the loadable was not defined in the initializer.");this.after("loadableChange",this._bindLoadable,this)},destructor:function(){this._beforeLoadHandler&&
this._beforeLoadHandler.detach();this._afterLoadHandler&&this._afterLoadHandler.detach();this._afterBindHandler&&this._afterBindHandler.detach()},_bindLoadable:function(){var c=this.get("loadable");this._beforeLoadHandler=a.Do.before(function(){this._set("loading",!0)},c,"load",this);this._afterLoadHandler=c.after("load",function(){this.get("destroyed")?console.log("I am destroyed"):this._set("loading",!1)},this);this._afterBindHandler=a.Do.after(function(){this.after("loadingChange",this.syncUI,
this)},this,"bindUI",this)}},{ATTRS:{loadable:{value:null},loading:{value:!1,validator:a.Squarespace.AttrValidators.isBoolean,readOnly:!0},loadOnInitialize:{value:!1,validator:a.Squarespace.AttrValidators.isBoolean,writeOnce:"initOnly"}}})},"1.0",{requires:["base","event-custom","squarespace-attr-validators"]});
YUI.add("squarespace-models-model-list",function(a){a.namespace("Squarespace.Models");var c=a.Squarespace.Models.ModelList=a.Base.create("ModelList",a.ModelList,[a.Squarespace.ModelSync.REST],{parse:function(b){b=c.superclass.parse.call(this,b);var d=this._getResponseAttrs(b);a.Object.each(d,function(a,b){this._set(b,a)},this);return b.results},_getResponseAttrs:function(a){return{}}})},"1.0",{requires:["base","model-list","squarespace-model-sync-rest"]});
YUI.add("squarespace-widgets-member-account",function(a){a.namespace("Squarespace.Widgets");var c=a.Squarespace.Widgets.MemberAccount=a.Base.create("MemberAccount",a.Squarespace.Widgets.Model,[],{renderUI:function(){c.superclass.renderUI.call(this)},syncUI:function(){c.superclass.syncUI.apply(this,arguments);var b=this.get("contentBox"),d=this.get("model"),b=b.one(".profile-image");a.Lang.isString(d.get("avatarId"))?b.setStyle("backgroundImage","url("+d.get("avatarAssetUrl")+")"):b.setStyle("backgroundImage",
null)},_getHBTemplateContext:function(){return this.get("model").toJSON()}},{CSS_PREFIX:"sqs-member-account",HANDLEBARS_TEMPLATE:"widgets-member-account.html",ATTRS:{model:{validator:a.Squarespace.AttrValidators.isInstanceOf(a.Squarespace.Models.MemberAccount)}}})},"1.0",{requires:["base","squarespace-util","squarespace-widgets-model","squarespace-widgets-member-account-template","squarespace-models-member-account"]});
YUI.add("squarespace-widgets-member-account-template",function(a){var c=a.Handlebars;(function(){var a=c.template;(c.templates=c.templates||{})["widgets-member-account.html"]=a(function(a,b,c,e,h){this.compilerInfo=[4,">= 1.0.0"];c=this.merge(c,a.helpers);h=h||{};var k=this.escapeExpression;a='  <div class="profile-image"></div>\n\n  <div class="profile-info">\n    <span class="name">';(e=c.displayName)?e=e.call(b,{hash:{},data:h}):(e=b.displayName,e="function"===typeof e?e.apply(b):e);a+=k(e)+'</span>\n    <span class="email">';
(e=c.email)?e=e.call(b,{hash:{},data:h}):(e=b.email,e="function"===typeof e?e.apply(b):e);return a+=k(e)+"</span>\n  </div>\n"})})();a.Handlebars.registerPartial("widgets-member-account.html".replace("/","."),c.templates["widgets-member-account.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-widgets-login",function(a){var c=a.Squarespace.ExternalServiceProviders,b={};b[c.FACEBOOK]="Facebook";b[c.TWITTER]="Twitter";b[c.GOOGLEAUTH2]="Google";var d={email:{ctor:a.Squarespace.DialogFields.Text,config:{name:"email",submitOnEnter:!0,className:"large",strings:{placeholder:"Email Address"}}},password:{ctor:a.Squarespace.DialogFields.Text,config:{name:"password",submitOnEnter:!0,className:"large",strings:{placeholder:"Password"},password:!0}},verificationCode:{ctor:a.Squarespace.DialogFields.Text,
config:{name:"verification-code",submitOnEnter:!0,className:"large",strings:{placeholder:"Verification Code"}}},"stay-logged-in":{ctor:a.Squarespace.DialogFields.Check,config:{name:"stay-logged-in","strings.title":"Stay Logged In",data:!0}},displayName:{ctor:a.Squarespace.DialogFields.Text,config:{name:"displayName",required:!0,submitOnEnter:!0,className:"large",strings:{placeholder:"Your Name"}}},anonEmail:{ctor:a.Squarespace.DialogFields.Email,config:{name:"anonEmail",required:!1,submitOnEnter:!0,
mailcheck:!0,className:"large",strings:{placeholder:"Email (Optional)"}}},authorUrl:{ctor:a.Squarespace.DialogFields.Text,config:{name:"authorUrl",required:!1,submitOnEnter:!0,className:"large",strings:{placeholder:"Website URL (Optional)"}}}};a.namespace("Squarespace.Widgets");var g=a.Squarespace.Widgets.Login=a.Base.create("login",a.Squarespace.SSWidget,[],{delegatedEvents:{'[data-action="submit"]':{click:"_onSubmit"},'[data-action="cancel"]':{click:"_onCancel"},".tabs:not(.single-tab) .tab-item":{click:"_onTabClick"},
".social-login-button":{click:"_onSubmit"},".login-with-google":{click:"_activateGoogleLogin"},'[data-action="login-with-squarespace"]':{click:"_activateSquarespaceLogin"},".password-recovery":{click:"_onPasswordRecoveryClick"},".create-account":{click:"_onCreateAccountClick"},".two-factor-auth-explain":{click:"_onTwoFactorAuthExplain"}},initializer:function(){console.log("Login widget initializer");this._initializeFields();this.externalAuth=new a.Squarespace.ExternalAuthentication({includeWebsiteList:!0});
this.publish("loginSuccess",{emitFacade:!0});this.publish("cancel",{emitFacade:!1})},_initializeFields:function(){var b=[];a.Object.each(d,function(d,c){var e=new d.ctor(a.merge(d.config));b.push(e)},this);var c=a.Array.find(b,function(a){return"email"===a.get("name")});c&&c.setAttrs({disabled:this.get("disableEmailChange"),data:this.get("email")});this._fields=b},renderUI:function(){g.superclass.renderUI.call(this);var b=this.get("contentBox");a.Squarespace.FormUtils.template(b,this._fields);(new a.Squarespace.Spinner({color:"dark",
size:"large",render:b.one(".loading-spinner")})).spin();this._focusInput();console.log("Login widget rendered")},bindUI:function(){g.superclass.bindUI.call(this);this.after("waitingChange",this.syncUI,this);this.after("activeLoginMethodChange",this._switchTab,this);a.Array.each(this._fields,function(a){if("text"===a.getType())a.on("submit",this._onSubmit,this)},this);this.on("waitingChange",function(b){a.Array.each(this._fields,function(a){a.set("readOnly",b.newVal)})},this)},syncUI:function(){g.superclass.syncUI.call(this);
var a=this.get("contentBox");this.get("contentBox").one(".wait-overlay").toggleClass("hidden",!this.get("waiting"));if(a=a.one(".tabs")){a.toggleClass("single-tabs",1===this.get("tabsEnabled"));a.all(".tab-item.active").removeClass("active");var b=this.get("activeLoginMethod");(a=a.one('.tab-item[data-login-method="'+b+'"]'))&&a.addClass("active")}},_focusInput:function(){var b="email";this.get("disableEmailChange")&&(b="password");a.Array.find(this._fields,function(a){return a.get("name")===b}).focus()},
_activateSquarespaceLogin:function(){this.set("activeLoginMethod","squarespace")},_activateGoogleLogin:function(){this.set("activeLoginMethod","google")},_onPasswordRecoveryClick:function(b){a.Squarespace.FormUtils.hideErrors(this._fields);this.hide();b=a.Squarespace.FormUtils.getData(this._fields);(new a.Squarespace.Widgets.PasswordRecovery({render:!0,email:b.email})).on("destroy",this.show,this)},_onTwoFactorAuthExplain:function(b){a.Squarespace.FormUtils.hideErrors(this._fields)},_onCancel:function(a){this.fire("cancel");
this.destroy()},_onCreateAccountClick:function(b){var d;b=a.Squarespace.FormUtils.getData(this._fields).email;this.hide();d=new a.Squarespace.Widgets.CreateAccount({render:!0,email:b});d.once("cancel",function(){d.destroy();this.show()},this);d.after("memberAccountChange",function(){var b=d.get("memberAccount"),c=d.get("password");a.Lang.isValue(b)&&(a.Squarespace.FormUtils.setData(this._fields,{email:b.get("email"),password:c}),d.destroy(),this._loginSquarespace().then(a.bind(this._handleLoginSuccess,
this),a.bind(this._handleLoginFailure,this)))},this)},_getHBTemplateContext:function(){var a=g.superclass._getHBTemplateContext.call(this);a.selectMode="thin";1==a.tabsEnabled.length?a.selectMode="single":3>a.tabsEnabled.length&&(a.selectMode="wide");0===a.tabsEnabled.length&&(a.hideTab=!0);return a},_onTabClick:function(a){a=a.target.ancestor(".tab-item",!0).getAttribute("data-login-method");this.set("activeLoginMethod",a)},_switchTab:function(b){var d=this.get("contentBox").all(".body,.footer");
d.removeClass(b.prevVal);d.addClass(b.newVal);this.syncUI();a.Squarespace.FormUtils.hideErrors(this._fields)},_onSubmit:function(){this.set("waiting",!0);var b=this.get("activeLoginMethod");a.Squarespace.FormUtils.hideErrors(this._fields);switch(b){case "squarespace":b=this._loginSquarespace();break;case "guest":b=this._loginGuest();break;case "google":b=this._loginOauth(a.Squarespace.ExternalServiceProviders.GOOGLEAUTH2);break;case "facebook":b=this._loginOauth(a.Squarespace.ExternalServiceProviders.FACEBOOK);
break;case "twitter":b=this._loginOauth(a.Squarespace.ExternalServiceProviders.TWITTER);break;case "two-factor":b=this._loginTwoFactor();break;default:console.error("unknown method: "+b);return}b.then(a.bind(this._handleLoginSuccess,this),a.bind(this._handleLoginFailure,this))},_loginSquarespace:function(){var b=a.Squarespace.FormUtils.getData(this._fields),d=b.email,c=b.password,g=b["stay-logged-in"],m=""+this.get("returnWebsiteList"),s=this.get("targetIdentifier");return new a.Squarespace.Promises.create(function(b,
f){a.Data.post({url:"/api/auth/Login",secure:!0,data:{email:d,password:c,includeWebsiteList:m,remember:g,targetIdentifier:s},success:function(a){b({type:"v6",websites:a.websites,account:a.account,website:a.targetWebsite})},failure:f},this)},this)},_loginGuest:function(){var b=a.Squarespace.FormUtils.getData(this._fields),d=b.displayName,c=b.anonEmail,g=b.authorUrl;return new a.Promise(function(b,f){(!a.Lang.isString(d)||1>d.length)&&f({errors:{displayName:"Need to specify display name"}});b({type:"guest",
displayName:d,email:c,authorUrl:g})})},_loginOauth:function(d){var c=this.get("returnWebsiteList"),g=this.get("targetIdentifier");return new a.Promise(function(k,m){var s=new a.Squarespace.ExternalAuthentication({includeWebsiteList:c,useLoginFlag:!0,targetIdentifier:g});s.on("completed",function(c){c=s.get("websites");var g=s.get("memberAccount"),e=s.get("website");a.Lang.isObject(g)?k({websites:c,account:g,website:e}):m({type:"oauth",error:"Authentication failed with "+b[d]+", please try again."})},
this);s.openPopupWindow(d)})},_loginTwoFactor:function(){var b=a.Squarespace.FormUtils.getData(this._fields),d=b.email,c=b["verification-code"];return a.Squarespace.Promises.create(function(b,f){a.Data.post({url:"/api/auth/two-factor",secure:!0,data:{email:d,code:c},success:b,failure:f},this)},this).then(a.bind(this._loginSquarespace,this))},_handleLoginSuccess:function(a){this.set("waiting",!1);this.fire("loginSuccess",a)},_handleLoginFailure:function(b){this.set("waiting",!1);b.twoFactorAuthRequired&&
this._handleTwoFactorAuthRequired();a.Lang.isObject(b.errors)?("Please log in again."===b.errors.password&&this._returnToSquarespaceLogin(),a.Squarespace.FormUtils.showErrors(this._fields,b.errors)):a.Lang.isString(b.error)&&new a.Squarespace.Widgets.Alert({position:a.Squarespace.Widgets.Confirmation.ANCHOR.CENTER,"strings.title":"Login Failed","strings.message":b.error})},_handleTwoFactorAuthRequired:function(){this._setVerificationCodeVisible(!0);var b=this._getField(this._fields,"verification-code");
a.later(250,b,b.focus);this._getField(this._fields,"password").disable();this._getField(this._fields,"email").disable();this.set("activeLoginMethod","two-factor")},_returnToSquarespaceLogin:function(){this._setVerificationCodeVisible(!1);this._getField(this._fields,"verification-code").set("data","");var a=this._getField(this._fields,"password");a.set("data","");a.enable();a.focus();this._getField(this._fields,"email").enable();this.set("activeLoginMethod","squarespace")},_setVerificationCodeVisible:function(a){this.get("contentBox").one(".verification-code-field-wrapper").toggleClass("hidden",
!a)},_getField:function(b,d){return a.Array.find(b,function(a){return a.get("name")===d})}},{CSS_PREFIX:"sqs-widgets-login",HANDLEBARS_TEMPLATE:"widgets-login.html",ATTRS:{activeLoginMethod:{value:"squarespace",validator:a.Squarespace.AttrValidators.isValueIn("squarespace google twitter facebook guest two-factor".split(" "))},tabsEnabled:{value:["squarespace"],validator:a.Squarespace.AttrValidators.isArray,writeOnce:"initOnly"},enableGoogleLoginLink:{value:!1,writeOnce:"initOnly"},returnWebsiteList:{value:!1,
validator:a.Squarespace.AttrValidators.isBoolean,writeOnce:"initOnly"},targetIdentifier:{value:null,validator:a.Squarespace.AttrValidators.isNullOrString,writeOnce:"initOnly"},canCancel:{value:!1,validator:a.Squarespace.AttrValidators.isBoolean,writeOnce:"initOnly"},email:{value:null,validator:a.Squarespace.AttrValidators.isNullOrString,writeOnce:"initOnly"},disableEmailChange:{value:!1,validator:a.Squarespace.AttrValidators.isBoolean},canCreateAccount:{value:!1,validator:a.Squarespace.AttrValidators.isBoolean,
writeOnce:"initOnly"},useLoginFlag:{value:!1,validator:a.Squarespace.AttrValidators.isBoolean,writeOnce:"initOnly"},title:{value:null,validator:a.Squarespace.AttrValidators.isNullOrString,writeOnce:"initOnly"},waiting:{value:!1,validator:a.Squarespace.AttrValidators.isBoolean},strings:{value:{loginButonTitle:"Login"}}}})},"1.0",{requires:"base squarespace-dialog-check squarespace-dialog-text squarespace-external-authentication squarespace-form-utils squarespace-promises squarespace-ss-widget squarespace-widgets-create-account squarespace-widgets-login-template squarespace-widgets-password-recovery".split(" ")});
YUI.add("squarespace-dialog-text",function(a){var c=a.namespace("Squarespace.DialogFields").Text=a.Base.create("text",a.Squarespace.DialogField2,[],{destructor:function(){this._textField&&this._textField.remove(!0);this._textField=null},renderUI:function(){c.superclass.renderUI.call(this);var a=this.get("name"),b=this.get("autocompleteType");this._textField=this.get("contentBox").one("input[type]");this.get("dialog")&&this._textField.setAttribute("tabindex",this.get("dialog").getNextTabIndex());this._textField.set("type",
this.get("password")?"password":"text");a&&this._textField.setAttribute("name",a);b&&this._textField.setAttribute("x-autocompletetype",b);this.get("autocompleteEnabled")||(this.get("contentBox").prepend('<input type="password" class="sqs-offscreen" />'),this._textField.setAttribute("autocomplete","off"));this._set("errorFlyoutAnchor",this._textField);this._textField.set("value",this.get("data"))},bindUI:function(){c.superclass.bindUI.call(this);this.get("id");this.after("dataChange",this._afterDataChange,
this);this._textField.after("valuechange",this._afterValueChange,this);var b=this._textField.getDOMNode(),d="addEventListener";a.Lang.isFunction(b.attachEvent)&&(d="attachEvent");b[d]("focus",a.bind(this._afterFocus,this));b[d]("blur",a.bind(this._afterBlur,this));this._textField.on("click",function(a){a.halt()});this._textField.after("keyup",function(a){13===a.keyCode&&this.get("submitOnEnter")&&(this.fire("submit"),(a=this.get("dialog"))&&a.saveAndClose())},this);this._textField.on("keypress",this.applyKeyFilter,
this);!0===this.get("mailcheck")&&this._textField.plug(a.Squarespace.Plugin.MailCheck,{field:this});this.on("readOnlyChange",function(a){a.newVal?this._textField.setAttribute("readonly","readonly"):this._textField.removeAttribute("readonly")},this)},syncUI:function(){c.superclass.syncUI.call(this);var a=this.get("strings.placeholder");a&&this._textField.setAttribute("placeholder",a);this.get("disabled")?this._textField.setAttribute("disabled","disabled"):this._textField.removeAttribute("disabled")},
getErrors:function(){var a=this.get("data");return this.get("validator")(a)?this.get("required")&&this.isEmpty()?[this.get("strings.requiredFieldEmptyMessage")]:[]:[this.get("strings.validationFailMessage")]},isEmpty:function(){return""===this.get("data")},focus:function(){c.superclass.focus.call(this);this.get("rendered")&&this._textField.focus()},select:function(){this.get("rendered")&&this._textField.select()},blur:function(){c.superclass.blur.call(this);this.get("rendered")&&this._textField&&
this._textField.blur()},disable:function(){c.superclass.disable.call(this);this.get("rendered")&&this._textField.setAttribute("disabled","disabled")},enable:function(){c.superclass.enable.call(this);this.get("rendered")&&this._textField.removeAttribute("disabled")},applyKeyFilter:function(b){var d=this.get("keyFilter"),c=this.get("keyFilterExplanation"),g;if(d&&(0===a.UA.gecko||b._event.isChar))g=String.fromCharCode(b.which),!g.match(RegExp(d))&&0<g.length&&(c&&this.showError(c),b.halt())},_afterDataChange:function(a){a.dataSync||
this._textField.set("value",a.newVal||"",{dataSync:!0});this.hideError()},_afterValueChange:function(a){a.dataSync||this.set("data",a.newVal,{dataSync:!0})},_afterFocus:function(){"undefined"!==typeof CONFIG_PANEL&&CONFIG_PANEL.set("allowContextMenu",!0);a.UA.ie||this.focus()},_afterBlur:function(){"undefined"!==typeof CONFIG_PANEL&&CONFIG_PANEL.set("allowContextMenu",!1);this._textField&&this.set("data",this._textField.get("value"),{dataSync:!0});this.blur()}},{CSS_PREFIX:"sqs-text",HANDLEBARS_TEMPLATE:"dialog-text.html",
ATTRS:{strings:{value:{placeholder:"",validationFailMessage:"This must be a string.",requiredFieldEmptyMessage:"This is a required field."}},data:{value:"",setter:function(b){a.Lang.isValue(b)||(b="");return b},validator:function(b){return a.Lang.isString(b)||!a.Lang.isValue(b)}},validator:{value:a.Lang.isString},password:{value:!1,validator:a.Lang.isBoolean},submitOnEnter:{value:!1,validator:a.Lang.isBoolean},disabled:{value:!1,validator:a.Lang.isBoolean},autocompleteType:a.Squarespace.AutocompleteTypeATTR,
autocompleteEnabled:{value:!0,validator:a.Lang.isBoolean,writeOnce:"initOnly"},mailcheck:{value:!1,validator:a.Lang.isBoolean},keyFilter:{},keyFilterExplanation:{value:""},maxLength:{value:null},readOnly:{value:!1},selectAllOnFocus:{value:!1}}});a.Squarespace.DialogFields.LabeledText=a.Base.create("labeledText",a.Squarespace.DialogFields.Text,[a.Squarespace.DialogFields.DialogFieldLabel],{},{CSS_PREFIX:"sqs-labeled-text",LABEL_CONFIG:{forNode:"input[type]"}});var b=a.Squarespace.DialogFields.MoneyText=
a.Base.create("moneyText",a.Squarespace.DialogFields.Text,[],{renderUI:function(){b.superclass.renderUI.call(this);this.get("contentBox").one("input").plug(a.Squarespace.Plugin.MoneyFormatter)},bindUI:function(){var a=this.get("contentBox").one("input");a.on("valuechange",function(){this.set("data",a.moneyFormatterPlugin.get("data"))},this)}},{CSS_PREFIX:"sqs-money-text",LABEL_CONFIG:{forNode:"input[type]"},ATTRS:{data:{value:0,validator:a.Lang.isNumber},validator:{value:a.Lang.isNumber},prefixUnit:{valueFn:function(){return a.Squarespace.Commerce.currencySymbol()}}}}),
d=a.Squarespace.DialogFields.Email=a.Base.create("emailText",a.Squarespace.DialogFields.Text,[],{renderUI:function(){d.superclass.renderUI.call(this);this.get("contentBox").one("input").setAttribute("type","email")}},{CSS_PREFIX:"sqs-email-text",ATTRS:{mailcheck:{value:!0}}}),g=a.Squarespace.DialogFields.Url=a.Base.create("urlText",a.Squarespace.DialogFields.Text,[],{renderUI:function(){g.superclass.renderUI.call(this);this._textField.wrap('<div class="sqs-input-wrapper-content"></div>');var a=this.get("contentBox").one(".sqs-input-wrapper-content");
a.wrap('<div class="sqs-input-wrapper"></div>');a.prepend('<div class="prefix">'+this.get("prefix")+"</div>")},bindUI:function(){g.superclass.bindUI.call(this);this._textField.after("keyup",this.onKeyUp,this)},onKeyUp:function(b){var d=this.get("filter"),c;if("url-slug"===d||"url-slug-with-slash"==d)c=this._textField.get("value"),d="url-slug"===d?a.Squarespace.Utils.createUrl(c):a.Squarespace.Utils.createUrlWithSlash(c),b=this._textField.selectionStart-(32==b.keyCode?0:1),c!=d&&(this._textField.set("value",
d),this._textField.selectionStart=b,this._textField.selectionEnd=b)}},{CSS_PREFIX:"sqs-url-text",ATTRS:{filter:{value:"url-slug-with-slash"},prefix:{value:"/"}}})},"1.0",{requires:"base base-build event-valuechange squarespace-dialog-field-2 squarespace-autocomplete-types squarespace-dialog-text-template squarespace-dialog-label squarespace-mailcheck squarespace-attr-validators".split(" ")});
YUI.add("squarespace-autocomplete-types",function(a){a.namespace("Squarespace.Constants").AutocompleteTypes={GIVEN_NAME:"given-name",FAMILY_NAME:"family-name",CITY:"city",STATE:"state",POSTAL_CODE:"postal-code",COUNTRY_NAME:"country-name",CC_FULL_NAME:"cc-full-name",CC_NUMBER:"cc-number",CC_EXP_MOTNH:"cc-exp-month",CC_EXP_YEAR:"cc-exp-year",CC_CSC:"cc-csc"};a.Squarespace.AutocompleteTypeATTR={value:null,writeOnce:"initOnly",validator:function(c){if(a.Lang.isNull(c)||a.Object.hasValue(a.Squarespace.Constants.AutocompleteTypes,
c))return!0;console.warn(this.name+": That constant is not an available autocomplete type.");return!1}}},"1.0");
YUI.add("squarespace-dialog-text-template",function(a){var c=a.Handlebars;(function(){var a=c.template;(c.templates=c.templates||{})["dialog-text.html"]=a(function(a,b,c,e,h){this.compilerInfo=[4,">= 1.0.0"];c=this.merge(c,a.helpers);h=h||{};a="";var k,m=this.escapeExpression;if((e=c["if"].call(b,(k=b.strings,null==k||!1===k?k:k.title),{hash:{},inverse:this.noop,fn:this.program(1,function(a,b){var d,c;return d=""+('\n  <div class="title">'+m((c=(c=a.strings,null==c||!1===c?c:c.title),"function"===
typeof c?c.apply(a):c))+"</div>\n")},h),data:h}))||0===e)a+=e;a+='\n\n<input type="text" ';if((e=c["if"].call(b,b.maxLength,{hash:{},inverse:this.noop,fn:this.program(3,function(a,b){var d,g;d='maxlength="';(g=c.maxLength)?g=g.call(a,{hash:{},data:b}):(g=a.maxLength,g="function"===typeof g?g.apply(a):g);return d+=m(g)+'"'},h),data:h}))||0===e)a+=e;a+="\n       ";if((e=c["if"].call(b,b.readOnly,{hash:{},inverse:this.noop,fn:this.program(5,function(a,b){return'readonly="readonly"'},h),data:h}))||0===
e)a+=e;a+="\n       ";if((e=c["if"].call(b,b.selectAllOnFocus,{hash:{},inverse:this.noop,fn:this.program(7,function(a,b){return'onClick="this.select()"'},h),data:h}))||0===e)a+=e;a+="/>\n\n";if((e=c["if"].call(b,(k=b.strings,null==k||!1===k?k:k.description),{hash:{},inverse:this.noop,fn:this.program(9,function(a,b){var d,c,f;d='\n\n\t<div class="description">\n    ';if((f=(c=(c=a.strings,null==c||!1===c?c:c.description),"function"===typeof c?c.apply(a):c))||0===f)d+=f;return d+"\n  </div>\n\n"},h),
data:h}))||0===e)a+=e;return a+"\n"})})();a.Handlebars.registerPartial("dialog-text.html".replace("/","."),c.templates["dialog-text.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-dialog-label",function(a){a.namespace("Squarespace.Plugin").DialogFieldLabel=a.Base.create("dialogFieldLabel",a.Plugin.Base,[],{initializer:function(a){this.afterHostMethod("renderUI",this._render,this);this.afterHostMethod("syncUI",this.syncLabel,this)},destructor:function(){a.detach(this.get("id")+"|*");var c=this.get("host"),b=c.get("boundingBox");c.get("rendered")&&(b&&b._node)&&c.get("boundingBox").removeClass(a.Squarespace.Plugin.DialogFieldLabel.CSS_PREFIX+"-plugged")},
_render:function(){this.renderLabel();this.bindLabel();this.syncLabel();this.get("host").get("boundingBox").addClass(a.Squarespace.Plugin.DialogFieldLabel.CSS_PREFIX+"-plugged")},renderLabel:function(){this._labelNode=a.Node.create("<label></label>");this._labelNode.addClass(a.Squarespace.Plugin.DialogFieldLabel.CSS_PREFIX);var c=this._labelNode;this.get("inField");var b=this.get("renderNode");this.get("strings.text");var d=this.get("className"),g=this.get("forNode"),f=this.get("host").get("contentBox");
d&&c.addClass(d);b?(a.Lang.isString(b)&&(b=f.one(b)),b.appendChild(c)):g?(a.Lang.isString(g)&&(g=f.one(g)),(b=g.getAttribute("id"))&&c.setAttribute("for",b),g.insert(c,"before")):(f.one("input")||f.one("select")||f.one("textarea")||f.one("button")).insert(c,"before")},bindLabel:function(){var a=this.get("id");this.on(a+"|classNameChange",function(a){this._labelNode.removeClass(a.prevVal);this._labelNode.addClass(a.newVal)},this)},syncLabel:function(){this._labelNode.setContent(this.get("strings.text"))}},
{NS:"label",CSS_PREFIX:"sqs-dialog-field-label",ATTRS:{strings:{value:{text:""}},renderNode:{value:null},className:{value:null},forNode:{value:null}}});a.namespace("Squarespace.DialogFields").DialogFieldLabel=function(c){a.Do.before(function(){this.plug(a.Squarespace.Plugin.DialogFieldLabel,a.merge({renderNode:c.labelRenderNode||null,forNode:c.labelForNode||null,className:c.labelClassName||null,"strings.text":this.get("strings.label")},c.labelConfig||{},this.getProperty("LABEL_CONFIG")||{}))},this,
"renderUI",this)};a.Squarespace.DialogFields.DialogFieldLabel.NAME="dialogFieldLabel"},"1.0",{requires:["base","node","plugin","squarespace-dialog-field-2"]});
YUI.add("squarespace-form-utils",function(a){var c=a.namespace("Squarespace.FormUtils");c.setData=function(b,d){a.Lang.isValue(d)&&a.Array.each(b,function(b){var c=d[b.get("name")];a.Lang.isUndefined(c)||b.set("data",c)})};c.getData=function(b){b=b||[];return a.Array.reduce(b,{},function(b,c){var f=c.get("data");!a.Lang.isUndefined(f)&&a.Lang.isValue(c.get("name"))&&(b[c.get("name")]=f);return b})};c.template=function(b,d){a.Lang.isArray(d)?a.Array.each(d,function(a){var d=a.get("name"),c=b.one('[data-field-name="'+
d+'"]');c?a.render(c):console.warn('No target node found for widget "'+d+'".')}):a.Lang.isObject(d)&&a.Object.each(d.groups||{},function(d,c){var e=b.one('[data-field-group="'+c+'"]');e&&a.Array.each(d,function(a){a.render(e)})})};c.validate=function(b){return a.Array.reduce(b,{},function(b,c){if(a.Lang.isFunction(c.getErrors)){var f=c.getErrors();f.length&&(b[c.get("name")]=f[0])}return b})};c.showErrors=function(b,d){a.Array.each(b,function(b){var c=d[b.get("name")];a.Lang.isValue(c)&&""!==c&&a.Lang.isFunction(b.showError)&&
b.showError(c)})};c.hideErrors=function(b){a.Array.each(b,function(b){a.Lang.isFunction(b.hideError)&&b.hideError()})}},"1.0",{requires:["node","array-extras"]});
YUI.add("squarespace-widgets-create-account",function(a){var c={firstName:{ctor:a.Squarespace.DialogFields.Text,config:{name:"firstName",submitOnEnter:!0,className:"large",strings:{placeholder:"First Name"}}},lastName:{ctor:a.Squarespace.DialogFields.Text,config:{name:"lastName",submitOnEnter:!0,className:"large",strings:{placeholder:"Last Name"}}},email:{ctor:a.Squarespace.DialogFields.Text,config:{name:"email",submitOnEnter:!0,className:"large",strings:{placeholder:"Email Address"}}},password:{ctor:a.Squarespace.DialogFields.Password,
name:"password",config:{required:!0,name:"password",className:"large","strings.placeholder":"Password",submitOnEnter:!0,strengthMeterVisible:!0}}};a.namespace("Squarespace.Widgets");var b=a.Squarespace.Widgets.CreateAccount=a.Base.create("create-account",a.Squarespace.SSWidget,[],{delegatedEvents:{'[data-action="submit"]':{click:"_onSubmit"},'[data-action="cancel"]':{click:"_onCancel"}},initializer:function(a){this._initializeFields();this.publish("cancel",{emitFacade:!1})},_initializeFields:function(){var b=
[];a.Object.each(c,function(c,f){c.config.errorFlyoutRenderTarget=this.get("boundingBox");var e=new c.ctor(a.merge(c.config));b.push(e)},this);a.Squarespace.FormUtils.setData(b,{email:this.get("email")});this._fields=b},renderUI:function(){b.superclass.renderUI.call(this);var d=this.get("contentBox");a.Squarespace.FormUtils.template(d,this._fields);(new a.Squarespace.Spinner({color:"dark",size:"large",render:d.one(".loading-spinner")})).spin();this._focusInput()},bindUI:function(){b.superclass.bindUI.call(this);
this.after("waitingChange",this.syncUI,this);a.Array.each(this._fields,function(a){if("text"===a.getType())a.on("submit",this._onSubmit,this)},this)},syncUI:function(){b.superclass.syncUI.call(this);this.get("contentBox").one(".wait-overlay").toggleClass("hidden",!this.get("waiting"))},_focusInput:function(){a.Array.find(this._fields,function(a){return"firstName"===a.get("name")}).focus()},_onCancel:function(a){this.fire("cancel")},_onSubmit:function(){this.set("waiting",!0);var b=a.Squarespace.FormUtils.getData(this._fields);
a.Data.post({data:b,secure:!0,url:"/api/auth/CreateSquarespaceAccount",success:function(c){this.set("password",b.password);this.set("memberAccount",new a.Squarespace.Models.MemberAccount(c.memberAccount))},failure:function(b){this.set("waiting",!1);a.Squarespace.FormUtils.showErrors(this._fields,b.errors)}},this)}},{CSS_PREFIX:"sqs-widgets-create-account",HANDLEBARS_TEMPLATE:"widgets-create-account.html",ATTRS:{memberAccount:{value:null,validator:a.Squarespace.AttrValidators.isNullOrInstanceOf(a.Squarespace.Models.MemberAccount)},
password:{value:null,validator:a.Squarespace.AttrValidators.isNullOrString},email:{value:null,validator:a.Squarespace.AttrValidators.isNullOrString,writeOnce:"initOnly"},waiting:{value:!1,validator:a.Squarespace.AttrValidators.isBoolean},strings:{value:{description:"Below you can sign up for a Squarespace account. Squarespace accounts let you keep a profile for editing and commenting on Squarespace websites."}}}})},"1.0",{requires:"base squarespace-ss-widget squarespace-dialog-text squarespace-widgets-create-account-template squarespace-form-utils squarespace-attr-validators squarespace-dialog-password squarespace-models-member-account".split(" ")});
YUI.add("squarespace-widgets-create-account-template",function(a){var c=a.Handlebars;(function(){var a=c.template;(c.templates=c.templates||{})["widgets-create-account.html"]=a(function(a,b,c,e,h){this.compilerInfo=[4,">= 1.0.0"];c=this.merge(c,a.helpers);h=h||{};e=this.escapeExpression;a='<div class="wait-overlay ';if((c=c.unless.call(b,b.waiting,{hash:{},inverse:this.noop,fn:this.program(1,function(a,b){return"hidden"},h),data:h}))||0===c)a+=c;return a+='">\n\t<div class="loading-spinner"></div>\n</div>\n<div class="title-block">\n\t<div class="title-text">Create Squarespace Account</div>\n</div>\n\n<div class="body-block">\n\t<div class="description">'+
e((c=(c=b.strings,null==c||!1===c?c:c.description),"function"===typeof c?c.apply(b):c))+'</div>\n\t<div class="name">\n\t\t<div class="display-first-name-field-wrapper" data-field-name="firstName"></div>\n\t\t<div class="display-last-name-field-wrapper" data-field-name="lastName"></div>\n\t</div>\n\t<div class="display-email-field-wrapper" data-field-name="email"></div>\n\t<div class="display-password-field-wrapper" data-field-name="password"></div>\n</div>\n\n<div class="controls-block">\n\t<div class="button-holder">\n\t\t<div class="button-block">\n\t\t\t<input class="saveAndClose" type="button" data-action="submit" value="Create Account">\n\t\t</div>\n\t\t<div class="cancel-block"><a class="cancel" href="javascript:noop();" data-action="cancel">Cancel</a></div>\n\t</div>\n</div>'})})();
a.Handlebars.registerPartial("widgets-create-account.html".replace("/","."),c.templates["widgets-create-account.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-dialog-password",function(a){a.namespace("Squarespace.DialogFields");var c=a.Squarespace.DialogFields.Password=a.Base.create("Password",a.Squarespace.DialogFields.Text,[],{initializer:function(){this.publish("forgot-password",{emitFacade:!0});this.get("strengthMeterVisible")&&typeof zxcvbn!==typeof Function&&a.Get.js("https://static."+Static.SQUARESPACE_CONTEXT.appDomain+"/universal/scripts-thirdparty/zxcvbn/zxcvbn-min.js",function(a){a?console.error("[Password strength] Error loading zxcvbn."):
console.log("[Password strength] Loaded zxcvbn.")})},renderUI:function(){c.superclass.renderUI.call(this);var b=this.get("contentBox");this.get("strengthMeterVisible")&&(this._strengthMeter=b.plug(a.Squarespace.Plugin.ProgressBar,{show:!0,append:!0})[a.Squarespace.Plugin.ProgressBar.NS]);this._forgotNode=b.appendChild(this.getProperty("FORGOT_PASSWORD_TEMPLATE"))},bindUI:function(){c.superclass.bindUI.call(this);this._forgotNode.on("click",function(a){a.halt();this.fire("forgot-password")},this);
this.get("strengthMeterVisible")&&this.after("dataChange",this._updateStrengthMeter,this)},syncUI:function(){c.superclass.syncUI.call(this);var b=this.get("boundingBox");b.toggleClass("has-title",a.Lang.isValue(this.get("strings.title")));b.toggleClass("forgot-visible",this.get("forgotVisible")&&""===this.get("data").trim())},_updateStrengthMeter:function(){if(typeof zxcvbn===typeof Function){var a=zxcvbn(this.get("data")),a=100*((Math.log(a.crack_time)+7)/30);0>=a&&!this.get("data")?a=0:100<a?a=
100:5>a&&this.get("data")&&(a=5);var d=this._strengthMeter._meterEl.one(".bar-inner");33>a?d.setStyle("background","hsl(5, 65%, 57%)"):33<=a&&67>a?d.setStyle("background","hsl(36, 80%, 57%)"):67<=a&&d.setStyle("background","hsl(145, 65%, 40%)");this._strengthMeter.set("progress",a)}}},{FORGOT_PASSWORD_TEMPLATE:'<a class="forgot">Forgot?</a>',CSS_PREFIX:"sqs-dialog-password",ATTRS:{forgotVisible:{value:!1,validator:a.Lang.isBoolean},strengthMeterVisible:{value:!1,validator:a.Lang.isBoolean,writeOnce:"initOnly"},
password:{value:!0,readOnly:!0}}})},"1.0",{requires:["base","squarespace-dialog-text","squarespace-plugin-progress-bar"]});
YUI.add("squarespace-plugin-progress-bar",function(a){a.namespace("Squarespace.Plugin");var c=a.Squarespace.Plugin.ProgressBar=a.Base.create("ProgressBar",a.Squarespace.Plugin.ProgressBase,[],{_renderContent:function(){c.superclass._renderContent.call(this);this._syncProgressBar()},_bindAttributeChanges:function(){c.superclass._bindAttributeChanges.call(this);this.after("progressChange",this._syncProgressBar,this)},_syncProgressBar:function(){var a=this._meterEl.one(".bar-inner"),d=this.get("progress"),
d=Math.max(0,Math.min(100,0+d));a.setStyle("width",d+"%")}},{NS:"progress-bar",PROGRESS_METER_TEMPLATE:'<div class="bar"><div class="bar-inner"></div></div>',ATTRS:{progress:{value:0,validator:function(b,d){return a.Lang.isNumber(b)&&0<=b&&100>=b}}}})},"1.0",{requires:["base","squarespace-plugin-progress-base"]});
YUI.add("squarespace-plugin-progress-base",function(a){a.namespace("Squarespace.Plugin");a.Squarespace.Plugin.ProgressBase=a.Base.create("ProgressBase",a.Plugin.Base,[],{initializer:function(){this._renderContent();this._bindAttributeChanges();this._setClasses();this._bindContent()},destructor:function(){var c=this._contentEl;c&&c.getDOMNode()&&(c.setStyle("opacity",0),a.later(this.get("unplugDelay"),c,c.remove));this._cancelEl=this._meterEl=this._contentEl=null;this.get("host").removeClass("progress-show-meter");
this.get("host").removeClass("progress-show-cancel")},_renderContent:function(){var c=this._contentEl=a.Node.create('<div class="progress-container"><div class="progress"><div class="cancel-process">Cancel</div></div></div>'),b=c.one(".progress");this._meterEl=a.Node.create(this.constructor.PROGRESS_METER_TEMPLATE);b.prepend(this._meterEl);this._cancelEl=c.one(".cancel-process");b=this.get("host");this.get("append")?b.append(c):b.prepend(c)},_bindAttributeChanges:function(){this.after(["showChange",
"showCancelChange"],this._setClasses,this)},_setClasses:function(){var a=this.get("host"),b=this.get("show"),d=this.get("showCancel");a.toggleClass("progress-show-meter",b);this._meterEl.toggleClass("visible",b);a.toggleClass("progress-show-cancel",d);this._cancelEl.toggleClass("visible",d)},_bindContent:function(){this._cancelEl.on("click",function(a){a.halt();this.fire("cancel")},this)}},{NS:"progress",PROGRESS_METER_TEMPLATE:"",ATTRS:{show:{value:!1,validator:a.Squarespace.AttrValidators.isBoolean},
showCancel:{value:!1,validator:a.Squarespace.AttrValidators.isBoolean},unplugDelay:{value:300,validator:a.Squarespace.AttrValidators.isNumber},append:{value:!1,validator:a.Squarespace.AttrValidators.isBoolean,writeOnce:"initOnly"}}})},"1.0",{requires:["base","node","plugin","squarespace-attr-validators"]});
YUI.add("squarespace-widgets-login-template",function(a){var c=a.Handlebars;(function(){var a=c.template;(c.templates=c.templates||{})["widgets-login.html"]=a(function(a,b,c,e,h){function k(a,b,c){var d;return a=""+('\n          <span data-login-method="'+x(typeof a===r?a.apply(a):a)+'" class="tab-item '+x(typeof a===r?a.apply(a):a)+" "+x((d=c.selectMode,typeof d===r?d.apply(a):d))+'"></span>\n        ')}function m(a,b){return"arrow"}this.compilerInfo=[4,">= 1.0.0"];c=this.merge(c,a.helpers);h=h||
{};var s,r="function",x=this.escapeExpression,p=this,v=c.blockHelperMissing;a='<div class="login-wrapper">\n  <div class="wait-overlay ';if((e=c.unless.call(b,b.waiting,{hash:{},inverse:p.noop,fn:p.program(1,function(a,b){return"hidden"},h),data:h}))||0===e)a+=e;a+='">\n    <div class="loading-spinner"></div>\n  </div>\n\n  <div class="header ';s={hash:{},inverse:p.noop,fn:p.program(3,function(a,b){return"has-title"},h),data:h};(e=c.title)?e=e.call(b,s):(e=b.title,e=typeof e===r?e.apply(b):e);c.title||
(e=v.call(b,e,s));if(e||0===e)a+=e;a+='">\n    ';if((e=c["if"].call(b,b.title,{hash:{},inverse:p.noop,fn:p.program(5,function(a,b){var d,e;d='\n      <div class="title">';(e=c.title)?e=e.call(a,{hash:{},data:b}):(e=a.title,e=typeof e===r?e.apply(a):e);if(e||0===e)d+=e;return d+"</div>\n    "},h),data:h}))||0===e)a+=e;a+='\n  </div>\n\n  <div class="body ';(e=c.activeLoginMethod)?e=e.call(b,{hash:{},data:h}):(e=b.activeLoginMethod,e=typeof e===r?e.apply(b):e);a+=x(e)+'">\n    ';if((e=c.unless.call(b,
b.hideTab,{hash:{},inverse:p.noop,fn:p.program(7,function(a,b){var d,e;d='\n    <div class="login-selector select-mode-';(e=c.selectMode)?e=e.call(a,{hash:{},data:b}):(e=a.selectMode,e=typeof e===r?e.apply(a):e);d+=x(e)+'">\n      <div class="tabs">\n        ';if((e=c.each.call(a,a.tabsEnabled,{hash:{},inverse:p.noop,fn:p.programWithDepth(8,k,b,a),data:b}))||0===e)d+=e;return d+"\n      </div>\n    </div>\n    "},h),data:h}))||0===e)a+=e;a+='\n\n    <div class="mode squarespace">\n      <div class="email-field-wrapper" data-field-name="email"></div>\n\n      <div class="password-field-wrapper">\n        <div data-field-name="password"></div>\n\n        <div class="password-recovery" data-action="password-recovery">Forgot?</div>\n      </div>\n\n      <div class="verification-code-field-wrapper hidden">\n        <div data-field-name="verification-code"></div>\n        <div class="two-factor-auth-explain" data-action="two-factor-auth-explain">Why?</div>\n      </div>\n\n      <div class="primordial-options">\n        <div class="stay-logged-in" data-field-name="stay-logged-in"></div>\n\n        ';
if((e=c["if"].call(b,b.enableGoogleLoginLink,{hash:{},inverse:p.noop,fn:p.program(10,function(a,b){return'\n          <div class="login-with-google" data-action="login-with-google">Login with Google+</div>\n        '},h),data:h}))||0===e)a+=e;a+="\n\n        ";if((e=c.unless.call(b,b.enableGoogleLoginLink,{hash:{},inverse:p.noop,fn:p.program(12,function(a,b){var d,e,g;d='\n          <div class="submit button ';if((g=c.unless.call(a,(e=a.strings,null==e||!1===e?e:e.loginButonTitle),{hash:{},inverse:p.noop,
fn:p.program(13,m,b),data:b}))||0===g)d+=g;return d+='" data-action="submit">'+x((e=(e=a.strings,null==e||!1===e?e:e.loginButonTitle),typeof e===r?e.apply(a):e))+"</div>\n        "},h),data:h}))||0===e)a+=e;a+='\n      </div>\n    </div>\n    <div class="mode google social-login">\n      <div class="social-login-button"></div>\n      <div class="social-login-cancel" data-action="login-with-squarespace">Login with Squarespace</div>\n    </div>\n    <div class="mode facebook social-login">\n      <div class="social-login-button"></div>\n      <div class="social-login-cancel" data-action="login-with-squarespace">Login with Squarespace</div>\n    </div>\n    <div class="mode twitter social-login">\n      <div class="social-login-button"></div>\n      <div class="social-login-cancel" data-action="login-with-squarespace">Login with Squarespace</div>\n    </div>\n    <div class="mode guest">\n      <div class="display-name-field-wrapper" data-field-name="displayName"></div>\n      <div class="anon-email-field-wrapper" data-field-name="anonEmail"></div>\n      <div class="author-url-field-wrapper" data-field-name="authorUrl"></div>\n      <div class="buttons">\n        ';
if((e=c["if"].call(b,b.canCancel,{hash:{},inverse:p.noop,fn:p.program(15,function(a,b){return'\n          <div class="cancel" data-action="cancel">Cancel</div>\n        '},h),data:h}))||0===e)a+=e;a+='\n        <div class="submit button" data-action="submit">'+x((e=(e=b.strings,null==e||!1===e?e:e.loginButonTitle),typeof e===r?e.apply(b):e))+'</div>\n      </div>\n    </div>\n  </div>\n\n  <div class="footer ';(e=c.activeLoginMethod)?e=e.call(b,{hash:{},data:h}):(e=b.activeLoginMethod,e=typeof e===
r?e.apply(b):e);a+=x(e)+'">\n    <div class="buttons">\n      ';if((e=c["if"].call(b,b.canCancel,{hash:{},inverse:p.noop,fn:p.program(17,function(a,b){return'\n        <div class="cancel" data-action="cancel">Cancel</div>\n      '},h),data:h}))||0===e)a+=e;a+="\n\n      ";if((e=c["if"].call(b,b.canCreateAccount,{hash:{},inverse:p.noop,fn:p.program(19,function(a,b){return'\n        <div class="create-account" data-action="create-account">Create Squarespace Account</div>\n      '},h),data:h}))||0===
e)a+=e;a+="\n\n      ";if((e=c["if"].call(b,b.enableGoogleLoginLink,{hash:{},inverse:p.noop,fn:p.program(21,function(a,b){var d,e,g;d='\n        <div class="submit button ';if((g=c.unless.call(a,(e=a.strings,null==e||!1===e?e:e.loginButonTitle),{hash:{},inverse:p.noop,fn:p.program(13,m,b),data:b}))||0===g)d+=g;return d+='" data-action="submit">'+x((e=(e=a.strings,null==e||!1===e?e:e.loginButonTitle),typeof e===r?e.apply(a):e))+"</div>\n      "},h),data:h}))||0===e)a+=e;return a+"\n    </div>\n  </div>\n</div>"})})();
a.Handlebars.registerPartial("widgets-login.html".replace("/","."),c.templates["widgets-login.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-widgets-password-recovery",function(a){var c={email:{ctor:a.Squarespace.DialogFields.Text,config:{name:"email",submitOnEnter:!0,strings:{placeholder:"Email Address"}}},description:{ctor:a.Squarespace.DialogFields.Description,config:{name:"description",text:"Please enter the email address that you used when creating your account. An email will be sent to that address with further instructions on how to reset your password."}},"sent-description":{ctor:a.Squarespace.DialogFields.Description,
config:{name:"sent-description",text:"You have been sent an email with further instructions on resetting your password."}}};a.namespace("Squarespace.Widgets");var b=a.Squarespace.Widgets.PasswordRecovery=a.Base.create("passwordRecovery",a.Squarespace.SSWidget,[],{delegatedEvents:{'[data-action="cancel"]':{click:"_onCancel"},'[data-action="submit"]':{click:"_onSubmit"}},initializer:function(){this._initializeFields()},_initializeFields:function(){var b=[],g={errorFlyoutRenderTarget:this.get("boundingBox")};
a.Object.each(c,function(c,e){b.push(new c.ctor(a.merge(g,c.config)))});a.Squarespace.FormUtils.setData(b,this.getAttrs());this._fields=b},destructor:function(){a.Squarespace.FormUtils.hideErrors(this._fields)},renderUI:function(){b.superclass.renderUI.call(this);a.Squarespace.FormUtils.template(this.get("contentBox"),this._fields)},bindUI:function(){b.superclass.bindUI.call(this);a.Array.each(this._fields,function(a){if("text"===a.getType())a.on("submit",this._onSubmit,this)},this);this.on("stateChange",
this._onStateChange,this)},_getHBTemplateContext:function(){return b.superclass._getHBTemplateContext.call(this)},_onStateChange:function(a){var b=this.get("contentBox").one(".password-recovery-wrapper");b.removeClass("state-"+a.prevVal);b.addClass("state-"+a.newVal)},_onSubmit:function(){var b=a.Squarespace.FormUtils.getData(this._fields).email;this._isValidEmail(b)?(this.set("email",b),this._sendPasswordReset(b).then(a.bind(this._sentSuccessfully,this),a.bind(this._sendFailed,this))):a.Squarespace.FormUtils.showErrors(this._fields,
{email:"You need a valid email address."})},_isValidEmail:function(b){return a.Lang.isString(b)&&0<b.indexOf("@")},_sentSuccessfully:function(a){this.set("state","sent")},_sendFailed:function(b){this.set("state","form");a.Squarespace.FormUtils.showErrors(this._fields,b.errors)},_onCancel:function(){this.destroy()},_sendPasswordReset:function(b){this.set("state","sending");return new a.Promise(function(c,f){a.Data.post({url:"/api/auth/PasswordReset",secure:!0,data:{email:b},success:c,failure:f})})}},
{CSS_PREFIX:"sqs-widgets-password-recovery",HANDLEBARS_TEMPLATE:"widgets-password-recovery.html",ATTRS:{email:{validator:a.Squarespace.AttrValidators.isString},state:{value:"form",validator:a.Squarespace.AttrValidators.isString}}})},"1.0",{requires:["base","squarespace-ss-widget","squarespace-dialog-text","squarespace-widgets-password-recovery-template","squarespace-form-utils"]});
YUI.add("squarespace-widgets-password-recovery-template",function(a){var c=a.Handlebars;(function(){var a=c.template;(c.templates=c.templates||{})["widgets-password-recovery.html"]=a(function(a,b,c,e,h){this.compilerInfo=[4,">= 1.0.0"];c=this.merge(c,a.helpers);h=h||{};e=this.escapeExpression;a='<div class="password-recovery-wrapper state-';(c=c.state)?c=c.call(b,{hash:{},data:h}):(c=b.state,c="function"===typeof c?c.apply(b):c);return a+=e(c)+'">\n  <h1>Password Reset</h1>\n  <div class="form">\n    <div data-field-name="description"></div>\n    <div data-field-name="email"></div>\n    <div class="buttons">\n      <a class="cancel" data-action="cancel">Cancel</a>\n      <div class="submit" data-action="submit">Send Email</div>\n    </div>\n  </div>\n  <div class="sending">\n  </div>\n  <div class="sent">\n    <div data-field-name="sent-description"></div>\n    <div class="buttons">\n      <input class="cancel" type="button" data-action="cancel" value="Back to Login">\n    </div>\n  </div>\n</div>\n'})})();
a.Handlebars.registerPartial("widgets-password-recovery.html".replace("/","."),c.templates["widgets-password-recovery.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-plugin-v5login",function(a){a.namespace("Squarespace.Plugin");a.Squarespace.Plugin.V5Login=a.Base.create("V5Login",a.Plugin.Base,[],{initializer:function(c){this._eventHandler=a.Do.before(this._proxyLogin,this.get("host"),"_loginSquarespace",this)},destroy:function(){this._eventHandler.detach();this._eventHandler=null},_proxyLogin:function(){var c=this.get("host"),b=a.Squarespace.FormUtils.getData(c._fields),c=b.email,b=b.password;if(-1===c.indexOf("@"))return new a.Do.Halt("V5 account",
this._v5Login(c,b))},_v5Login:function(c,b){var d=b64_sha1(b);return SQUARESPACE_LOGIN.loginRPCProvider?new a.Promise(function(a,b){SQUARESPACE_LOGIN.loginRPCProvider.v5LoginRequest(c,d,a,function(a){b(a.message)})}):a.Squarespace.Auth.loginV5(c,d)}},{NS:"v5login"})},"1.0",{requires:["base","thirdparty-sha1","squarespace-v5login-utils"]});
YUI.add("squarespace-v5login-utils",function(a){a.namespace("Squarespace.Auth");a.Squarespace.Auth.loginV5=function(c,b){return new a.Promise(function(d,g){a.Data.post({xdr:{credentials:!0},url:"http://squarespace5.squarespace.com/process/service/CredentialCheck",data:{A:c,B:b,from6:!0},success:function(f){a.Data.post({xdr:{credentials:!0},url:"http://"+c+".squarespace.com/process/Login",data:{username:c,encryptedPassword:b,from6:!0},success:function(a){"success"===a.result?d({type:"v5",url:"http://"+
c+".squarespace.com"}):g({type:"v5",error:"unkown error"})},failure:function(a){a.type="v5";g(a)}},this)},failure:function(b){b.type="v5";b.errors?(a.Object.each(b.errors,function(a,c){b.errors[c]=a.replace(/support@squarespace.com/g,"customercare@squarespace.com")}),g(b)):g({error:"There was an unexpected error. Please try again later."})}},this)})}},"1.0",{requires:["promise","squarespace-util"]});
YUI.add("squarespace-widgets-alert",function(a){a.namespace("Squarespace.Widgets");a.Squarespace.Widgets.Alert=a.Base.create("alert",a.Squarespace.Widgets.Confirmation,[],{},{CSS_PREFIX:"sqs-widgets-confirmation",TYPE:a.Squarespace.Widgets.Confirmation.TYPE,ANCHOR:a.Squarespace.Widgets.Confirmation.ANCHOR,ATTRS:{className:{value:"alert"},style:{value:a.Squarespace.Widgets.Confirmation.TYPE.CONFIRM_ONLY},"strings.confirm":{value:"Okay"}}})},"1.0",{requires:["base","squarespace-widgets-confirmation"]});
YUI.add("squarespace-json-template",function(a){function c(a){return a.replace(/([\{\}\(\)\[\]\|\^\$\-\+\?])/g,"\\$1")}function b(a,b){var d=r[a+b];void 0===d&&(d="("+c(a)+"\\S.*?"+c(b)+"\n?)",d=RegExp(d,"g"));return d}function d(a,b){var c=[{context:a,index:-1}];return{PushSection:function(a){if(void 0===a||null===a)return null;a="@"==a?c[c.length-1].context:c[c.length-1].context[a]||null;c.push({context:a,index:-1});return a},Pop:function(){c.pop()},next:function(){var a=c[c.length-1];-1==a.index&&
(a={context:null,index:0},c.push(a));var b=c[c.length-2].context;if(a.index==b.length)c.pop();else return a.context=b[a.index++],!0},_Undefined:function(a){return void 0===b?null:b},_LookUpStack:function(a){for(var b=c.length-1;;){var d=c[b];if("@index"==a){if(-1!=d.index)return d.index}else if(d=d.context,"object"===typeof d&&(d=d[a],void 0!==d))return d;b--;if(-1>=b)return this._Undefined(a)}},get:function(a){if("@"==a)return c[c.length-1].context;var b=a.split("."),d=this._LookUpStack(b[0]);if(1<
b.length)for(var e=1;e<b.length;e++){if(null===d)return"[JSONT: Can't resolve '"+a+"'.]";d=d[b[e]];if(void 0===d)return this._Undefined(b[e])}return d}}}function g(a,b,c){for(var d=0;d<a.length;d++){var e=a[d];if("string"==typeof e)c(e);else(0,e[0])(e[1],b,c)}}function f(a,b,c){var d;d=b.get(a.name);for(var e=0;e<a.formatters.length;e++){var f=a.formatters[e];d=(0,f[0])(d,b,f[1])}c(d)}function e(a,b,c){var d=b.PushSection(a.section_name),e=!1;d&&(e=!0);d&&0===d.length&&(e=!1);e?(g(a.Statements(),
b,c),b.Pop()):(b.Pop(),g(a.Statements("or"),b,c))}function h(a,b,c){for(var d=b.get("@"),e=0;e<a.clauses.length;e++){var f=a.clauses[e],h=f[1];if((0,f[0][0])(d,b,f[0][1])){g(h,b,c);break}}}function k(a,b,c){var d=b.PushSection(a.section_name);if(d&&0<d.length){var d=d.length-1,e=a.Statements();a=a.Statements("alternate");for(var f=0;void 0!==b.next();f++)g(e,b,c),f!=d&&g(a,b,c)}else g(a.Statements("or"),b,c);b.Pop()}function m(c,d){function g(b){if(b.startsWith(s)){var c=d.partials[b.substr(s.length)];
if(c)return[function(b,d,e){return a.JSONTemplate.evaluateJsonTemplate(c,b)},null];throw{name:"BadPartialInclude",message:b.substr(s)+" is not a valid partial. Remember, loops are not supported (a partial include cannot be included inside itself)."};}var e=r.lookup(b);if(!e[0])throw{name:"BadFormatter",message:b+" is not a valid formatter"};return e}function m(a){var b=n.lookup(a);if(!b[0])throw{name:"BadPredicate",message:a+" is not a valid predicate"};return b}var r=new v([x(a.JSONTemplate.DEFAULT_FORMATTERS),
p(a.JSONTemplate.DEFAULT_PREFIX_FORMATTERS)]),n=v([x(a.JSONTemplate.DEFAULT_PREDICATES),p(a.JSONTemplate.DEFAULT_PARAMETRIC_PREDICATES)]),w=d.format_char||"|";if(":"!=w&&"|"!=w)throw{name:"ConfigurationError",message:"Only format characters : and | are accepted"};var C=d.meta||"{}",F=C.length;if(1==F%2)throw{name:"ConfigurationError",message:C+" has an odd number of metacharacters"};for(var P=C.substring(0,F/2),C=C.substring(F/2,F),F=b(P,C),y=D({}),G=[y],E=P.length,z,q,I=0;;){z=F.exec(c);if(null===
z)break;else q=z[0];z.index>I&&(I=c.slice(I,z.index),y.Append(I));I=F.lastIndex;z=!1;"\n"==q.slice(-1)&&(q=q.slice(null,-1),z=!0);q=q.slice(E,-E);if("#"!=q.charAt(0)){if("."==q.charAt(0)){q=q.substring(1,q.length);var B={"meta-left":P,"meta-right":C,space:" ",tab:"\t",newline:"\n"}[q];if(void 0!==B){y.Append(B);continue}if(B=q.match(Q)){q=B[3];B[1]?(z=k,q=H({section_name:q})):(z=e,q=D({section_name:q}));y.Append([z,q]);G.push(q);y=q;continue}var J;if(B=q.match(N)){z=(J=B[1])?m(J):null;y.NewOrClause(z);
continue}var B=!1,A=q.match(O);if(A){if(J=A[1],B=!0,-1==J.indexOf("?")){z=[function(a){return function(b,c){var d,e,f;if(-1!==a.indexOf(" || ")){d=a.split("||");for(f=0;f<d.length;f++)if(e=d[f].trim(),c.get(e))return!0;return!1}if(-1!==a.indexOf(" && ")){d=a.split(" && ");for(f=0;f<d.length;f++)if(e=d[f].trim(),!c.get(e))return!1;return!0}return c.get(a)}}(J),null];q=K();q.NewOrClause(z);y.Append([h,q]);G.push(q);y=q;continue}}else if("?"==q.charAt(q.length-1)||"?"==q.split(" ")[0].charAt(q.split(" ")[0].length-
1))J=q,B=!0;if(B){z=J?m(J):null;q=K();q.NewOrClause(z);y.Append([h,q]);G.push(q);y=q;continue}if("alternates with"==q){y.AlternatesWith();continue}if("end"==q){G.pop();if(0<G.length)y=G[G.length-1];else throw{name:"TemplateSyntaxError",message:"Got too many {end} statements"};continue}}A=q.split(w);if(1==A.length)B=[g("str")];else{B=[];for(q=1;q<A.length;q++)B.push(g(A[q]));q=A[0]}y.Append([f,{name:q,formatters:B}]);z&&y.Append("\n")}}y.Append(c.slice(I));if(1!==G.length)throw{name:"TemplateSyntaxError",
message:"Got too few {end} statements."};return y}a.namespace("JSONTemplate");var s="apply ",r={};a.JSONTemplate.DEFAULT_FORMATTERS=a.Squarespace.TEMPLATE_FORMATTERS;a.JSONTemplate.DEFAULT_PREFIX_FORMATTERS=[].concat(a.Squarespace.TEMPLATE_PREFIX_FORMATTERS,[{name:"pluralize",func:function(a,b,c){switch(c.length){case 0:b="";c="s";break;case 1:b="";c=c[0];break;case 2:b=c[0];c=c[1];break;default:throw{name:"EvaluationError",message:"pluralize got too many args"};}return 1==a?b:c}},{name:"encode-space",
func:function(a,b,c){return a.replace(/\s/g,"&nbsp;")}},{name:"truncate",func:function(a,b,c){b=c[0]||100;c=c[1]||"...";a&&a.length>b&&(a=a.substring(0,b),a=a.replace(/\w+$/,""),a+=c);return a}},{name:"date",func:function(b,c,d){var e=0,e=(new Date(b)).getTimezoneOffset();if(!a.Lang.isNumber(b))return"Invalid date.";if("undefined"!==typeof TimezoneJS){var f;try{f=new TimezoneJS.Date(b,c.get("website.timeZone"))}catch(g){return"Invalid Timezone"}e=(isNaN(f.getTimezoneOffset())?0:f.getTimezoneOffset())-
e}else c=-parseInt(c.get("website.timeZoneOffset"),10)/6E4,f=(new Date).getTimezoneOffset(),e=c-f;b=new Date(b-6E4*e);d=d.join(" ");return a.DataType.Date.format(b,{format:d})}},{name:"image",func:function(b,c,d){var e;b.mediaFocalPoint&&(e=b.mediaFocalPoint.x+","+b.mediaFocalPoint.y);return'<img class="'+(d[0]?d[0]:"thumb-image")+'" '+(b.title?'alt="'+a.Squarespace.Escaping.escapeForHtmlTag(b.title)+'" ':"")+' data-image="'+b.assetUrl+'" data-image-dimensions="'+b.originalSize+'" data-image-focal-point="'+
e+'"/>'}},{name:"timesince",func:function(b,c,d){if(!a.Lang.isNumber(b))return"Invalid date.";d.join(" ");return'<span class="timesince" data-date="'+b+'">'+a.Squarespace.DateUtils.humanizeDate(b)+"</span>"}},{name:"resizedHeightForWidth",func:function(a,b,c){b=a.split("x");if(2!=b.length)return"Invalid source parameter.  Pass in 'originalSize'.";a=parseInt(b[0],10);b=parseInt(b[1],10);c=parseInt(c[0],10)/a;return parseInt(b*c,10)}},{name:"resizedWidthForHeight",func:function(a,b,c){b=a.split("x");
if(2!=b.length)return"Invalid source parameter.  Pass in 'originalSize'.";a=parseInt(b[0],10);b=parseInt(b[1],10);c=parseInt(c[0],10)/b;return parseInt(a*c,10)}},{name:"squarespaceThumbnailForWidth",func:function(b,c,d){return a.Squarespace.Rendering.getSquarespaceSizeForWidth(parseInt(d[0],10))}},{name:"squarespaceThumbnailForHeight",func:function(b,c,d){c=b.split("x");if(2!=c.length)return"Invalid source parameter.  Pass in 'originalSize'.";b=parseInt(c[0],10);c=parseInt(c[1],10);d=parseInt(d[0],
10)/c;d=parseInt(b*d,10);return a.Squarespace.Rendering.getSquarespaceSizeForWidth(d)}},{name:"cycle",func:function(a,b,c){return c[(a-1)%c.length]}}]);var x=function(a){return{lookup:function(b){return[a[b]||null,null]}}},p=function(a){return{lookup:function(b){for(var c=0;c<a.length;c++){var d=a[c].name,e=a[c].func;if(b.slice(0,d.length)==d)return c=b.charAt(d.length),b=""===c?[]:b.split(c).slice(1),[e,b]}return[null,null]}}},v=function(a){return{lookup:function(b){for(var c=0;c<a.length;c++){var d=
a[c].lookup(b);if(d[0])return d}return[null,null]}}},w=function(a){var b={current_clause:[],Append:function(a){b.current_clause.push(a)},AlternatesWith:function(){throw{name:"TemplateSyntaxError",message:"{.alternates with} can only appear with in {.repeated section ...}"};},NewOrClause:function(a){throw{name:"NotImplemented"};}};return b},D=function(a){var b=w(a);b.statements={"default":b.current_clause};b.section_name=a.section_name;b.Statements=function(a){return b.statements[a||"default"]||[]};
b.NewOrClause=function(a){if(a)throw{name:"TemplateSyntaxError",message:"{.or} clause only takes a predicate inside predicate blocks"};b.current_clause=[];b.statements.or=b.current_clause};return b},H=function(a){var b=D(a);b.AlternatesWith=function(){b.current_clause=[];b.statements.alternate=b.current_clause};return b},K=function(a){var b=w(a);b.clauses=[];b.NewOrClause=function(a){a=a||[function(a){return!0},null];b.current_clause=[];b.clauses.push([a,b.current_clause])};return b},Q=/(repeated)?\s*(section)\s+(\S+)?/,
N=/^or(?:[\s\-]+(.+))?/,O=/^if(?:[\s\-]+(.+))?/;a.JSONTemplate.Template=Class.create({initialize:function(a,b,c){a=this.removeMultilineComments(a);this._options=b||{};this._program=m(a,this._options)},removeMultilineComments:function(a){for(var b=a.search("{##"),c;0<=b;)c=a.substr(b),a=a.substr(0,b)+c.substr(c.search("##}")+3),b=a.search("{##");return a},render:function(a,b){var c=d(a,this._options.undefined_str);g(this._program.Statements(),c,b)},expand:function(a){var b=[];this.render(a,function(a){b.push(a)});
return b.join("")}});a.JSONTemplate.DEFAULT_PREDICATES=a.Squarespace.TEMPLATE_PREDICATES;a.JSONTemplate.DEFAULT_PARAMETRIC_PREDICATES=a.Squarespace.TEMPLATE_PARAMETRIC_PREDICATES;a.JSONTemplate.evaluateJsonTemplate=function(b,c,d){return"string"!=typeof b?"JSON Template Error: Processing failed because no input was provided. (type: "+typeof b+", template: "+JSON.stringify(b)+", dictionary: "+JSON.stringify(c)+", partials: "+JSON.stringify(d)+")":(new a.JSONTemplate.Template(b,{partials:d})).expand(c)}},
"1.0",{requires:"datatype-date-format squarespace-common squarespace-util squarespace-date-utils json squarespace-template-helpers".split(" ")});
