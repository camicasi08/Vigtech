YUI.add("squarespace-dialog",function(a){a.namespace("Squarespace");a.Squarespace.OPEN_DIALOGS=[];a.Squarespace.DialogStates={CLOSED:1,EDITING:2,LOADING:3,CLOSING:4,SAVING:5,MOVING:6};a.Squarespace.EditingDialog=Class.extend(a.Squarespace.ZombieGizmo,{_name:"EditingDialog",_events:{show:{},shown:{},aftershowanim:{},"align-to-anchor":{},"aligned-to-anchor":{},loading:{},"cancel-loading":{},"loading-ready":{},ready:{},drag:{},hide:{},hidden:{},close:{},closed:{},canceled:{},"cancel-clicked":{},"overlay-click":{},
"show-save-overlay":{},"save-overlay-shown":{},"hide-save-overlay":{},"save-overlay-hidden":{},"render-anchor":{},datachange:{},datachanged:{},"send-requested":{emitFacade:!0},"remove-requested":{},"data-saved":{},"auto-save":{},"auto-save-requested":{emitFacade:!0},"allow-editing":{},"editing-allowed":{},"show-errors":{},"local-errors":{}},initialize:function(d){this._super(d);this.setParams(d);this._setState("CLOSED");this.bodyEvents=[];this.buttonEvents=[];this.globalEvents=[];this.childDialogs=
[];this.verticalFields=[];this.timers=[];this.fields={};this.sections={};this._noNameFields=[];this._setEdited(!1);this.NOTCH_WIDTH=20;this.BUTTONS_BASE_IDX=100;this.NOTCH_HEIGHT=11;this.lastTabIndex=1;this.on("datachange",this.onDataChange,this);this._debug=new a.Squarespace.Debugger({name:"EditingDialog",output:!1});this.publish("show",{prefix:"EditingDialog",broadcast:2,emitFacade:!0});this.publish("dismiss",{prefix:"EditingDialog",broadcast:2,emitFacade:!0});this.publish("tab-shown",{prefix:"EditingDialog",
broadcast:2,emitFacade:!0});this.publish("button-click",{prefix:"EditingDialog",broadcast:2,emitFacade:!0,preventable:!1})},defaultOpts:{tabs:[],initialData:{},buttons:[],style:"standard",colorScheme:"light",buttonAlign:"right",position:"center",verticalHeight:"fixed",flyoutPointerDirection:"left",closingText:"Canceled...",savingText:"Saving...",top:60,closeOthers:!0,disableTips:!0,closeable:!0,autoFocus:!0,discardChangesConfirmation:!0,overlay:!1,validateActiveTabOnly:!1,edgeMargin:11,initialDataByReference:!1},
getName:function(){return this.params.name},getInitialData:function(){return this.params.initialData},setParams:function(d){if(d){d.embedWithinEl&&(d.closeable=!1,d.closeOthers=!1,d.style||(d.style="transparent"),d.colorScheme||(d.colorScheme="dark"),d.buttonAlign||(d.buttonAlign="left"),d.top||(d.top=null));this.params=a.merge(this.defaultOpts,d);this.params.primaryTabs&&(this.params.tabs=this.params.tabs.concat(this.params.primaryTabs),delete this.params.primaryTabs);this.params.secondaryTabs&&
(this.params.tabs=this.params.tabs.concat(this.params.secondaryTabs),delete this.params.secondaryTabs);if((!this.params.tabs||0===this.params.tabs.length)&&this.params.fields)this.params.tabs=[{fields:this.params.fields}];this.params.tabs[0].tabTitle||(this.params.tabs[0].tabTitle="Item");this.params.tabs[0].name||(this.params.tabs[0].name="item");"transparent"===this.params.style&&(this.params.disableSaveOverlay=!0);!d.discardChangesConfirmation&&0===this.params.buttons.length&&(this.params.discardChangesConfirmation=
!1);this.definitionChanged=!0}},show:function(d){this.fire("show");this._debug.log("Showing",["showParams",d],["this.params",this.params]);this.moving&&(this._setState("EDITING"),this.animation&&this.animation.stop(),this.fire("cancel-loading"));if(!this.destroyTimer&&!this._isState("LOADING")&&!this._isState("CLOSING"))if(a.Squarespace.ToolTipManager&&this.params.disableTips&&a.Squarespace.ToolTipManager.disableTooltips(),this.anchorEl&&this.anchorEl.removeClass("targeted"),d&&this._setShowParams(d),
this.params.parentDialog&&this.params.parentDialog.addChildDialog(this),this._isState("CLOSED")){this.definitionChanged=!1;if(this.params.closeOthers){d=0;for(var b=a.Squarespace.OPEN_DIALOGS.length;d<b;++d)a.Squarespace.OPEN_DIALOGS[d].cancel()}a.Squarespace.OPEN_DIALOGS.push(this);a.one(document.body).addClass("dialog-open");this.fire("loading");this._setState("LOADING");this.timers.push(a.later(100,this,function(){this.params.closeable&&a.Squarespace.EscManager.addTarget(this);this.globalEvents.push(a.on("resize",
this.onResize,a.one(window),this))}));a.one(document).get("winWidth");a.one(document).get("winHeight");this._addTitleEl();this._addBodyEl();this.mainEl=a.Node.create('<div class="main-container"></div>').append(this.titleEl).append(this.bodyEl).append(this.controlsEl);d="";this.params.disableStandardDialogWrapperClass||(d+="standard-dialog-wrapper ");d+="squarespace-managed-ui "+this.params.style+" "+this.params.colorScheme+" buttons-"+this.params.buttonAlign;this.params.name&&(d+=" dialog-"+a.Squarespace.Utils.slugify(this.params.name));
this.el=a.Node.create('<div class="'+d+'"></div>').append(this.mainEl);this.bodyEvents.push(this.el.on("click",function(b){this.cancelChildDialogs();this.fire("click",b)},this));this.params.zIndex?this.zIndex=this.params.zIndex:(a.Squarespace.DIALOG_ZINDEX_BASE+=10,this.zIndex=a.Squarespace.DIALOG_ZINDEX_BASE);this.el.setStyle("zIndex",this.zIndex);this.params.draggable&&this.enableDragging();this.params.hidable&&this._addHideEl();this.params.headerButton&&this._addHeaderButtonEl();this.buttonHolder=
a.Node.create("<div>").addClass("button-holder");this.autosaveEl=a.Node.create("<div>").addClass("autosave-state");this.controlsEl&&(this.controlsEl.append(this.autosaveEl),this.controlsEl.append(this.buttonHolder));d=this.anchorEl?this._positionWithAnchorEl():this.params.embedWithinEl?this._positionWithEmbededEl():this._positionWithDefault();this.params.loadingState?(d=this._anim({node:this.el,to:d[1]?{opacity:0.9,top:d[1]}:{opacity:0.9},duration:0.15,easing:a.Easing.easeOutStrong}),d.on("end",function(){this.fire("loading-ready")},
this),d.run()):this.dataReady();if("full"==this.params.verticalHeight||"fit"==this.params.verticalHeight)this.el.setStyles({top:this.params.edgeMargin+"px",bottom:this.params.edgeMargin+"px"}),this.params.top=this.params.edgeMargin;this.params.overlay&&(this.overlayEl=a.Node.create("<div>").addClass("dialog-screen-overlay"),this.overlayEl.setStyle("zIndex",this.zIndex-1),a.one(document.body).append(this.overlayEl),JSTween.tween(this.overlayEl.getDOMNode(),{opacity:{start:0,stop:100*this.params.overlay,
time:0,duration:0.3,effect:"easeOut"}}),this.globalEvents.push(a.on("click",this.onOverlayClick,this.overlayEl,this)));this.moveIntoView();a.later(300,this,function(){this._shown=!0;this.fire("shown",this)})}else this.anchorEl&&(this.anchorEl.addClass("targeted"),this._setState("LOADING"),this.moving=!0,this.updateTitle(),this.fire("loading"),this._updatePosition(!1),this.position&&(this.animation=this._anim({node:this.el,to:{left:this.position.getX()+"px",top:this.position.getY()+"px"},duration:0.25,
easing:a.Easing.easeOutStrong}),this.animation.on("end",function(){this.fire("loading-ready");this.dataReady()},this),this.animation.run()))},_setShowParams:function(a){a.data&&(this.data=a.data);a.anchor&&(this.anchorEl=a.anchor);a.top&&(this.params.top=a.top);a.flyoutPointerDirection&&(this.params.flyoutPointerDirection=a.flyoutPointerDirection)},_addHeaderButtonEl:function(){var d=a.Node.create('<div class="header-button"></div>'),b=a.DB.INPUT({type:"button",value:this.params.headerButton.title,
data:{type:this.params.headerButton.type}});a.on("click",this.params.headerButton.onclick,b,this);this.el.append(d.append(b))},_addBodyEl:function(){this.bodyEl=a.Node.create('<div class="body-block"></div>');0!==this.params.buttons.length?this.controlsEl=a.Node.create('<div class="controls-block"></div>'):this.bodyEl.addClass("bottom")},_addTitleEl:function(){var d=this.params.icon||this.params.tabs[0].icon,b=a.DB.DIV("icon",{style:"background-image: url("+d+");",data:{index:0}});this.titleEl=a.Node.create('<div class="title-block loading"></div>');
this.titlePrimaryTabEl=a.Node.create('<div class="icon-holder"></div>');this.titleTextEl=a.Node.create('<div class="text-holder"></div>');this.titleEl.append(this.titlePrimaryTabEl);this.titleEl.append(this.titleTextEl);this.tabsEl=a.Node.create('<div class="configuration-container-tabs"></div>');d&&this.titlePrimaryTabEl.append(b);a.Lang.isNumber(this.currentTabIndex)||(this.currentTabIndex=0);this.titleEl.append(this.tabsEl);this.updateTitle()},_addHideEl:function(){var d=a.Node.create('<div class="dialog-close"></div>');
this.el.prepend(d);d.on("click",function(){this.fire("user-close");this.close()},this)},_positionWithAnchorEl:function(){var d,b,c,e,f=this.params.width;this.el.setStyle("position",this.params.forcePosition||"absolute");this.anchorEl.addClass("targeted");"left"===this.params.flyoutPointerDirection||"right"===this.params.flyoutPointerDirection?(this.el.setStyle("width",f+this.NOTCH_HEIGHT+"px"),this.mainEl.setStyle("width",f+"px"),this.el.addClass("flyout")):"hidden"===this.params.flyoutPointerDirection?
(this.el.setStyle("width",f+"px"),this.mainEl.setStyle("width",f+"px")):"top"===this.params.flyoutPointerDirection?(this._initNotchEl("top"),this.el.insertBefore(this.notchEl,this.mainEl),c=this.anchorEl.get("offsetWidth"),b=this.anchorEl.get("offsetHeight"),d=this.anchorEl.getX(),b=this.anchorEl.getY()+b,f>c&&(d-=(f-c)/2),this.currentXY=[d,b-3],this.notchEl.setStyle("marginLeft",(f-30)/2+"px"),c=this.params.left||this.currentXY[0],e=this.params.top||this.currentXY[1],this.el.setStyles({left:c+"px",
top:e+"px",width:f+"px"}),this.mainEl.setStyle("width",f+"px")):"bottom"===this.params.flyoutPointerDirection?(this._initNotchEl("top","bottom"),this.el.append(this.notchEl),c=this.anchorEl.get("offsetWidth"),b=this.anchorEl.get("offsetHeight"),d=this.anchorEl.getX(),b=this.anchorEl.getY()+b,f>c&&(d-=(f-c)/2),this.currentXY=[d,b-3],this.notchEl.setStyle("marginLeft",(f-30)/2+"px"),c=this.params.left||this.currentXY[0],e=this.params.top||this.currentXY[1],this.el.setStyles({left:c+"px",top:e+"px",
width:f+"px"}),this.mainEl.setStyle("width",f+"px")):(this.currentXY=[this.anchorEl.getX()+(this.anchorEl.get("offsetWidth")-f)/2,this.anchorEl.getY()+(this.anchorEl.get("offsetHeight")-this.params.height)/2-15],this.el.setStyles({left:this.currentXY[0]+"px",top:this.currentXY[1]+"px",width:f+"px"}),this.el.setStyle(),this.mainEl.setStyle("width",f+"px"),b=this.currentXY[1]);a.one(a.config.doc.body).append(this.el);return[d,b]},_positionWithEmbededEl:function(){if(this.params.left||this.params.top)this.el.setStyle("position",
"absolute"),this.params.top&&this.el.setStyle("top",this.params.top+"px"),this.params.left&&this.el.setStyle("left",this.params.left+"px");this.el.setStyle("width",this.params.width+"px");this.mainEl.setStyle("width",this.params.width+"px");this.params.embedWithinEl.append(this.el);return[0,0]},_positionWithDefault:function(){var d,b=a.one(document).get("winWidth");a.one(document).get("winHeight");this.el.setStyle("position","fixed");"right"===this.params.position?(this.el.setStyles({right:this.params.edgeMargin+
"px",top:"0px"}),0===this.params.edgeMargin&&(this.titleEl.setStyle("border-radius","0px"),this.controlsEl.setStyle("border-radius","0px"))):"undefined"!==typeof this.params.left?this.currentXY=[this.params.left,this.params.top]:(this.currentXY=[(b-this.params.width)/2,this.params.top],this.el.setStyle("position","fixed"));this.currentXY&&(this.el.setStyles({left:this.currentXY[0]+"px",top:this.currentXY[1]+"px"}),d=this.currentXY[1]);this.el.setStyle("width",this.params.width+"px");this.mainEl.setStyle("width",
this.params.width+"px");a.one(document.body).append(this.el);return[void 0,d]},isOpen:function(){return this._isState("LOADING")||this._isState("EDITING")},disableBodyScroll:function(){this.oldBodyScroll=a.one("body").getStyle("overflow");a.one("body").setStyle("overflow","hidden")},restoreBodyScroll:function(){this.hasOwnProperty("oldBodyScroll")&&(this.oldBodyScroll?a.one("body").setStyle("overflow",this.oldBodyScroll):a.one("body").setStyle("overflow",null))},getAnchorEl:function(){return this.anchorEl},
getChildDialogs:function(){return this.childDialogs},addChildDialog:function(a){0>this.childDialogs.indexOf(a)&&(this.cancelChildDialogs(),this._debug.log("addChildDialog",a),this.childDialogs.push(a));a.params.parentDialog=this},removeChildDialog:function(d){this.childDialogs=a.Array.filter(this.childDialogs,function(a){return a!==d},this)},enableDragging:function(){this.titleEl.setStyle("cursor","move");this.dd=new a.DD.Drag({node:this.el});this.dd.on("drag:mouseDown",function(d){a.Squarespace.Help&&
a.Squarespace.Help.active&&d.halt();d.ev.target.ancestor(".body-block",!0)&&d.halt()},this);this.dd.on("drag:start",this.cancelChildDialogs,this);this.dd.on("drag:drag",function(a){this.fire("drag",a)},this);this.dd.on("drag:end",function(a){this.moveIntoView()},this)},temporaryHide:function(d){this.fire("hide");a.Array.each(this.childDialogs,function(a){a.temporaryHide()},this);this.hideAnim&&this.hideAnim.stop();this._hideAnimEvent&&this._hideAnimEvent.detach();this.overlayHideAnim&&this.overlayHideAnim.stop();
this._overlayHideAnimEvent&&this._overlayHideAnimEvent.detach();this.hideAnim=this._anim({node:this.el,to:{opacity:0},duration:0.35,easing:a.Easing.easeOutStrong});this.overlayEl&&(this.overlayHideAnim=this._anim({node:this.overlayEl,to:{opacity:0},duration:0.35,easing:a.Easing.easeOutStrong}),this._overlayHideAnimEvent=this._subscribe(this.overlayHideAnim,"end",function(){this.overlayEl.setStyle("display","none")}));this._hideAnimEvent=this._subscribe(this.hideAnim,"end",function(){this.el.setStyle("display",
"none");this.fire("hidden",this)});d?(this.el.setStyle("display","none"),this.overlayEl&&this.overlayEl.setStyle("display","none"),this.fire("hidden",this)):(this.hideAnim.run(),this.overlayEl&&this.overlayHideAnim.run())},temporaryShow:function(d){this.fire("show",this);d&&this._setShowParams(d);this.hideAnim&&this.hideAnim.stop();this._hideAnimEvent&&this._hideAnimEvent.detach();this.overlayHideAnim&&this.overlayHideAnim.stop();this.overlayEl&&(this.overlayEl.setStyle("display","block"),this.overlayHideAnim=
this._anim({node:this.overlayEl,to:{opacity:this.params.overlay},duration:0.35,easing:a.Easing.easeOutStrong}),this.overlayHideAnim.run());this.el.setStyle("display","block");this.hideAnim=this._anim({node:this.el,to:{opacity:1},duration:0.35,easing:a.Easing.easeOutStrong});this._hideAnimEvent=this._subscribeOnce(this.hideAnim,"end",function(){this.fire("shown",this)});this.hideAnim.run();this._showChildren();this.moveIntoView()},_applyMethodToChildren:function(){var d=arguments[0],b=Array.prototype.slice.call(arguments,
1);a.Array.each(this.childDialogs,function(a){a[d].apply(a,b)},this)},_showChildren:function(){this._applyMethodToChildren("temporaryShow")},_hideChildren:function(){this._applyMethodToChildren("temporaryHide")},cancelChildDialogs:function(){this._applyMethodToChildren("cancel");this.childDialogs=[]},isVisible:function(){return!this._isState("CLOSED")},_updatePosition:function(d){if(this.el&&this.anchorEl){var b=this.el.get("offsetHeight"),c=this.params.flyoutPointerDirection;if(!("top"===c||"bottom"===
c)){if("centered"===c){var e=this.anchorEl.getXY();this.position=new a.Squarespace.Position({x:e[0]+(this.anchorEl.get("offsetWidth")-this.params.width)/2,y:e[1]+(this.anchorEl.get("offsetHeight")-b)/2,w:this.params.width,h:b});this.position.nudgeFix()}else this.position=new a.Squarespace.Position({avoidElX:this.anchorEl,avoidElY:this.anchorEl,xdir:"right",ydir:"bottom",x:this.anchorEl.getX(),y:this.anchorEl.getY(),xo:2,yo:0,w:this.params.width+this.NOTCH_HEIGHT,h:b}),this.position.reflectFix();"hidden"!==
c&&"centered"!==c&&this._reattachNotchEl();d&&(this.el.setXY(this.position.getXY()),this._alignNotch(this.anchorEl))}}},_reattachNotchEl:function(){var a="right"===this.position.xdir?"left":"right";this.notchEl?(this.notchEl.set("className","flyout-notch-"+a),this.notchEl.inDoc()&&this.notchEl.remove()):this._initNotchEl(a);"right"===this.position.xdir?this.el.insertBefore(this.notchEl,this.mainEl):this.el.append(this.notchEl)},_initNotchEl:function(d,b){this.notchEl=a.Node.create('<div class="flyout-notch-'+
d+'">&nbsp;</div>');a.Lang.isString(b)&&this.notchEl.addClass(b)},_alignNotch:function(a){if(this.notchEl){var b=this.el.get("offsetHeight"),b=Math.max(b-36,220),c=12,e=this.el.get("region");a=a.get("region");var f=a.top+a.height/2;a.top>e.top&&(c=f-e.top-11,c=Math.min(b,Math.max(12,c)));this.notchEl.setStyle("marginTop",c+"px")}},onDataChange:function(a){this.fire("render-anchor",this.getData());this.setEdited();this._debug.log("onDataChange");this.fire("datachanged")},onOverlayClick:function(a){a.halt();
this.fire("overlay-click");this.params.disableOverlayCancel||this.close()},setEdited:function(){this._isState("SAVING")||(this.params.discardChangesConfirmation&&!this._onBeforeUnloadEvt&&(this._onBeforeUnloadEvt=a.on("beforeunload",function(a){this.isVisible()&&(a.returnValue="You have unsaved changes.")},this)),this._setEdited(!0))},clearEdited:function(){this._onBeforeUnloadEvt&&this._onBeforeUnloadEvt.detach();this._setEdited(!1)},_setEdited:function(a){this.edited=!!a;this.editedSinceLastSave=
!!a},getEditedSinceLastSave:function(){return this.editedSinceLastSave},getNextTabIndex:function(){return this.lastTabIndex++},getEdited:function(){return this.edited},isState:function(a){return this.getState()===a},getState:function(){return this.state},setInitialData:function(d){this.params.initialData=this.params.initialDataByReference?d:a.clone(d,!0);this.fields&&a.Object.each(this.fields,function(b,c){this._isDialogField2(b)&&(b.get("name")&&!a.Lang.isUndefined(this.params.initialData[b.get("name")]))&&
(b.set("data",this.params.initialData[b.get("name")],{source:"setInitialData"}),b.setCurrentDataAsInitial())},this)},getBodyHeight:function(){return this.params.height?this.params.height:this._getFullHeight()},setActiveFlyout:function(d){this.activeFlyout&&this.activeFlyout.field.closeFlyout();a.later(10,this,function(){this.activeFlyout=d})},clearActiveFlyout:function(){this.activeFlyout=null},onResize:function(d){if(!this.params.embedWithinEl){d=a.one(document).get("winWidth");a.one(document).get("winHeight");
if(!this.anchorEl&&!this.params.draggable){var b={};if("full"==this.params.verticalHeight||"fit"==this.params.verticalHeight)this.bodyHeight=this.getBodyHeight(),"fit"==this.params.verticalHeight&&this.bodyHeight>this.observedHeight&&(this.bodyHeight=this.observedHeight),this.bodyEl.setStyle("height",this.bodyHeight+"px"),this.bodyEl.all(".scrollable-body").each(function(a){a.setStyles({height:this.bodyHeight-30+"px",paddingBottom:"30px"})},this),this.resizeVerticalFields();"right"!==this.params.position&&
(this.hideErrors(),b.left=(d-this.params.width)/2,b.top=this.params.top,this.params.left&&(b.left=this.params.left));this.currentXY=[b.left,b.top];this.moveAnim&&this.moveAnim.stop();this.moveAnim=this._anim({node:this.el,to:b,duration:0.15,easing:a.Easing.easeOutStrong});this.moveAnim.run()}this.moveIntoView()}},moveIntoView:function(d){if(this.params.draggable){d&&(!this.anchorEl&&!this.position)&&(d=!1);var b={},c=this.el.get("docScrollX"),e=this.el.get("docScrollY"),f=this.el.get("winWidth")+
c,g=this.el.get("winHeight"),h=g+e,k=this.el.getY(),m=this.el.getX();k<e&&(b.top=e);k+this.el.get("offsetHeight")>h&&(b.top=h-this.el.get("offsetHeight"));m+this.el.get("offsetWidth")>f&&(b.left=f-this.el.get("offsetWidth"));m<c&&(b.left=c);d&&(b.top=b.top?Math.max(b.top,this.position.getY()):this.position.getY());"fixed"===this.params.forcePosition&&(a.Lang.isValue(b.top)&&b.top>this.el.get("winHeight"))&&(b.top=Math.max(0,g-this.el.get("offsetHeight")));0!==a.Object.size(b)&&this._anim({node:this.el,
to:b,duration:0.3,easing:a.Easing.easeOutStrong}).run();this.preferredHeight+120>g?(this.bodyHeight=g-120,this.bodyEl.setHeight(this.bodyHeight)):this.bodyHeight!=this.preferredHeight&&(this.bodyHeight=this.preferredHeight,this.bodyEl.setHeight(this.preferredHeight))}},scrollIntoView:function(a){this.el.scrollIntoView(a)},showErrors:function(d){this.fire("show-errors",d);this.allowEditing();this.currentErrors=d;this.errorCount=a.Object.size(d);this.errorsByTab={};a.Object.each(d,function(a,c){var e=
this.getField(c);e||console.error("Server error returned for a missing dialog field: "+c);e.tab.tabNavigationObj&&e.tab.tabNavigationObj.addClass("error");this.errorsByTab[e.tab.name]?this.errorsByTab[e.tab.name]++:this.errorsByTab[e.tab.name]=1},this);this.activateErrors()},clearError:function(a){this.currentErrors&&this.currentErrors[a.getName()]&&(this.errorsByTab[a.tab.name]--,delete this.currentErrors[a.getName()],this.errorCount--,a.tab.tabNavigationObj&&0===this.errorsByTab[a.tab.name]&&a.tab.tabNavigationObj.removeClass("error"))},
activateErrors:function(){if(this.errorCount){var d=null;a.Array.each(this.currentTab.tabFields,function(a){this.currentErrors[a.getName()]&&(d||(d=a,d.scrollIntoView()),a.showError(this.currentErrors[a.getName()]))},this);d&&a.Lang.isFunction(d.focus)&&d.focus()}},hideErrors:function(){this.currentTab&&a.Array.each(this.currentTab.tabFields||[],function(d){a.Lang.isFunction(d.hideError)&&d.hideError()},this)},updateTitle:function(d){var b=this.params.tabs[this.currentTabIndex];b&&(this.currentTab&&
b.title!=this.currentTab.title)&&(this.currentTab.title=b.title);a.Lang.isUndefined(d)&&(d=this.state);var b=this.currentTab&&this.currentTab.title?this.currentTab.title:this.params.title,c="";this.params.subtext&&(c='<div class="title-subtext">'+this.params.subtext+"</div>");switch(d){case a.Squarespace.DialogStates.LOADING:this.params.loadingText&&this.setTitleHtml('<div class="title-text">'+this.params.loadingText+"</div>"+c);break;case a.Squarespace.DialogStates.EDITING:b&&this.setTitleHtml('<div class="title-text">'+
b+"</div>"+c);break;case a.Squarespace.DialogStates.SAVING:this.params.savingText&&this.setTitleHtml('<div class="title-text">'+this.params.savingText+"</div>"+c)}},setTitleHtml:function(a){this.titleTextEl.setHTML(a)},setData:function(d){a.Array.each(this.currentTab.tabFields,function(b,c){if(b.setValue){var e=d[b.getName()];b.setValue(a.Lang.isValue(e)?e:null);this.fire("datachange",b)}},this)},focusTab:function(){this.currentTab&&(this.fire("tab-focused",{tabName:this.currentTab.name}),a.Array.some(this.currentTab.tabFields,
function(a,b){var c=!(!a.setValue||!a.focus),e=this._isDialogField2(a),f=!(!e||!a.get("focusable"));if(c&&!e||f)return a.focus(),!0},this))},_getFullHeight:function(){return a.one(document).get("winHeight")-2*this.params.edgeMargin-this.controlsHeight-this.titleEl.get("offsetHeight")},dataReady:function(){var d;this.clearEdited();this._setState("EDITING");this.titleEl.removeClass("loading");this.params.initialData||(this.params.initialData={});this.bodyHeight=this.params.height;this.controlsHeight=
"standard"===this.params.style?65:60;if("full"===this.params.verticalHeight||"fit"===this.params.verticalHeight)this.bodyHeight=this._getFullHeight();this.preferredHeight=this.bodyHeight;this.bodyEl.setStyle("width",this.params.width+"px");this.params.overlay&&!this.params.doNotDisableBodyScroll&&this.disableBodyScroll();if(this.moving){this.moving=!1;this.updateTitle();if(this.definitionChanged)this.definitionChanged=!1,this.destroyBody(),this.destroyButtons(),this.render(),d=this._anim({node:this.bodyEl,
duration:0.25,easing:a.Easing.easeOutStrong,to:{height:this.bodyHeight}}),d.on("end",function(){this.fire("ready")},this),d.run();else{if(this.rendered)this.setData(this.params.initialData),this.params.autoFocus&&this.focusTab();else this.once("rendered",function(){this.setData(this.params.initialData);this.params.autoFocus&&this.focusTab()},this);this.fire("ready")}this.clearEdited()}else if(this.currentTabIndex=0,this.currentTab=this.params.tabs[0],this.updateTitle(),this.params.loadingState)d=
this._anim({node:this.el,to:{opacity:1},duration:0.15,easing:a.Easing.easeOutStrong}),d.run(),this.controlsEl&&(d=this._anim({node:this.controlsEl,to:{height:this.controlsHeight},duration:0.15,easing:a.Easing.easeOutStrong}),d.run()),d=this._anim({node:this.bodyEl,to:{height:this.bodyHeight},duration:0.25,easing:a.Easing.easeOutStrong}),d.on("end",function(){this.render();this.fire("ready")},this),d.run();else{this.render();var b=this,c=function(){b.el&&b.el.setStyle("transform",null)};switch(this.params.showAnim){case "custom":this.params.customShowAnim(this.el,
function(){b.fire("ready")});break;case "slideDownUp":this.el.setStyles({marginTop:-this.el.height()+"px"});d=this.el.anim({marginTop:0},{duration:0.3});d.on("end",function(){b.fire("ready")});d.run();break;case "fade":this.el.transition({opacity:{duration:0.2,value:1},easing:"ease-out"},function(){b.fire("ready");c()});break;case "noshow":this.el.setStyles({display:"none"});b.fire("ready");break;default:JSTween.tween(this.el.getDOMNode(),{transform:{start:"scale(0.97)",stop:"scale(1)",time:0,duration:0.3,
effect:"easeOut",onStop:a.bind(function(){b.fire("ready");c()},this)},opacity:{start:0,stop:100,time:0,duration:0.3,effect:"easeOut"}})}}this.currentData=this.params.initialData;JSTween.play()},containsNode:function(a){return this.bodyEl&&this.bodyEl.contains(a)},activateTab:function(d,b){this.hideErrors();var c=b?b:a.DB.unpackData(d.target),e=parseInt(c.index,10);this.currentTab||(this.currentTab=c);a.Array.each(this.params.tabs,function(a,b){a.tabNavigationObj.toggleClass("active",b===e);b===e&&
this._showPanelByIndex(e)},this)},_showField:function(a){(this._isDialogField2(a)&&a.get("visible")||!this._isDialogField2(a)&&!a.config.hidden)&&a.show(!0)},_showPanelByIndex:function(d){if(d!=this.currentTabIndex){var b,c=a.Easing.easeBothStrong,e=this.params.tabs[d],f=this.params.tabs[this.currentTabIndex];this.params.noTabAnim||(e.tabPanelObj.animation&&e.tabPanelObj.animation.stop(!0),f.tabPanelObj.animation&&f.tabPanelObj.animation.stop(!0));b=f.tabFields;this.params.noTabAnim?(f.tabPanelObj.setStyles({opacity:1,
zIndex:"300"}),f.tabPanelObj.addClass("hidden")):(e.tabPanelObj.setStyles({left:(e.index>f.index?1:-1)*this.params.width+"px",opacity:1,zIndex:"300"}),f.tabPanelObj.setStyle("zIndex","0"),b=this._anim({node:f.tabPanelObj,to:{left:(e.index<f.index?1:-1)*this.params.width+"px"},duration:0.5,easing:c}),b.on("end",function(){this.tab.addClass("hidden")},{tab:f.tabPanelObj}),b.run(),f.tabPanelObj.animation=b);this.currentTab=e;this.currentTabIndex=d;this.updateTitle();e.tabPanelObj.removeClass("hidden");
this.params.noTabAnim?(b=this.currentTab.tabFields,a.Array.forEach(b,function(a){this._showField(a)},this),this.focusTab(),this.activateErrors()):(b=this._anim({node:e.tabPanelObj,to:{left:0},duration:0.5,easing:c}),b.on("end",function(){a.Array.forEach(this.currentTab.tabFields,function(a){this._showField(a)},this);this.focusTab();this.activateErrors()},this),b.run(),e.tabPanelObj.animation=b);this.currentTab.height&&(this.currentTab.tabPanelObj.setStyle("height",f.height-50),this._anim({node:this.bodyEl,
to:{height:this.currentTab.height},duration:0.5,easing:c}).run());this.bodyEl.toggleClass("scrollable",!!this.currentTab.scroll);this.currentTab.scroll?this.bodyEl.plug(a.Squarespace.Plugin.ScrollLock):this.bodyEl.unplug(a.Squarespace.Plugin.ScrollLock);this.fire("tab-shown",{name:this.currentTab.name,title:this.currentTab.title})}},render:function(){var d;this.rendered||(this.observedHeight=0,this.tabs=[],this.tabsEl.setContent(""),a.Array.each(this.params.tabs,function(b,c){d=a.DB.A("configuration-container-tab "+
(0===c?"active":""),{href:"javascript:noop();",data:{index:c},html:this.params.tabs[c].tabTitle});1<this.params.tabs.length&&(this.params.tabs[c].noTabTitle&&d.addClass("noTabTitle"),this.bodyEvents.push(d.on("click",function(a){a.preventDefault();this.activateTab.apply(this,arguments)},this)),this.tabsEl.append(d));this.params.tabs[c].tabNavigationObj=d;this.params.tabs[c].index=c;this.renderTab(this.params.tabs[c],0==c)},this),this.renderButtons(),this.bodyHeight||(this.preferredHeight=this.bodyHeight=
this.observedHeight+14),"fit"==this.params.verticalHeight&&this.bodyHeight>this.observedHeight&&(this.bodyHeight=this.observedHeight),this.fire("rendered"),this.rendered=!0,(this.params.embedWithinEl&&this.params.height||!this.params.embedWithinEl)&&this.bodyEl.setStyle("height",this.bodyHeight+"px"),this.controlsEl&&this.controlsEl.setStyle("height",this.controlsHeight+"px"),this._updatePosition(!0),this.params.autoFocus&&this.focusTab())},getButtons:function(){return this.params.buttons},setButtons:function(){var d=
arguments;1===arguments.length&&a.Lang.isArray(arguments[0])&&(d=arguments[0]);this.params.buttons=[];this.destroyButtons();d.forEach(function(a){this.params.buttons.push(a)},this);this.isVisible()&&this.renderButtons()},_removeButton:function(d){var b=a.Array.filter(this.getButtons(),function(a,b){return a!==d&&a.type!==d},this);this.setButtons(b)},_getNextTabIndex:function(){return this.BUTTONS_BASE_IDX+this.lastTabIndex++},_disableButton:function(a){a.addClass("disabled").one("input").set("disabled",
"disabled")},renderButtons:function(){this.saveAndCloseButton=a.DB.INPUT("saveAndClose",{tabIndex:this._getNextTabIndex(),type:"button",value:"Save & Close"});this.saveButton=a.DB.INPUT("save",{tabIndex:this._getNextTabIndex(),type:"button",value:"Save"});this.cancelButton=a.DB.A("cancel",{tabIndex:this._getNextTabIndex(),href:"javascript:noop();",html:"Cancel"});this.removeButton=a.DB.INPUT("remove",{tabIndex:this._getNextTabIndex(),type:"button",value:"Remove"});this.buttonEvents.push(a.on("click",
function(a){a.halt();this._getButtonClickHandler("saveAndClose",this.saveAndClose)(a)},this.saveAndCloseButton,this),a.on("click",this._getButtonClickHandler("save",this.save),this.saveButton),a.on("click",this._getButtonClickHandler("remove",this.remove),this.removeButton),a.on("click",this._getButtonClickHandler("close",this.close),this.cancelButton),a.on("click",this._getButtonClickHandler("cancel",this.cancelClick),this.cancelButton));var d,b=a.clone(this.params.buttons);i=this.params.buttons.length;
for(0<i&&a.Squarespace.Utils.isDamaskEnabled()&&b.reverse();0<=--i;){var c;if(d=b[i]){switch(d.type){case "cancel":this.cancelButton.set("innerHTML",d.title);c=a.Node.create('<div class="cancel-block"></div>');c.append(this.cancelButton);break;case "save":this.saveButton.set("value",d.title);c=a.Node.create('<div class="button-block"></div>');c.append(this.saveButton);break;case "remove":this.removeButton.set("value",d.title);c=a.Node.create('<div class="button-block"></div>');c.append(this.removeButton);
break;case "saveAndClose":this.saveAndCloseButton.set("value",d.title);c=a.Node.create('<div class="button-block"></div>');c.append(this.saveAndCloseButton);break;default:var e;"text"===d.style?(e=a.DB.A({href:"javascript:noop();",html:d.title}),c=a.Node.create('<div class="cancel-block"></div>')):(e=a.DB.INPUT(d.className?d.className:"",{type:"button",value:d.title}),c=a.Node.create('<div class="button-block"></div>'));c.append(e);this.publish("button-"+d.type,{emitFacade:!0,prefix:"EditingDialog",
broadcast:2});this.buttonEvents.push(a.on("click",this._getButtonClickHandler(d.type),e))}this.buttonHolder.append(c);d.disabled&&this._disableButton(c)}}},cancelClick:function(a){this.fire("cancel-click")},_getButtonClickHandler:function(d,b){return a.bind(function(c){this.fire("button-"+d)?a.Lang.isFunction(b)&&b.call(this,c):c.halt();this.fire("button-click",{type:d})},this)},_isOverlayAnimationRunning:function(){return a.Lang.isValue(this.saveOverlayAnimationManager)&&this.saveOverlayAnimationManager.isRunning()},
showSaveOverlay:function(d){this.fire("show-save-overlay");if(!this.params.disableSaveOverlay){this._isOverlayAnimationRunning()&&this.saveOverlayAnimationManager.stop(!0);this.saveOverlay&&this.saveOverlay.remove();var b=this.titleEl.get("offsetHeight");this.saveOverlay=a.Node.create('<div class="save-overlay">&nbsp;</div>');this.saveOverlay.setStyles({height:this.mainEl.get("offsetHeight")-b-10+"px",marginTop:b+5+"px",width:this.bodyEl.get("offsetWidth")+"px"});this.mainEl.append(this.saveOverlay);
d&&this.titleEl.addClass("save-overlay-active");this.saveOverlayAnimationManager=new a.Squarespace.AnimationManager;this.saveOverlayAnimationManager.push(this._anim({node:this.tabsEl,to:{opacity:0},duration:0.25,easing:a.Easing.easeOutStrong}));this.saveOverlayAnimationManager.push(this._anim({node:this.saveOverlay,to:{opacity:0.8},duration:0.25,easing:a.Easing.easeOutStrong}));this.autosaveEl&&this.saveOverlayAnimationManager.push(this._anim({node:this.autosaveEl,to:{opacity:0},duration:0.25,easing:a.Easing.easeOutStrong}));
"transparent"!==this.params.style&&(this.saveOverlayAnimationManager.push(this._anim({node:this.titleEl,to:{opacity:1},duration:0.25,easing:a.Easing.easeOutStrong})),this.controlsEl&&this.saveOverlayAnimationManager.push(this._anim({node:this.controlsEl.get("firstChild"),to:{opacity:0},duration:0.25,easing:a.Easing.easeOutStrong})));this.saveOverlayAnimationManager.on("end",function(){this.fire("save-overlay-shown")},this);this.saveOverlayAnimationManager.run()}},hideSaveOverlay:function(){this.saveOverlay?
(this.fire("hide-save-overlay"),this.titleEl.removeClass("save-overlay-active"),this._isOverlayAnimationRunning()&&this.saveOverlayAnimationManager.stop(!0),this.saveOverlayAnimationManager=new a.Squarespace.AnimationManager,this.saveOverlayAnimationManager.push(this._anim({node:this.saveOverlay,to:{opacity:0},duration:0.25,easing:a.Easing.easeOutStrong})),this.saveOverlayAnimationManager.push(this._anim({node:this.tabsEl,to:{opacity:1},duration:0.25,easing:a.Easing.easeOutStrong})),this.saveOverlayAnimationManager.on("end",
function(){this.saveOverlay.remove();this.fire("save-overlay-hidden");this._setState("EDITING");this.updateTitle()},this),this.saveOverlayAnimationManager.run()):this._setState("EDITING")},allowEditing:function(){this.hideSaveOverlay();this.clearEdited();this.fire("editing-allowed");this._setState("EDITING")},save:function(){this._showLocalErrors()||(this._debug.log("save"),this.closeOnSend=!1,this._saveData())},_showLocalErrors:function(){this.hideErrors();var d=function(a){return a.inActiveFrame},
b=this.currentTab,c=function(a){return a.inActiveFrame&&a.tab.name===b.name},e=a.Object.values(this.fields),e=this.params.validateActiveTabOnly?e.filter(c,this):e.filter(d,this),f=!1,g={};a.Array.map(e,function(a){return{field:a,errors:a.getErrors()}}).forEach(function(a){var b=a.errors;b[b.length-1]&&(g[a.field.getName()]=b[b.length-1],f=!0)},this);f&&this.showErrors(g);return f},saveAndShow:function(){this._showLocalErrors()||(this._debug.log("saveAndShow"),this.closeOnSend=!1,this._saveData(),
this.show())},saveAndClose:function(){this._showLocalErrors()||(this.fire("preClose"),this._debug.log("saveAndClose"),this.params.closeable&&(this.closeOnSend=!0),this._saveData())},_saveData:function(){this._debug.log("_saveData");this._isState("SAVING")?this._debug.log("_saveData","Exiting because dialog state is in SAVING"):(this.clearEdited(),this.hideErrors(),this._setState("SAVING"),this.updateTitle(),this.showSaveOverlay(),this._debug.log("_saveData","fire","send-requested"),this.fire("send-requested"))},
remove:function(a){a&&a.halt();this.fire("remove-requested")},canClose:function(d,b){if(!this._shown)return console.log("not yet shown!"),!1;if(!a.Array.every(this.childDialogs,function(a){return a.canClose(this.saveAndClose,this.cancel)},this))return!1;if((this.edited||this.editedSinceLastSave)&&this.params.discardChangesConfirmation){var c=!1,e;for(e in this.fields)this.fields[e].didDataChange()&&(c=!0);if(c)return c=new a.Squarespace.Widgets.Confirmation({render:this.el.ancestor("body")||!0,style:a.Squarespace.Widgets.Confirmation.TYPE.CONFIRM_OR_REJECT,
showOverlay:!0,"strings.confirm":"Save","strings.reject":"Discard","strings.title":"Review Changes","strings.message":"You have made changes. Do you want to save or discard them?"}),c.on("confirm",function(){this.clearEdited();this._debug.log("canClose","calling onSuccess()",d);d.call(this)},this),c.on("reject",function(){this.clearEdited();this._debug.log("canClose","calling onReject()",b);b.call(this)},this),c.on("cancel",function(){a.Squarespace.EscManager.addTarget(this);this._debug.log("canClose",
"onCancel");this.fire("cancel-close")},this),this._debug.log("canClose",!1,"Showing confirmation dialog"),!1}this._debug.log("canClose",!0);return!0},close:function(a,b){this._debug.log("close",a);if(!this._isState("EDITING")&&!this._isState("SAVING"))this._debug.log("close","Exiting because state is in Editing or Saving.");else{if(b)this._debug.log("canClose skipped due to force = true");else if(!1===this.canClose(this.saveAndClose,this.cancel)){this._debug.log("close","Exiting because canClose came back false");
return}this.fire("close");this.dismiss(!0)}},cancel:function(a){this._debug.log("cancel",a);if(this._isState("EDITING")||this._isState("SAVING"))this.clearEdited(),this.fire("cancel"),this.dismiss(!1)},dismiss:function(d){d=d?a.bind(this.destroy,this):a.bind(this._finishCancelation,this);this.fire("dismiss");this._setState("CLOSING");this.updateTitle();this.clearEdited();this._preDestroy();this.hideErrors();this.params.overlay&&this.restoreBodyScroll();switch(this.params.hideAnim){case "noHideAnimation":d();
break;case "custom":this.params.customHideAnim(this.el,d);break;case "slideDownUp":var b=this._anim({node:this.el,to:{marginTop:-this.el.height()+"px"},duration:0.3,easing:a.Easing.easeOut});b.on("end",d);b.run();break;default:JSTween.tween(this.el.getDOMNode(),{transform:{start:"scale(1)",stop:"scale(0.97)",time:0,duration:0.4,effect:"easeOut",onStop:d},opacity:{start:100,stop:0,time:0,duration:0.4,effect:"easeOut"}})}this.params.overlay&&this.overlayEl&&(this.overlayEl.destroying=!0,JSTween.tween(this.overlayEl.getDOMNode(),
{opacity:{start:100*this.params.overlay,stop:0,time:0,duration:0.4,effect:"easeOut",onStop:a.bind(function(){this.overlayEl&&(this.overlayEl.remove(),this.overlayEl=null)},this)}}));JSTween.play()},_finishCancelation:function(){this.fire("render-anchor",this.getInitialData());this.destroy();this._setState("CLOSED");this.fire("canceled")},_preDestroy:function(){var d=0,b;this._preDestroyCalled=!0;d=a.Squarespace.OPEN_DIALOGS.indexOf(this);-1!==d&&a.Squarespace.OPEN_DIALOGS.splice(d,1);0===a.Squarespace.OPEN_DIALOGS.length&&
a.one(document.body).removeClass("dialog-open");this._applyMethodToChildren("close");d=0;for(b=this.timers.length;d<b;++d)this.timers[d].cancel();this.timers=[];a.Squarespace.EscManager&&a.Squarespace.EscManager.removeTarget(this);this.activeFlyout&&this.activeFlyout.field.closeFlyout();a.Squarespace.ToolTipManager&&this.params.disableTips&&a.Squarespace.ToolTipManager.enableTooltips();this.firstShowEvent&&(this.firstShowEvent.detach(),this.firstShowEvent=null);this.anchorEl&&this.anchorEl._node&&
this.anchorEl.removeClass("targeted")},getErrors:function(){var a=0,b={},c;for(c in this.fields){var e=this.fields[c],f=!1;if(f=this._isDialogField2(e)?e.get("required")&&e.isEmpty():e.config.required&&(""===e.getValue()||0===e.getValue()))b[e.getName()]="This is a required field.",a++}return{errors:a,errorSet:b}},send:function(){var a=this.getErrors(),b=a.errorSet;a.errors?(this.showErrors(b),this.fire("local-errors")):(this.closeOnSend&&(this.saved=!0,this.closeOnSend=!1,this.close()),this.fire("sent"))},
updateAutoSave:function(d,b){if(this.autosaveEl.inDoc()){this.autosaveEl.setStyle("display","block");var c=this._anim({node:this.autosaveEl,from:{opacity:1},to:{opacity:0.5},duration:0.25,easing:a.Easing.easeOutStrong});c.on("end",function(){d?this.autosaveEl.set("innerHTML",d):(this.autosaveEl.set("innerHTML",'Last saved <span class="time"></span>.'),this.autosaveEl.one(".time").plug(a.Squarespace.RelativeTimeDisplay));b?this.autosaveEl.addClass("error"):this.autosaveEl.removeClass("error");this.autosaveEl.ancestor("body")&&
this._anim({node:this.autosaveEl,from:{opacity:0.5},to:{opacity:1},duration:0.25,easing:a.Easing.easeOutStrong}).run()},this);c.run()}this.editedSinceLastSave=!1},_recordFieldData:function(d,b){a.Object.each(b.fields,function(b){if(a.Lang.isFunction(b.getValue)){var e=b.getValue();d[b.getName()]=e;if(void 0!==b.getAssociatedVars)for(var e=b.getAssociatedVars(),f=0;f<e.length;f++)d[e[f].name]=e[f].value}b.fields&&this._recordFieldData(d,b)},this)},getData:function(){var a={},b;for(b in this.params.initialData)a[b]=
this.params.initialData[b];this._recordFieldData(a,this);return a},getField:function(d){var b=this.fields[d];if(a.Lang.isValue(b))return b;for(var c in this.fields)if(this.fields[c].getField&&(b=this.fields[c].getField(d),a.Lang.isValue(b)))return b},getSection:function(a){return this.sections[a]},_renderFields:function(d,b,c,e){a.Array.each(b,function(f,g){var h;if(f){var k=f.type;!e&&!this.params.dontSetWidthOnFields&&(e=this.params.width-60);e&&!isNaN(e)&&(this._debug.log("availableWidth: ",e),
this._debug.log("fieldConfig.width: ",f.width),h=(f.ctor&&f.config?f.config.width:f.width)||1,h=1>=h?Math.floor(h*e):h);"splitter"===k?this._renderSplitter(f,g,b,d,c,e,h):"multi-frame"===k?this._renderMultiFrame(f,g,b,d,c,e,h):"section"===k?this._renderSection(f,g,b,d,c,e,h):"stack"===k?this._renderStack(f,g,b,d,c,e,h):f.ctor&&f.ctor===a.Squarespace.DialogFields.MultiFrame?this._renderDF2MultiFrame(f,g,b,d,c,e,h):this._renderField(f,g,b,d,c,e,h)}},this)},_renderSplitter:function(d,b,c,e,f,g,h){b=
a.Node.create('<div class="split-field clear '+(1<d.fields.length?"padding-adjust":"")+'"></div>');d.width||(d.width=1);g&&!isNaN(g)?(b.setStyle("width",Math.round(d.width*g)+30+"px"),g-=30*(d.fields.length-1)):g=f.get("offsetWidth")-30*(d.fields.length-1)-60;f.append(b);this._renderFields(e,d.fields,b,g);d.countHeight&&(this._takenHeight+=b.get("offsetHeight"));d.hidden&&b.hide()},_renderMultiFrame:function(d,b,c,e,f,g,h){b=new a.Squarespace.DialogFieldGenerators[d.type](d,this.params.initialData,
this);b.type=d.type;b.append(e,c,f,g);b.getName()?this.fields[b.getName()]=b:this._noNameFields.push(b)},_renderDF2MultiFrame:function(d,b,c,e,f,g,h){b=a.merge(d,d.config,{dialog:this,data:this.params.initialData[d.config.name],render:f});d=new d.ctor(b);g&&d.get("boundingBox").setStyle("width",h+"px");(g=d.getName()||d.get("name"))?this.fields[g]=d:this._noNameFields.push(d);d.each(function(a){var b=a.getName()||a.get("name");b?this.fields[b]=a:this._noNameFields.push(a);e.tabFields.push(a);a.tab=
e},this)},_renderSection:function(d,b,c,e,f,g,h){b=a.Node.create('<div class="section-inner clear"></div>');c="section-field container-field-wrapper field-wrapper clear ";void 0!==d.style&&(c+=d.style);c=a.Node.create('<div class="'+c+'"></div>');c.append(b);f.append(c);d.width||(d.width=1);(f=Math.round(d.width*g))&&c.setStyle("width",f+"px");g=Math.round(d.width*g);this._renderFields(e,d.fields,b,g);d.hidden&&c.hide();d.name&&(this.sections[d.name]=c)},_renderStack:function(d,b,c,e,f,g,h){(h=g)||
(h=this.params.width-60);g=a.Node.create('<div class="stack-field stack-field-wrapper clear"></div>');f.append(g);d.width||(d.width=1);d["float"]&&g.setStyle("float",d["float"]);g.setStyle("width",Math.round(d.width*h)+"px");b!==c.length-1&&g.setStyle("paddingRight","30px");b=Math.round(d.width*h);this._renderFields(e,d.fields,g,b);d.hidden&&g.hide();d.name&&(this.sections[d.name]=g)},_renderField:function(d,b,c,e,f,g,h){var k;b=a.merge(d,d.config||{},{dialog:this,render:f});c=b.name||d.name;this._debug.isTimingEnabled()&&
this._debug.time("render field: "+c);a.Lang.isUndefined(b.data)&&(this.params.initialData&&!a.Lang.isUndefined(c))&&(b.data=this.params.initialData[c],b.panel=this);if(d.ctor)k=new d.ctor(b);else{if(!d.type)throw console.error("dialog: field type was",d.type,", and constructor was",d.ctor),console.error("dialog: config was",d),"Could not find field constructor or field type.";var m=this._convertToDialogField2Name(d.type),m=a.namespace("Squarespace.DialogFields")[m];if(!m&&!a.Squarespace.DialogFieldGenerators[d.type])throw"Unknown field type: "+
d.type;this._debug.log("Generating field type: ",d.type);m?k=new m(b):(k=new a.Squarespace.DialogFieldGenerators[d.type](d,this.params.initialData,this),k.type=d.type,k.append(f))}d.verticalSpan&&(this._verticalEl=k);d.countHeight&&!d.verticalSpan&&(k.getTakenHeight?this._takenHeight+=k.getTakenHeight():(this._takenHeight+=k.get("boundingBox").get("offsetHeight"),this._takenHeight+=parseInt(k.get("boundingBox").getStyle("marginTop"),10),this._takenHeight+=parseInt(k.get("boundingBox").getStyle("marginBottom"),
10)));g&&(this._isDialogField2(k)?(this._debug.log("setting width",h),k.get("boundingBox").setStyle("width",h+"px")):k.html&&(this._debug.log("setting width",h),k.html.setStyle("width",h+"px")));k.resize&&k.resize();d.hidden&&k.temporaryHide(!0);this._isDialogField2(k)?this.bodyEvents.push(k.on("dataStateChange",function(a){a=a.newVal;k.getProperty("DATA_STATES");this.fire("field-loading-change",{field:k,loading:a===a.LOADING})},this)):this.bodyEvents.push(k.on("loadingChange",function(a){this.fire("field-loading-change",
{field:k,loading:a.newVal})},this));k.getName()?this.fields[k.getName()]=k:this._noNameFields.push(k);e.tabFields.push(k);k.tab=e;this._debug.isTimingEnabled()&&this._debug.timeEnd("render field: "+c)},_isDialogField2:function(d){return a.Lang.isValue(d)&&a.Lang.isValue(a.Squarespace.DialogField2)&&d instanceof a.Squarespace.DialogField2},_setState:function(d){a.Lang.isValue(a.Squarespace.DialogStates[d])?this.state=a.Squarespace.DialogStates[d]:console.warn("[Dialog] Invalid state.")},_isState:function(d){return a.Lang.isString(d)?
this.state===a.Squarespace.DialogStates[d]:this.state===d},resizeVerticalFields:function(){a.Array.each(this.verticalFields,function(a,b){var c=this.getBodyHeight()-a._takenHeight;this._isDialogField2(a)?(c-=parseInt(a.get("boundingBox").getStyle("marginTop"),10),c-=parseInt(a.get("boundingBox").getStyle("marginBottom"),10),a.set("height",c)):a.setHeight(c)},this)},renderTab:function(d,b){var c=a.Node.create('<div class="tab-wrapper"></div>');a.Lang.isValue(d.name)&&c.addClass("dialog-tab-"+d.name);
c.setStyles({width:this.params.width+"px",left:b?"0px":this.params.width+"px"});this.bodyEl.append(c);d.tabFields=[];this._verticalEl=null;this._takenHeight=0;this._renderFields(d,d.fields||[],c);d.noTabTitle&&c.addClass("noTabTitle");if(this._verticalEl){var e=parseInt(c.getStyle("paddingTop"),10);isNaN(parseInt(c.getStyle("marginTop"),10))||(e+=parseInt(c.getStyle("marginTop"),10));this._takenHeight+=e;var f=this._isDialogField2(this._verticalEl);!f&&!this._verticalEl.setHeight&&console.error("No setHeight for vertical el: ",
this._verticalEl);e=this.getBodyHeight()-this._takenHeight;f?(f=this._verticalEl.get("boundingBox"),e-=parseInt(f.getStyle("marginTop"),10),e-=parseInt(f.getStyle("marginBottom"),10),this._verticalEl.set("height",e)):this._verticalEl.setHeight(e);this._verticalEl._takenHeight=this._takenHeight;this.verticalFields.push(this._verticalEl)}d.tabPanelObj=c;this.observedHeight+=c.get("offsetHeight");b&&d.tabFields&&a.Array.forEach(d.tabFields,function(a){this._showField(a)},this);this.bodyEl.toggleClass("scrollable",
!!d.scroll);b||c.addClass("hidden");return c},_convertToDialogField2Name:function(d){d=a.Squarespace.Utils.slugify(d).split("-");for(var b=d.length-1;0<=b;b--)d[b].capitalize&&(d[b]=d[b].capitalize());return d.join("")+"Field"},_destroyFields:function(){this.fields&&(a.Object.each(this.fields,function(a,b){a.destroy()},this),this._destroyNoNameFields());this.fields={}},_destroyNoNameFields:function(){a.Array.each(this._noNameFields,function(a){a&&a.destroy()},this);this._noNameFields=[]},destroyBody:function(){this.rendered=
!1;this._destroyFields();this._isOverlayAnimationRunning()&&this.saveOverlayAnimationManager.destroy(!0);this.bodyEl&&this.bodyEl._node&&this.bodyEl.empty();a.Array.each(this.params.tabs,function(a){a.tabPanelObj=null;a.tabNavigationObj=null;a.tabFields=null});this._detachEventArray(this.bodyEvents);this.bodyEvents=[]},_detachEventArray:function(d){a.Array.each(d,function(a){a.detach()})},destroyButtons:function(){this._detachEventArray(this.buttonEvents);this.buttonEvents=[];this.buttonHolder&&this.buttonHolder._node&&
this.buttonHolder.set("innerHTML","")},_destroy:function(){this.preDestroyCalled||this._preDestroy();this.bodyHeight=this.currentErrors=this.destroyTimer=null;this.destroyBody();this.destroyButtons();this.overlayEl&&!this.overlayEl.destroying&&(this.overlayEl.remove(),this.overlayEl=null);this._onBeforeUnloadEvt&&this._onBeforeUnloadEvt.detach();this._detachEventArray(this.globalEvents);this.dd&&(this.dd.destroy(),this.dd=null);this.globalEvents=[];this.el&&(this.el.remove(!0),this.bodyEl=this.el=
null);this.params.parentDialog&&(this.params.parentDialog.removeChildDialog(this),this.params.parentDialog=null);this._setState("CLOSED");this.anchorEl=this.position=null}});a.augment(a.Squarespace.EditingDialog,a.EventTarget)},"1.0",{requires:"anim attribute datatype-date dd json node node-event-simulate node-focusmanager squarespace-animation-manager squarespace-beforeunload squarespace-debugger squarespace-dialog-field-2 squarespace-dialog-fields squarespace-dialog-fields-generators squarespace-dombuilder squarespace-escmanager squarespace-gizmo squarespace-plugin-scroll-lock squarespace-ui-base squarespace-widgets-confirmation thirdparty-jstween transition".split(" ")});
YUI.add("dd-ddm-base",function(a,d){var b=function(){b.superclass.constructor.apply(this,arguments)};b.NAME="ddm";b.ATTRS={dragCursor:{value:"move"},clickPixelThresh:{value:3},clickTimeThresh:{value:1E3},throttleTime:{value:-1},dragMode:{value:"point",setter:function(a){this._setDragMode(a);return a}}};a.extend(b,a.Base,{_createPG:function(){},_active:null,_setDragMode:function(b){null===b&&(b=a.DD.DDM.get("dragMode"));switch(b){case 1:case "intersect":return 1;case 2:case "strict":return 2}return 0},
CSS_PREFIX:a.ClassNameManager.getClassName("dd"),_activateTargets:function(){},_drags:[],activeDrag:!1,_regDrag:function(a){if(this.getDrag(a.get("node")))return!1;this._active||this._setupListeners();this._drags.push(a);return!0},_unregDrag:function(b){var e=[];a.Array.each(this._drags,function(a){a!==b&&(e[e.length]=a)});this._drags=e},_setupListeners:function(){this._createPG();this._active=!0;var b=a.one(a.config.doc);b.on("mousemove",a.throttle(a.bind(this._docMove,this),this.get("throttleTime")));
b.on("mouseup",a.bind(this._end,this))},_start:function(){this.fire("ddm:start");this._startDrag()},_startDrag:function(){},_endDrag:function(){},_dropMove:function(){},_end:function(){this.activeDrag&&(this._shimming=!1,this._endDrag(),this.fire("ddm:end"),this.activeDrag.end.call(this.activeDrag),this.activeDrag=null)},stopDrag:function(){this.activeDrag&&this._end();return this},_shimming:!1,_docMove:function(a){this._shimming||this._move(a)},_move:function(a){this.activeDrag&&(this.activeDrag._move.call(this.activeDrag,
a),this._dropMove())},cssSizestoObject:function(a){a=a.split(" ");switch(a.length){case 1:a[1]=a[2]=a[3]=a[0];break;case 2:a[2]=a[0];a[3]=a[1];break;case 3:a[3]=a[1]}return{top:parseInt(a[0],10),right:parseInt(a[1],10),bottom:parseInt(a[2],10),left:parseInt(a[3],10)}},getDrag:function(b){var e=!1,f=a.one(b);f instanceof a.Node&&a.Array.each(this._drags,function(a){f.compareTo(a.get("node"))&&(e=a)});return e},swapPosition:function(b,e){b=a.DD.DDM.getNode(b);e=a.DD.DDM.getNode(e);var f=b.getXY(),d=
e.getXY();b.setXY(d);e.setXY(f);return b},getNode:function(b){return b instanceof a.Node?b:b=b&&b.get?a.Widget&&b instanceof a.Widget?b.get("boundingBox"):b.get("node"):a.one(b)},swapNode:function(b,e){b=a.DD.DDM.getNode(b);e=a.DD.DDM.getNode(e);var f=e.get("parentNode"),d=e.get("nextSibling");d===b?f.insertBefore(b,e):e===b.get("nextSibling")?f.insertBefore(e,b):(b.get("parentNode").replaceChild(e,b),f.insertBefore(b,d));return b}});a.namespace("DD");a.DD.DDM=new b},"3.17.2",{requires:["node","base",
"yui-throttle","classnamemanager"]});
YUI.add("dd-ddm",function(a,d){a.mix(a.DD.DDM,{_pg:null,_debugShim:!1,_activateTargets:function(){},_deactivateTargets:function(){},_startDrag:function(){this.activeDrag&&this.activeDrag.get("useShim")&&(this._shimming=!0,this._pg_activate(),this._activateTargets())},_endDrag:function(){this._pg_deactivate();this._deactivateTargets()},_pg_deactivate:function(){this._pg.setStyle("display","none")},_pg_activate:function(){this._pg||this._createPG();var a=this.activeDrag.get("activeHandle"),c="auto";
a&&(c=a.getStyle("cursor"));"auto"===c&&(c=this.get("dragCursor"));this._pg_size();this._pg.setStyles({top:0,left:0,display:"block",opacity:this._debugShim?".5":"0",cursor:c})},_pg_size:function(){if(this.activeDrag){var b=a.one("body"),c=b.get("docHeight"),b=b.get("docWidth");this._pg.setStyles({height:c+"px",width:b+"px"})}},_createPG:function(){var b=a.Node.create("<div></div>"),c=a.one("body");b.setStyles({top:"0",left:"0",position:"absolute",zIndex:"9999",overflow:"hidden",backgroundColor:"red",
display:"none",height:"5px",width:"5px"});b.set("id",a.stamp(b));b.addClass(a.DD.DDM.CSS_PREFIX+"-shim");c.prepend(b);this._pg=b;this._pg.on("mousemove",a.throttle(a.bind(this._move,this),this.get("throttleTime")));this._pg.on("mouseup",a.bind(this._end,this));b=a.one("win");a.on("window:resize",a.bind(this._pg_size,this));b.on("scroll",a.bind(this._pg_size,this))}},!0)},"3.17.2",{requires:["dd-ddm-base","event-resize"]});
YUI.add("dd-ddm-drop",function(a,d){a.mix(a.DD.DDM,{_noShim:!1,_activeShims:[],_hasActiveShim:function(){return this._noShim?!0:this._activeShims.length},_addActiveShim:function(a){this._activeShims.push(a)},_removeActiveShim:function(b){var c=[];a.Array.each(this._activeShims,function(a){a._yuid!==b._yuid&&c.push(a)});this._activeShims=c},syncActiveShims:function(b){a.later(0,this,function(b){b=b?this.targets:this._lookup();a.Array.each(b,function(a){a.sizeShim.call(a)},this)},b)},mode:0,POINT:0,
INTERSECT:1,STRICT:2,useHash:!0,activeDrop:null,validDrops:[],otherDrops:{},targets:[],_addValid:function(a){this.validDrops.push(a);return this},_removeValid:function(b){var c=[];a.Array.each(this.validDrops,function(a){a!==b&&c.push(a)});this.validDrops=c;return this},isOverTarget:function(a){if(this.activeDrag&&a){var c=this.activeDrag.mouseXY,e=this.activeDrag.get("dragMode"),f,d=a.shim;if(c&&this.activeDrag){f=this.activeDrag.region;if(e===this.STRICT)return this.activeDrag.get("dragNode").inRegion(a.region,
!0,f);if(a&&a.shim){if(e===this.INTERSECT&&this._noShim)return c=f||this.activeDrag.get("node"),a.get("node").intersect(c,a.region).inRegion;this._noShim&&(d=a.get("node"));return d.intersect({top:c[1],bottom:c[1],left:c[0],right:c[0]},a.region).inRegion}}}return!1},clearCache:function(){this.validDrops=[];this.otherDrops={};this._activeShims=[]},_activateTargets:function(){this._noShim=!0;this.clearCache();a.Array.each(this.targets,function(a){a._activateShim([]);!0===a.get("noShim")&&(this._noShim=
!1)},this);this._handleTargetOver()},getBestMatch:function(b,c){var e=null,f=0,d;a.Object.each(b,function(a){var b=this.activeDrag.get("dragNode").intersect(a.get("node"));a.region.area=b.area;b.inRegion&&b.area>f&&(f=b.area,e=a)},this);return c?(d=[],a.Object.each(b,function(a){a!==e&&d.push(a)},this),[e,d]):e},_deactivateTargets:function(){var b=[],c=this.activeDrag,e=this.activeDrop;c&&e&&this.otherDrops[e]?(c.get("dragMode")?(b=this.getBestMatch(this.otherDrops,!0),e=b[0],b=b[1]):(b=this.otherDrops,
delete b[e]),c.get("node").removeClass(this.CSS_PREFIX+"-drag-over"),e&&(e.fire("drop:hit",{drag:c,drop:e,others:b}),c.fire("drag:drophit",{drag:c,drop:e,others:b}))):c&&c.get("dragging")&&(c.get("node").removeClass(this.CSS_PREFIX+"-drag-over"),c.fire("drag:dropmiss",{pageX:c.lastXY[0],pageY:c.lastXY[1]}));this.activeDrop=null;a.Array.each(this.targets,function(a){a._deactivateShim([])},this)},_dropMove:function(){this._hasActiveShim()?this._handleTargetOver():a.Object.each(this.otherDrops,function(a){a._handleOut.apply(a,
[])})},_lookup:function(){if(!this.useHash||this._noShim)return this.validDrops;var b=[];a.Array.each(this.validDrops,function(a){a.shim&&a.shim.inViewportRegion(!1,a.region)&&b.push(a)});return b},_handleTargetOver:function(){var b=this._lookup();a.Array.each(b,function(a){a._handleTargetOver.call(a)},this)},_regTarget:function(a){this.targets.push(a)},_unregTarget:function(b){var c=[],e;a.Array.each(this.targets,function(a){a!==b&&c.push(a)},this);this.targets=c;e=[];a.Array.each(this.validDrops,
function(a){a!==b&&e.push(a)});this.validDrops=e},getDrop:function(b){var c=!1,e=a.one(b);e instanceof a.Node&&a.Array.each(this.targets,function(a){e.compareTo(a.get("node"))&&(c=a)});return c}},!0)},"3.17.2",{requires:["dd-ddm"]});
YUI.add("dd-drag",function(a,d){var b=a.DD.DDM,c=function(e){this._lazyAddAttrs=!1;c.superclass.constructor.apply(this,arguments);b._regDrag(this)||a.error("Failed to register node, already in use: "+e.node)};c.NAME="drag";c.START_EVENT="mousedown";c.ATTRS={node:{setter:function(b){if(this._canDrag(b))return b;var c=a.one(b);c||a.error("DD.Drag: Invalid Node Given: "+b);return c}},dragNode:{setter:function(b){if(this._canDrag(b))return b;var c=a.one(b);c||a.error("DD.Drag: Invalid dragNode Given: "+
b);return c}},offsetNode:{value:!0},startCentered:{value:!1},clickPixelThresh:{value:b.get("clickPixelThresh")},clickTimeThresh:{value:b.get("clickTimeThresh")},lock:{value:!1,setter:function(a){a?this.get("node").addClass(b.CSS_PREFIX+"-locked"):this.get("node").removeClass(b.CSS_PREFIX+"-locked");return a}},data:{value:!1},move:{value:!0},useShim:{value:!0},activeHandle:{value:!1},primaryButtonOnly:{value:!0},dragging:{value:!1},parent:{value:!1},target:{value:!1,setter:function(a){this._handleTarget(a);
return a}},dragMode:{value:null,setter:function(a){return b._setDragMode(a)}},groups:{value:["default"],getter:function(){return!this._groups?(this._groups={},[]):a.Object.keys(this._groups)},setter:function(b){this._groups=a.Array.hash(b);return b}},handles:{value:null,setter:function(b){b?(this._handles={},a.Array.each(b,function(b){var e=b;if(b instanceof a.Node||b instanceof a.NodeList)e=b._yuid;this._handles[e]=b},this)):this._handles=null;return b}},bubbles:{setter:function(a){this.addTarget(a);
return a}},haltDown:{value:!0}};a.extend(c,a.Base,{_canDrag:function(a){return a&&a.setXY&&a.getXY&&a.test&&a.contains?!0:!1},_bubbleTargets:a.DD.DDM,addToGroup:function(a){this._groups[a]=!0;b._activateTargets();return this},removeFromGroup:function(a){delete this._groups[a];b._activateTargets();return this},target:null,_handleTarget:function(e){a.DD.Drop&&(!1===e?this.target&&(b._unregTarget(this.target),this.target=null):(a.Lang.isObject(e)||(e={}),e.bubbleTargets=e.bubbleTargets||this.getTargets(),
e.node=this.get("node"),e.groups=e.groups||this.get("groups"),this.target=new a.DD.Drop(e)))},_groups:null,_createEvents:function(){this.publish("drag:mouseDown",{defaultFn:this._defMouseDownFn,queuable:!1,emitFacade:!0,bubbles:!0,prefix:"drag"});this.publish("drag:align",{defaultFn:this._defAlignFn,queuable:!1,emitFacade:!0,bubbles:!0,prefix:"drag"});this.publish("drag:drag",{defaultFn:this._defDragFn,queuable:!1,emitFacade:!0,bubbles:!0,prefix:"drag"});this.publish("drag:end",{defaultFn:this._defEndFn,
preventedFn:this._prevEndFn,queuable:!1,emitFacade:!0,bubbles:!0,prefix:"drag"});a.Array.each("drag:afterMouseDown drag:removeHandle drag:addHandle drag:removeInvalid drag:addInvalid drag:start drag:drophit drag:dropmiss drag:over drag:enter drag:exit".split(" "),function(a){this.publish(a,{type:a,emitFacade:!0,bubbles:!0,preventable:!1,queuable:!1,prefix:"drag"})},this)},_ev_md:null,_startTime:null,_endTime:null,_handles:null,_invalids:null,_invalidsDefault:{textarea:!0,input:!0,a:!0,button:!0,select:!0},
_dragThreshMet:null,_fromTimeout:null,_clickTimeout:null,deltaXY:null,startXY:null,nodeXY:null,lastXY:null,actXY:null,realXY:null,mouseXY:null,region:null,_handleMouseUp:function(){this.fire("drag:mouseup");this._fixIEMouseUp();b.activeDrag&&b._end()},_fixDragStart:function(a){this.validClick(a)&&a.preventDefault()},_ieSelectFix:function(){return!1},_ieSelectBack:null,_fixIEMouseDown:function(){a.UA.ie&&(this._ieSelectBack=a.config.doc.body.onselectstart,a.config.doc.body.onselectstart=this._ieSelectFix)},
_fixIEMouseUp:function(){a.UA.ie&&(a.config.doc.body.onselectstart=this._ieSelectBack)},_handleMouseDownEvent:function(a){this.validClick(a)&&a.preventDefault();this.fire("drag:mouseDown",{ev:a})},_defMouseDownFn:function(e){e=e.ev;this._dragThreshMet=!1;this._ev_md=e;if(this.get("primaryButtonOnly")&&1<e.button)return!1;this.validClick(e)&&(this._fixIEMouseDown(e),0!==c.START_EVENT.indexOf("gesture")&&(this.get("haltDown")?e.halt():e.preventDefault()),this._setStartPosition([e.pageX,e.pageY]),b.activeDrag=
this,this._clickTimeout=a.later(this.get("clickTimeThresh"),this,this._timeoutCheck));this.fire("drag:afterMouseDown",{ev:e})},validClick:function(b){var c=!1,d=!1,h=b.target,k=null,m=d=null,l=!1;if(this._handles)a.Object.each(this._handles,function(b,e){b instanceof a.Node||b instanceof a.NodeList?c||(m=b,m instanceof a.Node&&(m=new a.NodeList(b._node)),m.each(function(a){a.contains(h)&&(c=!0)})):a.Lang.isString(e)&&(h.test(e+", "+e+" *")&&!k)&&(k=e,c=!0)});else if(d=this.get("node"),d.contains(h)||
d.compareTo(h))c=!0;c&&this._invalids&&a.Object.each(this._invalids,function(b,e){a.Lang.isString(e)&&h.test(e+", "+e+" *")&&(c=!1)});c&&(k?(d=b.currentTarget.all(k),l=!1,d.each(function(a){if((a.contains(h)||a.compareTo(h))&&!l)l=!0,this.set("activeHandle",a)},this)):this.set("activeHandle",this.get("node")));return c},_setStartPosition:function(a){this.startXY=a;this.nodeXY=this.lastXY=this.realXY=this.get("node").getXY();this.get("offsetNode")?this.deltaXY=[this.startXY[0]-this.nodeXY[0],this.startXY[1]-
this.nodeXY[1]]:this.deltaXY=[0,0]},_timeoutCheck:function(){!this.get("lock")&&(!this._dragThreshMet&&this._ev_md)&&(this._fromTimeout=this._dragThreshMet=!0,this.start(),this._alignNode([this._ev_md.pageX,this._ev_md.pageY],!0))},removeHandle:function(b){var c=b;if(b instanceof a.Node||b instanceof a.NodeList)c=b._yuid;this._handles[c]&&(delete this._handles[c],this.fire("drag:removeHandle",{handle:b}));return this},addHandle:function(b){this._handles||(this._handles={});var c=b;if(b instanceof
a.Node||b instanceof a.NodeList)c=b._yuid;this._handles[c]=b;this.fire("drag:addHandle",{handle:b});return this},removeInvalid:function(a){this._invalids[a]&&(this._invalids[a]=null,delete this._invalids[a],this.fire("drag:removeInvalid",{handle:a}));return this},addInvalid:function(b){a.Lang.isString(b)&&(this._invalids[b]=!0,this.fire("drag:addInvalid",{handle:b}));return this},initializer:function(){this.get("node").dd=this;if(!this.get("node").get("id")){var b=a.stamp(this.get("node"));this.get("node").set("id",
b)}this.actXY=[];this._invalids=a.clone(this._invalidsDefault,!0);this._createEvents();this.get("dragNode")||this.set("dragNode",this.get("node"));this.on("initializedChange",a.bind(this._prep,this));this.set("groups",this.get("groups"))},_prep:function(){this._dragThreshMet=!1;var e=this.get("node");e.addClass(b.CSS_PREFIX+"-draggable");e.on(c.START_EVENT,a.bind(this._handleMouseDownEvent,this));e.on("mouseup",a.bind(this._handleMouseUp,this));e.on("dragstart",a.bind(this._fixDragStart,this))},_unprep:function(){var a=
this.get("node");a.removeClass(b.CSS_PREFIX+"-draggable");a.detachAll("mouseup");a.detachAll("dragstart");a.detachAll(c.START_EVENT);this.mouseXY=[];this.deltaXY=[0,0];this.startXY=[];this.nodeXY=[];this.lastXY=[];this.actXY=[];this.realXY=[]},start:function(){if(!this.get("lock")&&!this.get("dragging")){var a=this.get("node"),c,d;this._startTime=(new Date).getTime();b._start();a.addClass(b.CSS_PREFIX+"-dragging");this.fire("drag:start",{pageX:this.nodeXY[0],pageY:this.nodeXY[1],startTime:this._startTime});
a=this.get("dragNode");d=this.nodeXY;c=a.get("offsetWidth");a=a.get("offsetHeight");this.get("startCentered")&&this._setStartPosition([d[0]+c/2,d[1]+a/2]);this.region={0:d[0],1:d[1],area:0,top:d[1],right:d[0]+c,bottom:d[1]+a,left:d[0]};this.set("dragging",!0)}return this},end:function(){this._endTime=(new Date).getTime();this._clickTimeout&&this._clickTimeout.cancel();this._dragThreshMet=this._fromTimeout=!1;!this.get("lock")&&this.get("dragging")&&this.fire("drag:end",{pageX:this.lastXY[0],pageY:this.lastXY[1],
startTime:this._startTime,endTime:this._endTime});this.get("node").removeClass(b.CSS_PREFIX+"-dragging");this.set("dragging",!1);this.deltaXY=[0,0];return this},_defEndFn:function(){this._fixIEMouseUp();this._ev_md=null},_prevEndFn:function(){this._fixIEMouseUp();this.get("dragNode").setXY(this.nodeXY);this.region=this._ev_md=null},_align:function(a){this.fire("drag:align",{pageX:a[0],pageY:a[1]})},_defAlignFn:function(a){this.actXY=[a.pageX-this.deltaXY[0],a.pageY-this.deltaXY[1]]},_alignNode:function(a,
b){this._align(a);b||this._moveNode()},_moveNode:function(a){var b=[],c=[],d=this.nodeXY,k=this.actXY;b[0]=k[0]-this.lastXY[0];b[1]=k[1]-this.lastXY[1];c[0]=k[0]-this.nodeXY[0];c[1]=k[1]-this.nodeXY[1];this.region={0:k[0],1:k[1],area:0,top:k[1],right:k[0]+this.get("dragNode").get("offsetWidth"),bottom:k[1]+this.get("dragNode").get("offsetHeight"),left:k[0]};this.fire("drag:drag",{pageX:k[0],pageY:k[1],scroll:a,info:{start:d,xy:k,delta:b,offset:c}});this.lastXY=k},_defDragFn:function(b){if(this.get("move")){if(b.scroll&&
b.scroll.node){var c=b.scroll.node.getDOMNode();c===a.config.win?c.scrollTo(b.scroll.left,b.scroll.top):(b.scroll.node.set("scrollTop",b.scroll.top),b.scroll.node.set("scrollLeft",b.scroll.left))}this.get("dragNode").setXY([b.pageX,b.pageY]);this.realXY=[b.pageX,b.pageY]}},_move:function(a){if(this.get("lock"))return!1;this.mouseXY=[a.pageX,a.pageY];if(this._dragThreshMet)this._clickTimeout&&this._clickTimeout.cancel(),this._alignNode([a.pageX,a.pageY]);else{var b=Math.abs(this.startXY[0]-a.pageX),
c=Math.abs(this.startXY[1]-a.pageY);if(b>this.get("clickPixelThresh")||c>this.get("clickPixelThresh"))this._dragThreshMet=!0,this.start(),a&&a.preventDefault&&a.preventDefault(),this._alignNode([a.pageX,a.pageY])}},stopDrag:function(){this.get("dragging")&&b._end();return this},destructor:function(){this._unprep();this.target&&this.target.destroy();b._unregDrag(this)}});a.namespace("DD");a.DD.Drag=c},"3.17.2",{requires:["dd-ddm-base"]});
YUI.add("dd-proxy",function(a,d){var b=a.DD.DDM,c=function(){c.superclass.constructor.apply(this,arguments)};c.NAME="DDProxy";c.NS="proxy";c.ATTRS={host:{},moveOnEnd:{value:!0},hideOnEnd:{value:!0},resizeFrame:{value:!0},positionProxy:{value:!0},borderStyle:{value:"1px solid #808080"},cloneNode:{value:!1}};a.namespace("Plugin");a.extend(c,a.Base,{_hands:null,_init:function(){if(b._proxy){this._hands||(this._hands=[]);var c,f,d=this.get("host");d.get("dragNode").compareTo(d.get("node"))&&b._proxy&&
d.set("dragNode",b._proxy);a.Array.each(this._hands,function(a){a.detach()});c=b.on("ddm:start",a.bind(function(){b.activeDrag===d&&b._setFrame(d)},this));f=b.on("ddm:end",a.bind(function(){d.get("dragging")&&(this.get("moveOnEnd")&&d.get("node").setXY(d.lastXY),this.get("hideOnEnd")&&d.get("dragNode").setStyle("display","none"),this.get("cloneNode")&&(d.get("dragNode").remove(),d.set("dragNode",b._proxy)))},this));this._hands=[c,f]}else b._createFrame(),a.on("domready",a.bind(this._init,this))},
initializer:function(){this._init()},destructor:function(){var b=this.get("host");a.Array.each(this._hands,function(a){a.detach()});b.set("dragNode",b.get("node"))},clone:function(){var b=this.get("host"),c=b.get("node"),d=c.cloneNode(!0);d.all('input[type="radio"]').removeAttribute("name");delete d._yuid;d.setAttribute("id",a.guid());d.setStyle("position","absolute");c.get("parentNode").appendChild(d);b.set("dragNode",d);return d}});a.Plugin.DDProxy=c;a.mix(b,{_createFrame:function(){if(!b._proxy){b._proxy=
!0;var c=a.Node.create("<div></div>"),f=a.one("body");c.setStyles({position:"absolute",display:"none",zIndex:"999",top:"-999px",left:"-999px"});f.prepend(c);c.set("id",a.guid());c.addClass(b.CSS_PREFIX+"-proxy");b._proxy=c}},_setFrame:function(a){var c=a.get("node"),d=a.get("dragNode"),h,k="auto";(h=b.activeDrag.get("activeHandle"))&&(k=h.getStyle("cursor"));"auto"===k&&(k=b.get("dragCursor"));d.setStyles({visibility:"hidden",display:"block",cursor:k,border:a.proxy.get("borderStyle")});a.proxy.get("cloneNode")&&
(d=a.proxy.clone());a.proxy.get("resizeFrame")&&d.setStyles({height:c.get("offsetHeight")+"px",width:c.get("offsetWidth")+"px"});a.proxy.get("positionProxy")&&d.setXY(a.nodeXY);d.setStyle("visibility","visible")}})},"3.17.2",{requires:["dd-drag"]});
YUI.add("dd-constrain",function(a,d){var b=a.DD.DDM,c=null,e=function(){this._lazyAddAttrs=!1;e.superclass.constructor.apply(this,arguments)};e.NAME="ddConstrained";e.NS="con";e.ATTRS={host:{},stickX:{value:!1},stickY:{value:!1},tickX:{value:!1},tickY:{value:!1},tickXArray:{value:!1},tickYArray:{value:!1},gutter:{value:"0",setter:function(b){return a.DD.DDM.cssSizestoObject(b)}},constrain:{value:"view",setter:function(b){var c=a.one(b);c&&(b=c);return b}},constrain2region:{setter:function(a){return this.set("constrain",
a)}},constrain2node:{setter:function(b){return this.set("constrain",a.one(b))}},constrain2view:{setter:function(){return this.set("constrain","view")}},cacheRegion:{value:!0}};c={_lastTickXFired:null,_lastTickYFired:null,initializer:function(){this._createEvents();this._eventHandles=[this.get("host").on("drag:end",a.bind(this._handleEnd,this)),this.get("host").on("drag:start",a.bind(this._handleStart,this)),this.get("host").after("drag:align",a.bind(this.align,this)),this.get("host").after("drag:drag",
a.bind(this.drag,this))]},destructor:function(){a.Array.each(this._eventHandles,function(a){a.detach()});this._eventHandles.length=0},_createEvents:function(){a.Array.each(["drag:tickAlignX","drag:tickAlignY"],function(a){this.publish(a,{type:a,emitFacade:!0,bubbles:!0,queuable:!1,prefix:"drag"})},this)},_handleEnd:function(){this._lastTickXFired=this._lastTickYFired=null},_handleStart:function(){this.resetCache()},_regionCache:null,_cacheRegion:function(){this._regionCache=this.get("constrain").get("region")},
resetCache:function(){this._regionCache=null},_getConstraint:function(){var b=this.get("constrain"),c=this.get("gutter"),e;b&&(b instanceof a.Node?(this._regionCache||(this._eventHandles.push(a.on("resize",a.bind(this._cacheRegion,this),a.config.win)),this._cacheRegion()),e=a.clone(this._regionCache),this.get("cacheRegion")||this.resetCache()):a.Lang.isObject(b)&&(e=a.clone(b)));if(!b||!e)b="view";"view"===b&&(e=this.get("host").get("dragNode").get("viewportRegion"));a.Object.each(c,function(a,b){e[b]=
"right"===b||"bottom"===b?e[b]-a:e[b]+a});return e},getRegion:function(a){var b={},c=null,e=null,e=this.get("host"),b=this._getConstraint();a&&(c=e.get("dragNode").get("offsetHeight"),e=e.get("dragNode").get("offsetWidth"),b.right-=e,b.bottom-=c);return b},_checkRegion:function(a){var b=this.getRegion(),c=this.get("host"),e=c.get("dragNode").get("offsetHeight"),c=c.get("dragNode").get("offsetWidth");a[1]>b.bottom-e&&(a[1]=b.bottom-e);b.top>a[1]&&(a[1]=b.top);a[0]>b.right-c&&(a[0]=b.right-c);b.left>
a[0]&&(a[0]=b.left);return a},inRegion:function(a){a=a||this.get("host").get("dragNode").getXY();var b=this._checkRegion([a[0],a[1]]),c=!1;a[0]===b[0]&&a[1]===b[1]&&(c=!0);return c},align:function(){var a=this.get("host"),b=[a.actXY[0],a.actXY[1]],c=this.getRegion(!0);this.get("stickX")&&(b[1]=a.startXY[1]-a.deltaXY[1]);this.get("stickY")&&(b[0]=a.startXY[0]-a.deltaXY[0]);c&&(b=this._checkRegion(b));b=this._checkTicks(b,c);a.actXY=b},drag:function(){var b=this.get("host"),c=this.get("tickX"),e=this.get("tickY"),
b=[b.actXY[0],b.actXY[1]];if((a.Lang.isNumber(c)||this.get("tickXArray"))&&this._lastTickXFired!==b[0])this._tickAlignX(),this._lastTickXFired=b[0];if((a.Lang.isNumber(e)||this.get("tickYArray"))&&this._lastTickYFired!==b[1])this._tickAlignY(),this._lastTickYFired=b[1]},_checkTicks:function(a,c){var e=this.get("host"),d=e.startXY[0]-e.deltaXY[0],e=e.startXY[1]-e.deltaXY[1],m=this.get("tickX"),l=this.get("tickY");m&&!this.get("tickXArray")&&(a[0]=b._calcTicks(a[0],d,m,c.left,c.right));l&&!this.get("tickYArray")&&
(a[1]=b._calcTicks(a[1],e,l,c.top,c.bottom));this.get("tickXArray")&&(a[0]=b._calcTickArray(a[0],this.get("tickXArray"),c.left,c.right));this.get("tickYArray")&&(a[1]=b._calcTickArray(a[1],this.get("tickYArray"),c.top,c.bottom));return a},_tickAlignX:function(){this.fire("drag:tickAlignX")},_tickAlignY:function(){this.fire("drag:tickAlignY")}};a.namespace("Plugin");a.extend(e,a.Base,c);a.Plugin.DDConstrained=e;a.mix(b,{_calcTicks:function(a,b,c,e,d){var l=(a-b)/c,n=Math.floor(l),p=Math.ceil(l);if((0!==
n||0!==p)&&l>=n&&l<=p)a=b+c*n,e&&d&&(a<e&&(a=b+c*(n+1)),a>d&&(a=b+c*(n-1)));return a},_calcTickArray:function(a,b,c,e){var d=0,l=b.length,n=0,p;if(!b||0===b.length)return a;if(b[0]>=a)return b[0];for(d=0;d<l;d++)if(n=d+1,b[n]&&b[n]>=a)return p=a-b[d],a=b[n]-a,n=a>p?b[d]:b[n],c&&e&&n>e&&(n=b[d]?b[d]:b[l-1]),n;return b[b.length-1]}})},"3.17.2",{requires:["dd-drag"]});
YUI.add("dd-drop",function(a,d){var b=a.DD.DDM,c=function(){this._lazyAddAttrs=!1;c.superclass.constructor.apply(this,arguments);a.on("domready",a.bind(function(){a.later(100,this,this._createShim)},this));b._regTarget(this)};c.NAME="drop";c.ATTRS={node:{setter:function(b){var c=a.one(b);c||a.error("DD.Drop: Invalid Node Given: "+b);return c}},groups:{value:["default"],getter:function(){return!this._groups?(this._groups={},[]):a.Object.keys(this._groups)},setter:function(b){this._groups=a.Array.hash(b);
return b}},padding:{value:"0",setter:function(a){return b.cssSizestoObject(a)}},lock:{value:!1,setter:function(a){a?this.get("node").addClass(b.CSS_PREFIX+"-drop-locked"):this.get("node").removeClass(b.CSS_PREFIX+"-drop-locked");return a}},bubbles:{setter:function(a){this.addTarget(a);return a}},useShim:{value:!0,setter:function(b){a.DD.DDM._noShim=!b;return b}}};a.extend(c,a.Base,{_bubbleTargets:a.DD.DDM,addToGroup:function(a){this._groups[a]=!0;return this},removeFromGroup:function(a){delete this._groups[a];
return this},_createEvents:function(){a.Array.each(["drop:over","drop:enter","drop:exit","drop:hit"],function(a){this.publish(a,{type:a,emitFacade:!0,preventable:!1,bubbles:!0,queuable:!1,prefix:"drop"})},this)},_valid:null,_groups:null,shim:null,region:null,overTarget:null,inGroup:function(b){var c=this._valid=!1;a.Array.each(b,function(a){this._groups[a]&&(this._valid=c=!0)},this);return c},initializer:function(){a.later(100,this,this._createEvents);var c=this.get("node"),d;c.get("id")||(d=a.stamp(c),
c.set("id",d));c.addClass(b.CSS_PREFIX+"-drop");this.set("groups",this.get("groups"))},destructor:function(){b._unregTarget(this);this.shim&&this.shim!==this.get("node")&&(this.shim.detachAll(),this.shim.remove(),this.shim=null);this.get("node").removeClass(b.CSS_PREFIX+"-drop");this.detachAll()},_deactivateShim:function(){if(!this.shim)return!1;this.get("node").removeClass(b.CSS_PREFIX+"-drop-active-valid");this.get("node").removeClass(b.CSS_PREFIX+"-drop-active-invalid");this.get("node").removeClass(b.CSS_PREFIX+
"-drop-over");this.get("useShim")&&this.shim.setStyles({top:"-999px",left:"-999px",zIndex:"1"});this.overTarget=!1},_activateShim:function(){if(!b.activeDrag||this.get("node")===b.activeDrag.get("node")||this.get("lock"))return!1;var a=this.get("node");this.inGroup(b.activeDrag.get("groups"))?(a.removeClass(b.CSS_PREFIX+"-drop-active-invalid"),a.addClass(b.CSS_PREFIX+"-drop-active-valid"),b._addValid(this),this.overTarget=!1,this.get("useShim")||(this.shim=this.get("node")),this.sizeShim()):(b._removeValid(this),
a.removeClass(b.CSS_PREFIX+"-drop-active-valid"),a.addClass(b.CSS_PREFIX+"-drop-active-invalid"))},sizeShim:function(){if(!b.activeDrag||this.get("node")===b.activeDrag.get("node")||this.get("lock"))return!1;if(!this.shim)return a.later(100,this,this.sizeShim),!1;var c=this.get("node"),d=c.get("offsetHeight"),g=c.get("offsetWidth"),c=c.getXY(),h=this.get("padding"),k,m,g=g+h.left+h.right,d=d+h.top+h.bottom;c[0]-=h.left;c[1]-=h.top;b.activeDrag.get("dragMode")===b.INTERSECT&&(h=b.activeDrag,k=h.get("node").get("offsetHeight"),
m=h.get("node").get("offsetWidth"),d+=k,g+=m,c[0]-=m-h.deltaXY[0],c[1]-=k-h.deltaXY[1]);this.get("useShim")&&this.shim.setStyles({height:d+"px",width:g+"px",top:c[1]+"px",left:c[0]+"px"});this.region={0:c[0],1:c[1],area:0,top:c[1],right:c[0]+g,bottom:c[1]+d,left:c[0]}},_createShim:function(){if(b._pg){if(!this.shim){var c=this.get("node");this.get("useShim")&&(c=a.Node.create('<div id="'+this.get("node").get("id")+'_shim"></div>'),c.setStyles({height:this.get("node").get("offsetHeight")+"px",width:this.get("node").get("offsetWidth")+
"px",backgroundColor:"yellow",opacity:".5",zIndex:"1",overflow:"hidden",top:"-900px",left:"-900px",position:"absolute"}),b._pg.appendChild(c),c.on("mouseover",a.bind(this._handleOverEvent,this)),c.on("mouseout",a.bind(this._handleOutEvent,this)));this.shim=c}}else a.later(10,this,this._createShim)},_handleTargetOver:function(){b.isOverTarget(this)?(this.get("node").addClass(b.CSS_PREFIX+"-drop-over"),b.activeDrop=this,b.otherDrops[this]=this,this.overTarget?(b.activeDrag.fire("drag:over",{drop:this,
drag:b.activeDrag}),this.fire("drop:over",{drop:this,drag:b.activeDrag})):b.activeDrag.get("dragging")&&(this.overTarget=!0,this.fire("drop:enter",{drop:this,drag:b.activeDrag}),b.activeDrag.fire("drag:enter",{drop:this,drag:b.activeDrag}),b.activeDrag.get("node").addClass(b.CSS_PREFIX+"-drag-over"))):this._handleOut()},_handleOverEvent:function(){this.shim.setStyle("zIndex","999");b._addActiveShim(this)},_handleOutEvent:function(){this.shim.setStyle("zIndex","1");b._removeActiveShim(this)},_handleOut:function(a){if((!b.isOverTarget(this)||
a)&&this.overTarget)this.overTarget=!1,a||b._removeActiveShim(this),b.activeDrag&&(this.get("node").removeClass(b.CSS_PREFIX+"-drop-over"),b.activeDrag.get("node").removeClass(b.CSS_PREFIX+"-drag-over"),this.fire("drop:exit",{drop:this,drag:b.activeDrag}),b.activeDrag.fire("drag:exit",{drop:this,drag:b.activeDrag}),delete b.otherDrops[this])}});a.DD.Drop=c},"3.17.2",{requires:["dd-drag","dd-ddm-drop"]});
YUI.add("dd-scroll",function(a,d){var b=function(){b.superclass.constructor.apply(this,arguments)},c,e;b.ATTRS={parentScroll:{value:!1,setter:function(a){return a?a:!1}},buffer:{value:30,validator:a.Lang.isNumber},scrollDelay:{value:235,validator:a.Lang.isNumber},host:{value:null},windowScroll:{value:!1,validator:a.Lang.isBoolean},vertical:{value:!0,validator:a.Lang.isBoolean},horizontal:{value:!0,validator:a.Lang.isBoolean}};a.extend(b,a.Base,{_scrolling:null,_vpRegionCache:null,_dimCache:null,_scrollTimer:null,
_getVPRegion:function(){var a={},a=this.get("parentScroll"),b=this.get("buffer"),c=this.get("windowScroll"),e=c?[]:a.getXY(),d=c?"winWidth":"offsetWidth",l=c?"winHeight":"offsetHeight",n=c?a.get("scrollTop"):e[1],c=c?a.get("scrollLeft"):e[0];return this._vpRegionCache=a={top:n+b,right:a.get(d)+c-b,bottom:a.get(l)+n-b,left:c+b}},initializer:function(){var b=this.get("host");b.after("drag:start",a.bind(this.start,this));b.after("drag:end",a.bind(this.end,this));b.on("drag:align",a.bind(this.align,this));
a.one("win").on("scroll",a.bind(function(){this._vpRegionCache=null},this))},_checkWinScroll:function(a){var b=this._getVPRegion(),c=this.get("host"),e=this.get("windowScroll"),d=c.lastXY,l=!1,n=this.get("buffer"),p=this.get("parentScroll"),r=p.get("scrollTop"),s=p.get("scrollLeft"),t=d[1]+this._dimCache.h,q=d[1],z=d[0]+this._dimCache.w,u=d[0],A=q,x=u,v=r,w=s;this.get("horizontal")&&(u<=b.left&&(l=!0,x=d[0]-(e?n:0),w=s-n),z>=b.right&&(l=!0,x=d[0]+(e?n:0),w=s+n));this.get("vertical")&&(t>=b.bottom&&
(l=!0,A=d[1]+(e?n:0),v=r+n),q<=b.top&&(l=!0,A=d[1]-(e?n:0),v=r-n));0>v&&(v=0,A=d[1]);0>w&&(w=0,x=d[0]);0>A&&(A=d[1]);0>x&&(x=d[0]);a?(c.actXY=[x,A],c._alignNode([x,A],!0),c.actXY=[x,A],c._moveNode({node:p,top:v,left:w}),!v&&!w&&this._cancelScroll()):l?this._initScroll():this._cancelScroll()},_initScroll:function(){this._cancelScroll();this._scrollTimer=a.Lang.later(this.get("scrollDelay"),this,this._checkWinScroll,[!0],!0)},_cancelScroll:function(){this._scrolling=!1;this._scrollTimer&&(this._scrollTimer.cancel(),
delete this._scrollTimer)},align:function(a){this._scrolling&&(this._cancelScroll(),a.preventDefault());this._scrolling||this._checkWinScroll()},_setDimCache:function(){var a=this.get("host").get("dragNode");this._dimCache={h:a.get("offsetHeight"),w:a.get("offsetWidth")}},start:function(){this._setDimCache()},end:function(){this._dimCache=null;this._cancelScroll()}});a.namespace("Plugin");c=function(){c.superclass.constructor.apply(this,arguments)};c.ATTRS=a.merge(b.ATTRS,{windowScroll:{value:!0,
setter:function(b){b&&this.set("parentScroll",a.one("win"));return b}}});a.extend(c,b,{initializer:function(){this.set("windowScroll",this.get("windowScroll"))}});c.NAME=c.NS="winscroll";a.Plugin.DDWinScroll=c;e=function(){e.superclass.constructor.apply(this,arguments)};e.ATTRS=a.merge(b.ATTRS,{node:{value:!1,setter:function(b){var c=a.one(b);c?this.set("parentScroll",c):!1!==b&&a.error("DDNodeScroll: Invalid Node Given: "+b);return c}}});a.extend(e,b,{initializer:function(){this.set("node",this.get("node"))}});
e.NAME=e.NS="nodescroll";a.Plugin.DDNodeScroll=e;a.DD.Scroll=b},"3.17.2",{requires:["dd-drag"]});
YUI.add("dd-delegate",function(a,d){var b=function(){b.superclass.constructor.apply(this,arguments)},c=a.Node.create("<div>Temp Node</div>");a.extend(b,a.Base,{_bubbleTargets:a.DD.DDM,dd:null,_shimState:null,_handles:null,_onNodeChange:function(a){this.set("dragNode",a.newVal)},_afterDragEnd:function(){a.DD.DDM._noShim=this._shimState;this.set("lastNode",this.dd.get("node"));this.get("lastNode").removeClass(a.DD.DDM.CSS_PREFIX+"-dragging");this.dd._unprep();this.dd.set("node",c)},_delMouseDown:function(b){var c=
b.currentTarget,d=this.dd,h=c,k=this.get("dragConfig");c.test(this.get("nodes"))&&!c.test(this.get("invalid"))&&(this._shimState=a.DD.DDM._noShim,a.DD.DDM._noShim=!0,this.set("currentNode",c),d.set("node",c),k&&k.dragNode?h=k.dragNode:d.proxy&&(h=a.DD.DDM._proxy),d.set("dragNode",h),d._prep(),d.fire("drag:mouseDown",{ev:b}))},_onMouseEnter:function(){this._shimState=a.DD.DDM._noShim;a.DD.DDM._noShim=!0},_onMouseLeave:function(){a.DD.DDM._noShim=this._shimState},initializer:function(){this._handles=
[];var b=this.get("dragConfig")||{},d=this.get("container");b.node=c.cloneNode(!0);b.bubbleTargets=this;this.get("handles")&&(b.handles=this.get("handles"));this.dd=new a.DD.Drag(b);this.dd.after("drag:end",a.bind(this._afterDragEnd,this));this.dd.on("dragNodeChange",a.bind(this._onNodeChange,this));this.dd.after("drag:mouseup",function(){this._unprep()});this._handles.push(a.delegate(a.DD.Drag.START_EVENT,a.bind(this._delMouseDown,this),d,this.get("nodes")));this._handles.push(a.on("mouseenter",
a.bind(this._onMouseEnter,this),d));this._handles.push(a.on("mouseleave",a.bind(this._onMouseLeave,this),d));a.later(50,this,this.syncTargets);a.DD.DDM.regDelegate(this)},syncTargets:function(){if(a.Plugin.Drop&&!this.get("destroyed")){var b,c,d;if(this.get("target")){b=a.one(this.get("container")).all(this.get("nodes"));c=this.dd.get("groups");if((d=this.get("dragConfig"))&&d.groups)c=d.groups;b.each(function(a){this.createDrop(a,c)},this)}return this}},createDrop:function(b,c){var d={useShim:!1,
bubbleTargets:this};b.drop||b.plug(a.Plugin.Drop,d);b.drop.set("groups",c);return b},destructor:function(){this.dd&&this.dd.destroy();a.Plugin.Drop&&a.one(this.get("container")).all(this.get("nodes")).unplug(a.Plugin.Drop);a.Array.each(this._handles,function(a){a.detach()})}},{NAME:"delegate",ATTRS:{container:{value:"body"},nodes:{value:".dd-draggable"},invalid:{value:"input, select, button, a, textarea"},lastNode:{value:c},currentNode:{value:c},dragNode:{value:c},over:{value:!1},target:{value:!1},
dragConfig:{value:null},handles:{value:null}}});a.mix(a.DD.DDM,{_delegates:[],regDelegate:function(a){this._delegates.push(a)},getDelegate:function(b){var c=null;b=a.one(b);a.Array.each(this._delegates,function(a){b.test(a.get("container"))&&(c=a)},this);return c}});a.namespace("DD");a.DD.Delegate=b},"3.17.2",{requires:["dd-drag","dd-drop-plugin","event-mouseenter"]});
YUI.add("dd-drop-plugin",function(a,d){var b=function(a){a.node=a.host;b.superclass.constructor.apply(this,arguments)};b.NAME="dd-drop-plugin";b.NS="drop";a.extend(b,a.DD.Drop);a.namespace("Plugin");a.Plugin.Drop=b},"3.17.2",{requires:["dd-drop"]});
YUI.add("node-focusmanager",function(a,d){var b={37:!0,38:!0,39:!0,40:!0},c={a:!0,button:!0,input:!0,object:!0},e=a.Lang,f=a.UA,g=function(){g.superclass.constructor.apply(this,arguments)};g.ATTRS={focused:{value:!1,readOnly:!0},descendants:{getter:function(a){return this.get("host").all(a)}},activeDescendant:{setter:function(b){var c=e.isNumber,d=a.Attribute.INVALID_VALUE,f=this._descendantsMap,g=this._descendants,p;c(b)?b=p=b:b instanceof a.Node&&f?(p=f[b.get("id")],b=c(p)?p:d):b=d;g&&(g=g.item(p))&&
g.get("disabled")&&(b=d);return b}},keys:{value:{next:null,previous:null}},focusClass:{},circular:{value:!0}};a.extend(g,a.Plugin.Base,{_stopped:!0,_descendants:null,_descendantsMap:null,_focusedNode:null,_lastNodeIndex:0,_eventHandlers:null,_initDescendants:function(){var b=this.get("descendants"),c={},d=-1,f,g=this.get("activeDescendant"),p,r,s=0;e.isUndefined(g)&&(g=-1);if(b){f=b.size();for(s=0;s<f;s++)p=b.item(s),-1===d&&!p.get("disabled")&&(d=s),0>g&&0===parseInt(p.getAttribute("tabIndex",2),
10)&&(g=s),p&&p.set("tabIndex",-1),r=p.get("id"),r||(r=a.guid(),p.set("id",r)),c[r]=s;0>g&&(g=0);p=b.item(g);if(!p||p.get("disabled"))p=b.item(d),g=d;this._lastNodeIndex=f-1;this._descendants=b;this._descendantsMap=c;this.set("activeDescendant",g);p&&p.set("tabIndex",0)}},_isDescendant:function(a){return a.get("id")in this._descendantsMap},_removeFocusClass:function(){var a=this._focusedNode,b=this.get("focusClass"),c;b&&(c=e.isString(b)?b:b.className);a&&c&&a.removeClass(c)},_detachKeyHandler:function(){var a=
this._prevKeyHandler,b=this._nextKeyHandler;a&&a.detach();b&&b.detach()},_preventScroll:function(a){b[a.keyCode]&&this._isDescendant(a.target)&&a.preventDefault()},_fireClick:function(a){var b=a.target,e=b.get("nodeName").toLowerCase();13===a.keyCode&&(!c[e]||"a"===e&&!b.getAttribute("href"))&&b.simulate("click")},_attachKeyHandler:function(){this._detachKeyHandler();var b=this.get("keys.next"),c=this.get("keys.previous"),e=this.get("host"),d=this._eventHandlers;c&&(this._prevKeyHandler=a.on("key",
a.bind(this._focusPrevious,this),e,c));b&&(this._nextKeyHandler=a.on("key",a.bind(this._focusNext,this),e,b));f.opera&&d.push(e.on("keypress",this._preventScroll,this));f.opera||d.push(e.on("keypress",this._fireClick,this))},_detachEventHandlers:function(){this._detachKeyHandler();var b=this._eventHandlers;b&&(a.Array.each(b,function(a){a.detach()}),this._eventHandlers=null)},_attachEventHandlers:function(){var b=this._descendants,c,e;b&&b.size()&&(b=this._eventHandlers||[],c=this.get("host").get("ownerDocument"),
0===b.length&&(b.push(c.on("focus",this._onDocFocus,this)),b.push(c.on("mousedown",this._onDocMouseDown,this)),b.push(this.after("keysChange",this._attachKeyHandler)),b.push(this.after("descendantsChange",this._initDescendants)),b.push(this.after("activeDescendantChange",this._afterActiveDescendantChange)),e=this.after("focusedChange",a.bind(function(a){a.newVal&&(this._attachKeyHandler(),e.detach())},this)),b.push(e)),this._eventHandlers=b)},_onDocMouseDown:function(a){var b=this.get("host"),c=a.target,
e=b.contains(c),d,g=function(a){var c=!1;a.compareTo(b)||(c=this._isDescendant(a)?a:g.call(this,a.get("parentNode")));return c};e&&((d=g.call(this,c))?c=d:!d&&this.get("focused")&&(this._set("focused",!1),this._onDocFocus(a)));if(e&&this._isDescendant(c))this.focus(c);else if(f.webkit&&this.get("focused")&&(!e||e&&!this._isDescendant(c)))this._set("focused",!1),this._onDocFocus(a)},_onDocFocus:function(a){a=this._focusTarget||a.target;var b=this.get("focused"),c=this.get("focusClass"),e=this._focusedNode,
d;this._focusTarget&&(this._focusTarget=null);this.get("host").contains(a)?(d=this._isDescendant(a),!b&&d?b=!0:b&&!d&&(b=!1)):b=!1;c&&(e&&(!e.compareTo(a)||!b)&&this._removeFocusClass(),d&&b&&(c.fn?(a=c.fn(a),a.addClass(c.className)):a.addClass(c),this._focusedNode=a));this._set("focused",b)},_focusNext:function(a,b){var c=b||this.get("activeDescendant"),e;this._isDescendant(a.target)&&c<=this._lastNodeIndex&&(c+=1,c===this._lastNodeIndex+1&&this.get("circular")&&(c=0),(e=this._descendants.item(c))&&
(e.get("disabled")?this._focusNext(a,c):this.focus(c)));this._preventScroll(a)},_focusPrevious:function(a,b){var c=b||this.get("activeDescendant"),e;this._isDescendant(a.target)&&0<=c&&(c-=1,-1===c&&this.get("circular")&&(c=this._lastNodeIndex),(e=this._descendants.item(c))&&(e.get("disabled")?this._focusPrevious(a,c):this.focus(c)));this._preventScroll(a)},_afterActiveDescendantChange:function(a){var b=this._descendants.item(a.prevVal);b&&b.set("tabIndex",-1);(b=this._descendants.item(a.newVal))&&
b.set("tabIndex",0)},initializer:function(a){this.start()},destructor:function(){this.stop();this.get("host").focusManager=null},focus:function(a){e.isUndefined(a)&&(a=this.get("activeDescendant"));this.set("activeDescendant",a,{src:"UI"});if(a=this._descendants.item(this.get("activeDescendant")))a.focus(),f.opera&&"button"===a.get("nodeName").toLowerCase()&&(this._focusTarget=a)},blur:function(){var a;if(this.get("focused")){if(a=this._descendants.item(this.get("activeDescendant")))a.blur(),this._removeFocusClass();
this._set("focused",!1,{src:"UI"})}},start:function(){this._stopped&&(this._initDescendants(),this._attachEventHandlers(),this._stopped=!1)},stop:function(){this._stopped||(this._detachEventHandlers(),this._focusedNode=this._descendants=null,this._lastNodeIndex=0,this._stopped=!0)},refresh:function(){this._initDescendants();this._eventHandlers||this._attachEventHandlers()}});g.NAME="nodeFocusManager";g.NS="focusManager";a.namespace("Plugin");a.Plugin.NodeFocusManager=g},"3.17.2",{requires:"attribute node plugin node-event-simulate event-key event-focus".split(" ")});
YUI.add("squarespace-animation-manager",function(a){a.namespace("Squarespace").AnimationManager=Class.create({initialize:function(){this._concurrentAnimations=[];this._destroyed=this._animationsFinished=!1},push:function(d){if(a.Lang.isArray(d))for(var b=0;b<d.length;b++)this._concurrentAnimations.push(d[b]);else this._concurrentAnimations.push(d)},run:function(a,b){this.callback=a;this.context=b||this;for(var c=function(){this._animEnd()},e=0;e<this._concurrentAnimations.length;e++)this._concurrentAnimations[e]&&
(this._concurrentAnimations[e].once("end",c,this),this._concurrentAnimations[e].run());this._running=!0},stop:function(a){a=!!a;for(var b=0;b<this._concurrentAnimations.length;b++)this._concurrentAnimations[b]&&(this._concurrentAnimations[b].stop(a),this._animationsFinished=!0);this._running&&(this._running=!1)},_animEnd:function(){a.Array.every(this._concurrentAnimations,function(a){return!a.get("running")})&&(this._animationsFinished=!0,this._running=!1,this.callback&&this.callback.call(this.context),
this.fire("end"))},isRunning:function(){return this._running},destroy:function(a){this.fire("destroy");if(this._destroyed)throw"MultipleAnimationManager: Sorry bro, I'm already destroyed.";this._destroyed=!0;this.stop(a);for(var b=0;b<this._concurrentAnimations.length;b++)this._concurrentAnimations[b]&&this._concurrentAnimations[b].destroy(!0);this._running&&(this._running=!1,this._animationsFinished=!!a);this.fire("destroyed")},isDestroyed:function(){return this._destroyed}});a.augment(a.Squarespace.AnimationManager,
a.EventTarget)},"1.0");
YUI.add("squarespace-dialog-field-2",function(a){a.namespace("Squarespace.Widgets").DialogField2=a.namespace("Squarespace").DialogField2=a.Base.create("dialogField",a.Squarespace.Widgets.DataWidget,[a.Squarespace.DialogFieldLegacyInterface,a.WidgetParent,a.WidgetChild],{initializer:function(a){this._saveInitialData(a?a.data:null);this.publish("error-shown",{broadcast:2})},destructor:function(){this._destroyError();this.unplug(a.Plugin.WidgetAnim);this._initialData=void 0;this._errorFlyoutSub&&this._errorFlyoutSub.detach()},
_destroyError:function(){this._errorNode&&(this._errorNode.remove(!0),this._errorNode=null)},_saveInitialData:function(d){d=!a.Lang.isValue(d)?this.get("data"):d;a.Lang.isArray(d)&&this.get("cloneInitialData")?this._initialData=d.slice():a.Lang.isObject(d)&&this.get("cloneInitialData")?this._initialData=a.clone(d,!0):this._initialData=d},setCurrentDataAsInitial:function(){this._saveInitialData()},renderUI:function(){a.Squarespace.DialogField2.superclass.renderUI.call(this);var d=this.get("name");
d&&this.get("boundingBox").addClass("name-"+d)},scrollIntoView:function(){this.get("contentBox").scrollIntoView()},showError:function(d){if(d&&this.get("rendered")){var b=this.get("boundingBox"),c=this.get("contentBox"),e=this.get("errorFlyoutAnchor")||c,c=this.get("errorFlyoutAnimationTime");e.hasPlugin("flyoutPlugin")||e.plug(a.Squarespace.Animations.Flyout,{duration:c,renderTarget:this.get("errorFlyoutRenderTarget")});var f=e.flyoutPlugin,g=a.bind(function(){b.addClass("error");this._destroyError();
this._errorNode=a.Node.create('<div class="sqs-flyout-error-message">'+d+"</div>");var c=this.get("dialog");c&&this._errorNode.setStyle("zIndex",c.zIndex+10);this._errorNode.on(this.get("id")+"|click",function(a){a.halt();this.hideError()},this);var g=a.one(window).get("region"),m=a.Squarespace.Utils.measureNode(this._errorNode).width,c=e.get("region");c.right+m<=g.right?(g="rt",this._errorNode.addClass("out-from-right")):c.left-m>g.left?(g="lt",this._errorNode.addClass("out-from-left")):(g="bl",
this._errorNode.addClass("out-from-bottom"),this._errorNode.setStyle("width",c.width));f.setAttrs({node:this._errorNode,alignment:g});this._clearErrorSub=a.on(this.get("id")+"|click",this.hideError,this);c=this.get("id");f.once(c+"|shown",function(a){this.fire("error-shown",{message:d})},this);this._errorFlyoutSub=e.once("flyout-shown",function(a){this._errorNode.setStyle("width","100%")},this);f.show()},this);f.get("visible")?(this._isHiding=!0,this._showErrorSub&&this._showErrorSub.detach(),this._showErrorSub=
f.once(this.get("id")+"|hidden",function(){this._showErrorSub=null;this._isHiding=!1;g()},this),f.hide()):g()}},hideError:function(){if(this.get("rendered")&&!this._isHiding){var a=this.get("boundingBox"),b=this.get("contentBox"),b=this.get("errorFlyoutAnchor")||b;b.hasPlugin("flyoutPlugin")&&b.flyoutPlugin.get("visible")&&(this._clearErrorSub&&(this._clearErrorSub.detach(),this._clearErrorSub=null),b=b.flyoutPlugin,b.once(this.get("id")+"|hidden",function(b){a.removeClass("error");this.fire("error-hidden");
this._destroyError()},this),b.hide())}},didDataChange:function(){var d=this.get("data");if(this.get("readOnly"))return!1;if(a.Lang.isArray(this._initialData))return a.JSON.stringify(this._initialData)!==a.JSON.stringify(d);if(a.Lang.isObject(this._initialData))throw"DialogField base class will not compare objects. Define didDataChange for this field.";return this._initialData!==d},isEmpty:function(){var a=this.get("data");return""===a||0===a},revert:function(){this.set("data",this._initialData,{revert:!0})},
_getErrors:function(){return[]},isValid:function(){return!a.Lang.isArray(this.get("errors"))||0===this.get("errors").length}},{CSS_PREFIX:"sqs-dialog-field",ATTRS:{cloneInitialData:{value:!0},strings:{},name:{value:null,validator:a.Squarespace.AttrValidators.isNullOrString},dialog:{value:null,validator:function(d){if(a.Lang.isNull(d)||d instanceof a.Squarespace.EditingDialog||d.constructor instanceof a.Squarespace.EditingDialog.constructor)return!0;console.warn(this.name+": Not an EditingDialog");
return!1}},readOnly:{value:!1,validator:a.Squarespace.AttrValidators.isBoolean},required:{value:!1,validator:a.Squarespace.AttrValidators.isBoolean},errors:{value:[],readOnly:!0,getter:"_getErrors",validator:a.Squarespace.AttrValidators.isArray},errorFlyoutAnchor:{value:null,readOnly:!0,validator:a.Squarespace.AttrValidators.isNullOrInstanceOf(a.Node)},errorFlyoutRenderTarget:{value:void 0},errorFlyoutAnimationTime:{value:0.3},focusable:{value:!0,validator:a.Lang.isBoolean}}})},"1.0",{requires:"base json-stringify squarespace-animations squarespace-attr-validators squarespace-dialog-field-legacy-interface squarespace-flyout-error-message-template squarespace-node-flyout squarespace-util squarespace-widgets-data-widget widget-anim widget-child widget-parent".split(" ")});
YUI.add("squarespace-dialog-field-legacy-interface",function(a){var d=a.namespace("Squarespace").DialogFieldLegacyInterface=function(b){this.inActiveFrame=!0;a.Lang.isFunction(this.hideError)&&a.Do.after(function(){var a=b.dialog;a&&a.clearError(this)},this,"hideError",this);a.Do.after(function(){this.after(this.get("id")+"|dataChange",function(a){var e=b.dialog;e&&!a.silent&&e.fire("datachange",this);(e=this.get("name"))&&this.fire("value-changed",{name:e,value:a.newVal,oldValue:a.prevVal,field:this})},
this)},this,"bindUI",this);a.Do.after(function(){b&&b.defaultHidden&&this.hide(!0)},this,"syncUI",this)};d.NAME="dialogFieldLegacyInterface";d.prototype={temporaryHide:function(){this.hide()},temporaryShow:function(){this.show()},getName:function(){return this.get("name")},getType:function(){return this.name},getValue:function(){return this.get("data")},getErrors:function(){return this.get("errors")},getNode:function(){return this.get("boundingBox")},setValue:function(a){this.set("data",a)},clearError:function(){this.hideError()}}},
"1.0");
YUI.add("squarespace-flyout-error-message-template",function(a){var d=a.Handlebars;(function(){var a=d.template;(d.templates=d.templates||{})["flyout-error-message.html"]=a(function(a,b,d,g,h){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,a.helpers);h=h||{};a='<div class="sqs-flyout-error-message">';(d=d.message)?d=d.call(b,{hash:{},data:h}):(d=b.message,d="function"===typeof d?d.apply(b):d);if(d||0===d)a+=d;return a+"</div>"})})();a.Handlebars.registerPartial("flyout-error-message.html".replace("/","."),
d.templates["flyout-error-message.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-node-flyout",function(a){a.namespace("Squarespace.Animations").Flyout=a.Base.create("flyoutPlugin",a.Plugin.Base,[],{initializer:function(d){this._mask=a.Node.create('<div class="flyout-animation-wrapper sqs-flyout-mask"></div>');this._mask.setStyles({position:"fixed",overflow:this.get("overflow")});this._mask.setStyle("z-index","200000");this._mask.setStyle("zIndex","200000");this._isHiding=this._isShowing=!1},destructor:function(){this._anim&&this._anim.stop().destroy();this._mask.remove(!0);
a.detachAll(this.get("id")+"|*")},_onScroll:function(a){var b=this.get("host");(a.target.contains(b)||a.currentTarget.contains(b))&&this._updateMaskPosition()},_onResize:function(){this._updateMaskPosition()},show:function(){!this.get("visible")&&!this._isShowing&&this._animateFlyout(!0)},hide:function(){this.get("visible")&&!this._isHiding&&this._animateFlyout(!1)},_measureNode:function(d){return a.Squarespace.Utils.measureNode(d)},_animateFlyout:function(d){var b=this._mask,c=this.get("node");c.get("region");
var e=this._measureNode(c),f=this._getInitialFlyoutOffset();this._updateMaskPosition();this._anim&&(this._anim.stop(!0),this._anim=null);d&&(b.setStyles({height:e.height,width:e.width+1}),c.setStyles({position:"absolute",top:f.yOffset,left:f.xOffset}),b.appendChild(c),(this.get("renderTarget")||a.one("body")).appendChild(b));this._anim=new a.Anim({duration:this.get("duration"),easing:this.get("easing"),node:c,to:{top:d?0:f.yOffset,left:d?0:f.xOffset}});this.get("animateOpacity")&&(this._anim.set("from.opacity",
d?0:1),this._anim.set("to.opacity",d?1:0));this._anim.on(this._yuid+"|end",function(){this._anim=null;d?(this._isShowing=!1,this._mousewheelEvent=a.on(this.get("id")+"|mousewheel",this._onScroll,this),this._resizeEvent=a.one(window).on(this.get("id")+"|resize",this._onResize,this)):(this._isHiding=!1,c.remove(),b.remove(),this._mousewheelEvent&&(this._mousewheelEvent.detach(),this._mousewheelEvent=null),this._resizeEvent&&(this._resizeEvent.detach(),this._resizeEvent=null));this.set("visible",d);
this.fire(d?"shown":"hidden",{flyout:c});this.get("host").fire("flyout-"+d?"shown":"hidden",{flyout:c})},this);d?this._isShowing=!0:this._isHiding=!0;c.inDoc()&&this._anim.run()},_updateMaskPosition:function(){if(this._mask){var a=this._mask,b=this._getIntendedMaskPosition();a.setStyles({left:b.x,top:b.y});return b}},_getInitialFlyoutOffset:function(){var d=a.Squarespace.Animations.Flyout,b=this.get("alignment"),c=this._measureNode(this.get("node")),e;switch(b){case d.LT:case d.LC:case d.LR:e=c.width;
break;case d.TL:case d.TC:case d.TR:case d.BL:case d.BC:case d.BC:e=0;break;case d.RT:case d.RC:case d.RB:e=-1*c.width;break;default:throw"Flyout: This should never happened, check your alignment settings";}switch(b){case d.LT:case d.LC:case d.LB:case d.RT:case d.RC:case d.RB:d=0;break;case d.BL:case d.BC:case d.BR:d=-1*c.height;break;case d.TL:case d.TC:case d.TR:d=c.height;break;default:throw"Flyout: This should never happened, check your alignment settings";}return{xOffset:e,yOffset:d}},_getIntendedMaskPosition:function(){var d=
a.Squarespace.Animations.Flyout,b=this.get("alignment"),c=this.get("host").get("region"),e=this._measureNode(this.get("node")),f;f=a.DOM.docScrollY();var g=a.DOM.docScrollX();c.top-=f;c.bottom-=f;c.left-=g;c.right-=g;switch(b){case d.RT:case d.RC:case d.RB:f=c.right;break;case d.LT:case d.LC:case d.LB:f=c.left-e.width;break;case d.TL:case d.BL:f=c.left;break;case d.TC:case d.BC:f=c.left+c.width/2-e.width/2;break;case d.TR:case d.BR:f=c.right-e.width;break;default:throw"Flyout: This should never happened, check your alignment settings";
}switch(b){case d.TL:case d.TC:case d.TR:d=c.top-e.height;break;case d.LT:case d.RT:d=c.top;break;case d.LC:case d.RC:d=c.top+c.height/2-e.height/2;break;case d.LB:case d.RB:d=c.bottom-e.height;break;case d.BL:case d.BC:case d.BR:d=c.bottom;break;default:throw"Flyout: This should never happened, check your alignment settings";}return{x:f,y:d}}},{NS:"flyoutPlugin",TL:"tl",TC:"tc",TR:"tr",RT:"rt",RC:"rc",RB:"rb",BC:"bc",BL:"bl",BR:"br",LT:"lt",LC:"lc",Lb:"lb",ATTRS:{duration:{value:0.3,validator:a.Lang.isNumber},
easing:{value:a.Easing.easeOutStrong},alignment:{value:"rt",validator:function(d){var b=a.Squarespace.Animations.Flyout;switch(d){case b.TL:case b.TC:case b.TR:case b.LT:case b.RT:case b.LC:case b.RC:case b.LB:case b.RB:case b.BL:case b.BC:case b.BR:return!0;default:return console.warn(this.name+": Invalid alignment value ("+d+")"),!1}}},node:{value:null},animateOpacity:{value:!0},renderTarget:{valueFn:function(){var d=this.get("host");return d instanceof a.Node&&d.ancestor("body")?d.ancestor("body"):
a.one("body")}},overflow:{value:"hidden"},visible:{value:!1}}})},"1.0",{requires:["plugin","node","squarespace-util"]});
YUI.add("squarespace-widgets-data-widget",function(a){a.namespace("Squarespace.Widgets");var d=a.Squarespace.Widgets.DataWidget=a.Base.create("dataWidget",a.Squarespace.Widgets.SSWidget,[],{initializer:function(a){a.dataState||(this.getProperty("ASYNC_DATA")?this.set("dataState",this.getProperty("DATA_STATES").INITIALIZED):this.set("dataState",this.getProperty("DATA_STATES").LOADED))},renderUI:function(){d.superclass.renderUI.call(this);this._updateDataStateClassName()},bindUI:function(){d.superclass.bindUI.call(this);
var a=this.get("id");this.after(a+"|dataChange",function(a){a.noSyncUI||this.syncUI()},this);this.after(a+"|dataStateChange",this._updateDataStateClassName,this)},_updateDataStateClassName:function(){var b=this.get("boundingBox"),c=this.get("dataState");a.Object.each(this.getProperty("DATA_STATES"),function(a){b.removeClass("data-state-"+a)});b.addClass("data-state-"+c)},setLoadingState:function(){return this.set("dataState",this.getProperty("DATA_STATES").LOADING)},setLoadedState:function(){return this.set("dataState",
this.getProperty("DATA_STATES").LOADED)},setLoadFailedState:function(){return this.set("dataState",this.getProperty("DATA_STATES").LOAD_FAILED)},loadedSuccessfully:function(){return this.get("dataState")===this.getProperty("DATA_STATES").LOADED},isLoading:function(){return this.get("dataState")===this.getProperty("DATA_STATES").LOADING},loadFailed:function(){return this.get("dataState")===this.getProperty("DATA_STATES").LOAD_FAILED}},{CSS_PREFIX:"sqs-data-widget",ASYNC_DATA:!1,DATA_STATES:{INITIALIZED:"initialized",
LOADING:"loading",LOADED:"loaded",LOAD_FAILED:"load-failed"},ATTRS:{data:{value:null,validator:function(b){return a.Lang.isUndefined(b)?(console.warn(this.name+": Will not set data to undefined."),!1):!0}},dataState:{valueFn:function(){return this.getProperty("DATA_STATES").INITIALIZED}},preventRenderTemplate:{value:!1,validator:a.Squarespace.AttrValidators.isBoolean}}})},"1.0",{requires:["base","node","widget","squarespace-ss-widget","squarespace-attr-validators"]});
YUI.add("widget-anim",function(a,d){function b(a){b.superclass.constructor.apply(this,arguments)}b.NS="anim";b.NAME="pluginWidgetAnim";b.ANIMATIONS={fadeIn:function(){var b=this.get("host"),e=b.get("boundingBox"),d=new a.Anim({node:e,to:{opacity:1},duration:this.get("duration")});b.get("visible")||e.setStyle("opacity",0);d.on("destroy",function(){this.get("node").setStyle("opacity",a.UA.ie?1:"")});return d},fadeOut:function(){return new a.Anim({node:this.get("host").get("boundingBox"),to:{opacity:0},
duration:this.get("duration")})}};b.ATTRS={duration:{value:0.2},animShow:{valueFn:b.ANIMATIONS.fadeIn},animHide:{valueFn:b.ANIMATIONS.fadeOut}};a.extend(b,a.Plugin.Base,{initializer:function(a){this._bindAnimShow();this._bindAnimHide();this.after("animShowChange",this._bindAnimShow);this.after("animHideChange",this._bindAnimHide);this.beforeHostMethod("_uiSetVisible",this._uiAnimSetVisible)},destructor:function(){this.get("animShow").destroy();this.get("animHide").destroy()},_uiAnimSetVisible:function(b){if(this.get("host").get("rendered"))return b?
(this.get("animHide").stop(),this.get("animShow").run()):(this.get("animShow").stop(),this.get("animHide").run()),new a.Do.Prevent},_uiSetVisible:function(a){var b=this.get("host"),d=b.getClassName("hidden");b.get("boundingBox").toggleClass(d,!a)},_bindAnimShow:function(){this.get("animShow").on("start",a.bind(function(){this._uiSetVisible(!0)},this))},_bindAnimHide:function(){this.get("animHide").after("end",a.bind(function(){this._uiSetVisible(!1)},this))}});a.namespace("Plugin").WidgetAnim=b},
"3.17.2",{requires:["anim-base","plugin","widget"]});
YUI.add("widget-child",function(a,d){function b(){a.after(this._syncUIChild,this,"syncUI");a.after(this._bindUIChild,this,"bindUI")}var c=a.Lang;b.ATTRS={selected:{value:0,validator:c.isNumber},index:{readOnly:!0,getter:function(){var a=this.get("parent"),b=-1;a&&(b=a.indexOf(this));return b}},parent:{readOnly:!0},depth:{readOnly:!0,getter:function(){for(var a=this.get("parent"),b=this.get("root"),c=-1;a;){c+=1;if(a==b)break;a=a.get("parent")}return c}},root:{readOnly:!0,getter:function(){var b=function(c){var d=
c.get("parent"),h=c.ROOT_TYPE,k=d;h&&(k=d&&a.instanceOf(d,h));return k?b(d):c};return b(this)}}};b.prototype={ROOT_TYPE:null,_getUIEventNode:function(){var a=this.get("root"),b;a&&(b=a.get("boundingBox"));return b},next:function(a){var b=this.get("parent"),c;b&&(c=b.item(this.get("index")+1));!c&&a&&(c=b.item(0));return c},previous:function(a){var b=this.get("parent"),c=this.get("index"),d;b&&0<c&&(d=b.item([c-1]));!d&&a&&(d=b.item(b.size()-1));return d},remove:function(b){var d,g;c.isNumber(b)?g=
a.WidgetParent.prototype.remove.apply(this,arguments):(d=this.get("parent"))&&(g=d.remove(this.get("index")));return g},isRoot:function(){return this==this.get("root")},ancestor:function(a){var b=this.get("root"),c;if(this.get("depth")>a)for(c=this.get("parent");c!=b&&c.get("depth")>a;)c=c.get("parent");return c},_uiSetChildSelected:function(a){var b=this.get("boundingBox"),c=this.getClassName("selected");0===a?b.removeClass(c):b.addClass(c)},_afterChildSelectedChange:function(a){this._uiSetChildSelected(a.newVal)},
_syncUIChild:function(){this._uiSetChildSelected(this.get("selected"))},_bindUIChild:function(){this.after("selectedChange",this._afterChildSelectedChange)}};a.WidgetChild=b},"3.17.2",{requires:["base-build","widget"]});
YUI.add("widget-parent",function(a,d){function b(b){this.publish("addChild",{defaultTargetOnly:!0,defaultFn:this._defAddChildFn});this.publish("removeChild",{defaultTargetOnly:!0,defaultFn:this._defRemoveChildFn});this._items=[];var c,d;b&&b.children&&(c=b.children,d=this.after("initializedChange",function(a){this._add(c);d.detach()}));a.after(this._renderChildren,this,"renderUI");a.after(this._bindUIParent,this,"bindUI");this.after("selectionChange",this._afterSelectionChange);this.after("selectedChange",
this._afterParentSelectedChange);this.after("activeDescendantChange",this._afterActiveDescendantChange);this._hDestroyChild=this.after("*:destroy",this._afterDestroyChild);this.after("*:focusedChange",this._updateActiveDescendant)}var c=a.Lang;b.ATTRS={defaultChildType:{setter:function(b){var d=a.Attribute.INVALID_VALUE;b=c.isString(b)?a[b]:b;c.isFunction(b)&&(d=b);return d}},activeDescendant:{readOnly:!0},multiple:{value:!1,validator:c.isBoolean,writeOnce:!0,getter:function(a){var b=this.get("root");
return b&&b!=this?b.get("multiple"):a}},selection:{readOnly:!0,setter:"_setSelection",getter:function(b){return c.isArray(b)?new a.ArrayList(b):b}},selected:{setter:function(b){var c=b;1===b&&!this.get("multiple")&&(c=a.Attribute.INVALID_VALUE);return c}}};b.prototype={destructor:function(){this._destroyChildren()},_afterDestroyChild:function(a){a=a.target;a.get("parent")==this&&a.remove()},_afterSelectionChange:function(b){if(b.target==this&&b.src!=this){b=b.newVal;var c=0;b&&(c=2,a.instanceOf(b,
a.ArrayList)&&b.size()===this.size()&&(c=1));this.set("selected",c,{src:this})}},_afterActiveDescendantChange:function(a){var b=this.get("parent");b&&b._set("activeDescendant",a.newVal)},_afterParentSelectedChange:function(a){var b=a.newVal;this==a.target&&(a.src!=this&&(0===b||1===b))&&this.each(function(a){a.set("selected",b,{src:this})},this)},_setSelection:function(a){var b=null,c;this.get("multiple")&&!this.isEmpty()?(c=[],this.each(function(a){0<a.get("selected")&&c.push(a)}),0<c.length&&(b=
c)):0<a.get("selected")&&(b=a);return b},_updateSelection:function(a){var b=a.target,c;b.get("parent")==this&&("_updateSelection"!=a.src&&(c=this.get("selection"),!this.get("multiple")&&(c&&0<a.newVal)&&c.set("selected",0,{src:"_updateSelection"}),this._set("selection",b)),a.src==this&&this._set("selection",b,{src:this}))},_updateActiveDescendant:function(a){this._set("activeDescendant",!0===a.newVal?a.target:null)},_createChild:function(b){var d=this.get("defaultChildType"),g=b.childType||b.type,
h,k,m;g&&(k=c.isString(g)?a[g]:g);c.isFunction(k)?m=k:d&&(m=d);m?h=new m(b):a.error("Could not create a child instance because its constructor is either undefined or invalid.");return h},_defAddChildFn:function(b){var d=b.child,g=b.index,h=this._items;d.get("parent")&&d.remove();c.isNumber(g)?h.splice(g,0,d):h.push(d);d._set("parent",this);d.addTarget(this);b.index=d.get("index");d.after("selectedChange",a.bind(this._updateSelection,this))},_defRemoveChildFn:function(a){var b=a.child;a=a.index;var c=
this._items;b.get("focused")&&b.blur();b.get("selected")&&b.set("selected",0);c.splice(a,1);b.removeTarget(this);b._oldParent=b.get("parent");b._set("parent",null)},_add:function(b,d){var g,h,k;c.isArray(b)?(g=[],a.each(b,function(a,b){(h=this._add(a,d+b))&&g.push(h)},this),0<g.length&&(k=g)):(h=a.instanceOf(b,a.Widget)?b:this._createChild(b))&&this.fire("addChild",{child:h,index:d})&&(k=h);return k},add:function(){var b=this._add.apply(this,arguments),b=b?c.isArray(b)?b:[b]:[];return new a.ArrayList(b)},
remove:function(a){var b=this._items[a],c;b&&this.fire("removeChild",{child:b,index:a})&&(c=b);return c},removeAll:function(){var b=[],c;a.each(this._items.concat(),function(){(c=this.remove(0))&&b.push(c)},this);return new a.ArrayList(b)},selectChild:function(a){this.item(a).set("selected",1)},selectAll:function(){this.set("selected",1)},deselectAll:function(){this.set("selected",0)},_uiAddChild:function(a,b){a.render(b);var c=a.get("boundingBox"),d;(d=a.next(!1))&&d.get("rendered")?(d=d.get("boundingBox"),
d.insert(c,"before")):(d=a.previous(!1))&&d.get("rendered")?(d=d.get("boundingBox"),d.insert(c,"after")):b.contains(c)||b.appendChild(c)},_uiRemoveChild:function(a){a.get("boundingBox").remove()},_afterAddChild:function(a){a=a.child;a.get("parent")==this&&this._uiAddChild(a,this._childrenContainer)},_afterRemoveChild:function(a){a=a.child;a._oldParent==this&&this._uiRemoveChild(a)},_bindUIParent:function(){this.after("addChild",this._afterAddChild);this.after("removeChild",this._afterRemoveChild)},
_renderChildren:function(){var a=this._childrenContainer||this.get("contentBox");this._childrenContainer=a;this.each(function(b){b.render(a)})},_destroyChildren:function(){this._hDestroyChild.detach();this.each(function(a){a.destroy()})}};a.augment(b,a.ArrayList);a.WidgetParent=b},"3.17.2",{requires:["arraylist","base-build","widget"]});
YUI.add("squarespace-dialog-fields",function(a){a.namespace("Squarespace");a.Squarespace.DialogField=Class.extend(a.Squarespace.Gizmo,{_name:"DialogField",initialize:function(d,b,c){this._super();this.config=a.merge({defaultHidden:!1},d);this.dialog=this.panel=c;this.initialData=a.merge({},b);this.className="";this.inActiveFrame=!0;this.config&&("undefined"!==typeof this.config.name&&this.config.name in b)&&(this.value=b[this.config.name])},hide:function(a){this.temporaryHide(a)},getTakenHeight:function(){return this.html.get("offsetHeight")},
show:function(a){this.temporaryShow(a)},getName:function(){return this.config.name},getType:function(){return this.type},getDialog:function(){return this.dialog},append:function(a){a.append(this.html);this.config.defaultHidden&&this.temporaryHide(!1)},resize:function(){},isValid:function(){return 0<this.getErrors().length},getErrors:function(){return this.config.validator&&this.config.validationErrorMsg&&!this.config.validator.call(this,this.dialog)?[this.config.validationErrorMsg]:[]},showError:function(d){if(d){var b=
this.errorFlyoutAnchor||this.control;b||console.error("dialog-field: [DialogField] No control or error flyout anchor set to throw form field error on. Set this.control or this.errorFlyoutAnchor to a node.");b.hasPlugin("flyoutPlugin")||b.plug(a.Squarespace.Animations.Flyout,{duration:0.3});b=b.flyoutPlugin;b.get("visible")?(this._showErrorSub&&this._showErrorSub.detach(),this._showErrorSub=b.once(this.getId()+"|hidden",function(){this._showErrorSub=null;this._doShowErrorFlyout(d)},this),b.hide()):
this._doShowErrorFlyout(d)}},_doShowErrorFlyout:function(d){var b=this.errorFlyoutAnchor||this.control,c=b.flyoutPlugin;this.html.addClass("error");this._errorEl||(this._errorEl=a.DB.DIV("flyout-error-message",{html:d}),this._errorEl.setStyle("zIndex",this.dialog.zIndex+10),this._errorEl.on(this.getId()+"|click",function(a){a.halt()},this));this._errorEl.setContent(d);d=a.Squarespace.Utils.measureNode(this._errorEl).width;b=b.getX()+b.get("offsetWidth")-(this.html.hasClass("thin")?-10:1)+d;d=a.one(window).get("region").right;
(b=b>d)&&this._errorEl.addClass("out-from-left");c.setAttrs({node:this._errorEl,alignment:b?"lt":"rt"});this._clearErrorSub=a.on(this.getId()+"|click",this.clearError,this.errorEl,this);c.show()},hideError:function(){var a=this.errorFlyoutAnchor||this.control;a&&(a.hasPlugin("flyoutPlugin")&&a.flyoutPlugin.get("visible"))&&(this._clearErrorSub&&this._clearErrorSub.detach(),a=a.flyoutPlugin,this._subscribeOnce(a,this.getId()+"|hidden",function(a){this.html.removeClass("error")},this),a.hide())},clearError:function(){this.dialog.clearError(this);
this.hideError()},scrollIntoView:function(){this.html.scrollIntoView()},updateInlineTitle:function(){},setHeight:function(a){this.control&&this.control.setStyle("height",a+"px")},getValue:function(){return this.value},setValue:function(a){var b=this.value;this.value=a;"config"in this&&"name"in this.config&&this.fire("value-changed",{name:this.config.name,value:a,oldValue:b,field:this})},temporaryHide:function(d){this.fire("hide",this);this.hidden=!0;this.hideAnim&&this.hideAnim.stop();d?(this.html.setStyle("display",
"none"),this.fire("hidden",this)):(this.hideAnim=this._anim({node:this.html,to:{opacity:0},duration:0.35,easing:a.Easing.easeOutStrong}),this.hideAnim.on("end",function(){this.html.setStyle("display","none");this.fire("hidden",this)},this),this.hideAnim.run())},temporaryShow:function(){this.fire("show",this);this.hidden=!1;this.hideAnim&&this.hideAnim.stop();this.html.setStyle("display","block");this.hideAnim=this._anim({node:this.html,to:{opacity:1},duration:0.35,easing:a.Easing.easeOutStrong});
this.hideAnim.on("end",function(){a.fire("shown",this);a.fire("showing",this);this.fire("shown")},this);this.hideAnim.run()},getNode:function(){return this.html},didDataChange:function(){return this.config.ignoreChanges?!1:!this.initialData||a.Lang.isUndefined(this.initialData[this.getName()])&&""===this.getValue()?!1:a.Lang.isArray(this.initialData[this.getName()])?a.JSON.stringify(this.initialData[this.getName()])!==a.JSON.stringify(this.getValue()):this.getValue()!==this.initialData[this.getName()]}})},
"1.0",{requires:"node datatype-date node-focusmanager anim dd attribute slider datatable json widget node-event-simulate calendar squarespace-gizmo squarespace-dombuilder squarespace-debugger squarespace-toggle squarespace-node-flyout squarespace-structured-input squarespace-mailcheck squarespace-util".split(" ")});
YUI.add("slider-base",function(a,d){function b(){b.superclass.constructor.apply(this,arguments)}var c=a.Attribute.INVALID_VALUE;a.SliderBase=a.extend(b,a.Widget,{initializer:function(){this.axis=this.get("axis");this._key={dim:"y"===this.axis?"height":"width",minEdge:"y"===this.axis?"top":"left",maxEdge:"y"===this.axis?"bottom":"right",xyIndex:"y"===this.axis?1:0};this.publish("thumbMove",{defaultFn:this._defThumbMoveFn,queuable:!0})},renderUI:function(){var a=this.get("contentBox");this.rail=this.renderRail();
this._uiSetRailLength(this.get("length"));this.thumb=this.renderThumb();this.rail.appendChild(this.thumb);a.appendChild(this.rail);a.addClass(this.getClassName(this.axis))},renderRail:function(){var b=this.getClassName("rail","cap",this._key.minEdge),c=this.getClassName("rail","cap",this._key.maxEdge);return a.Node.create(a.Lang.sub(this.RAIL_TEMPLATE,{railClass:this.getClassName("rail"),railMinCapClass:b,railMaxCapClass:c}))},_uiSetRailLength:function(a){this.rail.setStyle(this._key.dim,a)},renderThumb:function(){this._initThumbUrl();
var b=this.get("thumbUrl");return a.Node.create(a.Lang.sub(this.THUMB_TEMPLATE,{thumbClass:this.getClassName("thumb"),thumbShadowClass:this.getClassName("thumb","shadow"),thumbImageClass:this.getClassName("thumb","image"),thumbShadowUrl:b,thumbImageUrl:b,thumbAriaLabelId:this.getClassName("label",a.guid())}))},_onThumbClick:function(a){this.thumb.focus()},bindUI:function(){var b=this.get("boundingBox"),c=!a.UA.opera?"down:":"press:",d=c+"37,39",h=c+"37+meta,39+meta";b.on("key",this._onDirectionKey,
c+"38,40,33,34,35,36",this);b.on("key",this._onLeftRightKey,d,this);b.on("key",this._onLeftRightKeyMeta,h,this);this.thumb.on("click",this._onThumbClick,this);this._bindThumbDD();this._bindValueLogic();this.after("disabledChange",this._afterDisabledChange);this.after("lengthChange",this._afterLengthChange)},_incrMinor:function(){this.set("value",this.get("value")+this.get("minorStep"))},_decrMinor:function(){this.set("value",this.get("value")-this.get("minorStep"))},_incrMajor:function(){this.set("value",
this.get("value")+this.get("majorStep"))},_decrMajor:function(){this.set("value",this.get("value")-this.get("majorStep"))},_setToMin:function(a){this.set("value",this.get("min"))},_setToMax:function(a){this.set("value",this.get("max"))},_onDirectionKey:function(a){a.preventDefault();if(!1===this.get("disabled"))switch(a.charCode){case 38:this._incrMinor();break;case 40:this._decrMinor();break;case 36:this._setToMin();break;case 35:this._setToMax();break;case 33:this._incrMajor();break;case 34:this._decrMajor()}},
_onLeftRightKey:function(a){a.preventDefault();if(!1===this.get("disabled"))switch(a.charCode){case 37:this._decrMinor();break;case 39:this._incrMinor()}},_onLeftRightKeyMeta:function(a){a.preventDefault();if(!1===this.get("disabled"))switch(a.charCode){case 37:this._setToMin();break;case 39:this._setToMax()}},_bindThumbDD:function(){var b={constrain:this.rail};b["stick"+this.axis.toUpperCase()]=!0;this._dd=new a.DD.Drag({node:this.thumb,bubble:!1,on:{"drag:start":a.bind(this._onDragStart,this)},
after:{"drag:drag":a.bind(this._afterDrag,this),"drag:end":a.bind(this._afterDragEnd,this)}});this._dd.plug(a.Plugin.DDConstrained,b)},_bindValueLogic:function(){},_uiMoveThumb:function(a,b){this.thumb&&(this.thumb.setStyle(this._key.minEdge,a+"px"),b||(b={}),b.offset=a,this.fire("thumbMove",b))},_onDragStart:function(a){this.fire("slideStart",{ddEvent:a,originEvent:a})},_afterDrag:function(a){this.fire("thumbMove",{offset:a.info.xy[this._key.xyIndex]-a.target.con._regionCache[this._key.minEdge],
ddEvent:a,originEvent:a})},_afterDragEnd:function(a){this.fire("slideEnd",{ddEvent:a,originEvent:a})},_afterDisabledChange:function(a){this._dd.set("lock",a.newVal)},_afterLengthChange:function(a){this.get("rendered")&&(this._uiSetRailLength(a.newVal),this.syncUI())},syncUI:function(){this._dd.con.resetCache();this._syncThumbPosition();this.thumb.set("aria-valuemin",this.get("min"));this.thumb.set("aria-valuemax",this.get("max"));this._dd.set("lock",this.get("disabled"))},_syncThumbPosition:function(){},
_setAxis:function(a){a=(a+"").toLowerCase();return"x"===a||"y"===a?a:c},_setLength:function(a){a=(a+"").toLowerCase();var b=parseFloat(a,10);a=a.replace(/[\d\.\-]/g,"")||this.DEF_UNIT;return 0<b?b+a:c},_initThumbUrl:function(){if(!this.get("thumbUrl")){var b=this.getSkinName()||"sam",c=a.config.base;0===c.indexOf("http://yui.yahooapis.com/combo")&&(c="http://yui.yahooapis.com/"+a.version+"/build/");this.set("thumbUrl",c+"slider-base/assets/skins/"+b+"/thumb-"+this.axis+".png")}},BOUNDING_TEMPLATE:"<span></span>",
CONTENT_TEMPLATE:"<span></span>",RAIL_TEMPLATE:'<span class="{railClass}"><span class="{railMinCapClass}"></span><span class="{railMaxCapClass}"></span></span>',THUMB_TEMPLATE:'<span class="{thumbClass}" aria-labelledby="{thumbAriaLabelId}" aria-valuetext="" aria-valuemax="" aria-valuemin="" aria-valuenow="" role="slider" tabindex="0"><img src="{thumbShadowUrl}" alt="Slider thumb shadow" class="{thumbShadowClass}"><img src="{thumbImageUrl}" alt="Slider thumb" class="{thumbImageClass}"></span>'},{NAME:"sliderBase",
ATTRS:{axis:{value:"x",writeOnce:!0,setter:"_setAxis",lazyAdd:!1},length:{value:"150px",setter:"_setLength"},thumbUrl:{value:null,validator:a.Lang.isString}}})},"3.17.2",{requires:["widget","dd-constrain","event-key"],skinnable:!0});
YUI.add("slider-value-range",function(a,d){var b=Math.round;a.SliderValueRange=a.mix(function(){this._initSliderValueRange()},{prototype:{_factor:1,_initSliderValueRange:function(){},_bindValueLogic:function(){this.after({minChange:this._afterMinChange,maxChange:this._afterMaxChange,valueChange:this._afterValueChange})},_syncThumbPosition:function(){this._calculateFactor();this._setPosition(this.get("value"))},_calculateFactor:function(){var a=this.get("length"),b=this.thumb.getStyle(this._key.dim),
d=this.get("min"),g=this.get("max"),a=parseFloat(a)||150,b=parseFloat(b)||15;this._factor=(g-d)/(a-b)},_defThumbMoveFn:function(a){"set"!==a.source&&this.set("value",this._offsetToValue(a.offset))},_offsetToValue:function(a){a=b(a*this._factor)+this.get("min");return b(this._nearestValue(a))},_valueToOffset:function(a){return b((a-this.get("min"))/this._factor)},getValue:function(){return this.get("value")},setValue:function(a){return this.set("value",a)},_afterMinChange:function(a){this._verifyValue();
this._syncThumbPosition()},_afterMaxChange:function(a){this._verifyValue();this._syncThumbPosition()},_verifyValue:function(){var a=this.get("value"),b=this._nearestValue(a);a!==b&&this.set("value",b)},_afterValueChange:function(a){this._setPosition(a.newVal,{source:"set"})},_setPosition:function(a,b){this._uiMoveThumb(this._valueToOffset(a),b);this.thumb.set("aria-valuenow",a);this.thumb.set("aria-valuetext",a)},_validateNewMin:function(b){return a.Lang.isNumber(b)},_validateNewMax:function(b){return a.Lang.isNumber(b)},
_setNewValue:function(c){return a.Lang.isNumber(c)?b(this._nearestValue(c)):a.Attribute.INVALID_VALUE},_nearestValue:function(a){var b=this.get("min"),d=this.get("max"),g;g=d>b?d:b;b=d>b?b:d;d=g;return a<b?b:a>d?d:a}},ATTRS:{min:{value:0,validator:"_validateNewMin"},max:{value:100,validator:"_validateNewMax"},minorStep:{value:1},majorStep:{value:10},value:{value:0,setter:"_setNewValue"}}},!0)},"3.17.2",{requires:["slider-base"]});
YUI.add("clickable-rail",function(a,d){a.ClickableRail=a.mix(function(){this._initClickableRail()},{prototype:{_initClickableRail:function(){this._evtGuid=this._evtGuid||a.guid()+"|";this.publish("railMouseDown",{defaultFn:this._defRailMouseDownFn});this.after("render",this._bindClickableRail);this.on("destroy",this._unbindClickableRail)},_bindClickableRail:function(){this._dd.addHandle(this.rail);this.rail.on(this._evtGuid+a.DD.Drag.START_EVENT,a.bind(this._onRailMouseDown,this))},_unbindClickableRail:function(){this.get("rendered")&&
this.get("contentBox").one("."+this.getClassName("rail")).detach(this.evtGuid+"*")},_onRailMouseDown:function(a){this.get("clickableRail")&&!this.get("disabled")&&(this.fire("railMouseDown",{ev:a}),this.thumb.focus())},_defRailMouseDownFn:function(a){a=a.ev;var c=this._resolveThumb(a),d=this._key.xyIndex,f=parseFloat(this.get("length"),10),g,h;c&&(g=c.get("dragNode"),h=parseFloat(g.getStyle(this._key.dim),10),g=this._getThumbDestination(a,g),g=g[d]-this.rail.getXY()[d],g=Math.min(Math.max(g,0),f-
h),this._uiMoveThumb(g,{source:"rail"}),a.target=this.thumb.one("img")||this.thumb,c._handleMouseDownEvent(a))},_resolveThumb:function(a){return this._dd},_getThumbDestination:function(a,c){var d=c.get("offsetWidth"),f=c.get("offsetHeight");return[a.pageX-Math.round(d/2),a.pageY-Math.round(f/2)]}},ATTRS:{clickableRail:{value:!0,validator:a.Lang.isBoolean}}},!0)},"3.17.2",{requires:["slider-base"]});
YUI.add("range-slider",function(a,d){a.Slider=a.Base.build("slider",a.SliderBase,[a.SliderValueRange,a.ClickableRail])},"3.17.2",{requires:["slider-base","slider-value-range","clickable-rail"]});
YUI.add("datatable-core",function(a,d){var b=a.Attribute.INVALID_VALUE,c=a.Lang,e=c.isFunction,f=c.isObject,g=c.isArray,h=c.isString,k=c.isNumber,m=a.Array,l=a.Object.keys,c=a.namespace("DataTable").Core=function(){};c.ATTRS={columns:{validator:g,setter:"_setColumns",getter:"_getColumns"},recordType:{getter:"_getRecordType",setter:"_setRecordType"},data:{valueFn:"_initData",setter:"_setData",lazyAdd:!1},recordset:{setter:"_setRecordset",getter:"_getRecordset",lazyAdd:!1},columnset:{setter:"_setColumnset",
getter:"_getColumnset",lazyAdd:!1}};a.mix(c.prototype,{getColumn:function(a){var b,c,d;if(b=f(a)&&!g(a)?a&&a._node?this.body.getColumn(a):a:this.get("columns."+a))return b;b=this.get("columns");if(k(a)||g(a)){a=m(a);d=b;b=0;for(c=a.length-1;d&&b<c;++b)d=d[a[b]]&&d[a[b]].children;return d&&d[a[b]]||null}return null},getRecord:function(a){var b=this.data.getById(a)||this.data.getByClientId(a);b||(k(a)&&(b=this.data.item(a)),!b&&(this.view&&this.view.getRecord)&&(b=this.view.getRecord.apply(this.view,
arguments)));return b||null},_allowAdHocAttrs:!0,_afterColumnsChange:function(a){this._setColumnMap(a.newVal)},_afterDataChange:function(a){var b=a.newVal;this.data=a.newVal;!this.get("columns")&&b.size()&&this._initColumns()},_afterRecordTypeChange:function(a){var b=this.data.toJSON();this.data.model=a.newVal;this.data.reset(b);!this.get("columns")&&b&&(b.length?this._initColumns():this.set("columns",l(a.newVal.ATTRS)))},_createRecordClass:function(b){var c,d,e;if(g(b)){c={};d=0;for(e=b.length;d<
e;++d)c[b[d]]={}}else f(b)&&(c=b);return a.Base.create("record",a.Model,[],null,{ATTRS:c})},destructor:function(){(new a.EventHandle(a.Object.values(this._eventHandles))).detach()},_getColumns:function(a,b){return 8<b.length?this._columnMap:a},_getColumnset:function(a,b){return this.get(b.replace(/^columnset/,"columns"))},_getRecordType:function(a){return a||this.data&&this.data.model},_initColumns:function(){var a=this.get("columns")||[],b;!a.length&&this.data.size()&&(b=this.data.item(0),b.toJSON&&
(b=b.toJSON()),this.set("columns",l(b)));this._setColumnMap(a)},_initCoreEvents:function(){this._eventHandles.coreAttrChanges=this.after({columnsChange:a.bind("_afterColumnsChange",this),recordTypeChange:a.bind("_afterRecordTypeChange",this),dataChange:a.bind("_afterDataChange",this)})},_initData:function(){var b=this.get("recordType"),c=new a.ModelList;b&&(c.model=b);return c},_initDataProperty:function(b){var c;this.data||(c=this.get("recordType"),this.data=b&&b.each&&b.toJSON?b:new a.ModelList,
c&&(this.data.model=c),this.data.addTarget(this))},initializer:function(a){var b=a.data,c=a.columns;this._initDataProperty(b);c||((a=(a.recordType||a.data===this.data)&&this.get("recordType"))?c=l(a.ATTRS):g(b)&&b.length&&(c=l(b[0])),c&&this.set("columns",c));this._initColumns();this._eventHandles={};this._initCoreEvents()},_setColumnMap:function(a){function b(a){var d,e,f,g;d=0;for(e=a.length;d<e;++d)f=a[d],(g=f.key)&&!c[g]&&(c[g]=f),c[f._id]=f,f.children&&b(f.children)}var c={};b(a);this._columnMap=
c},_setColumns:function(b){function c(a){var b={},d,e,r;t.push(a);k.push(b);for(d in a)a.hasOwnProperty(d)&&(e=a[d],g(e)?b[d]=e.slice():f(e,!0)?(r=l(t,e),b[d]=-1===r?c(e):k[r]):b[d]=a[d]);return b}function d(b,f){var t=[],n,k,q,l;n=0;for(k=b.length;n<k;++n){t[n]=q=h(b[n])?{key:b[n]}:c(b[n]);l=a.stamp(q);q.id||(q.id=l);q.field&&(q.name=q.field);f?q._parent=f:delete q._parent;l=q;var m=q.name||q.key||q.id,m=m.replace(/\s+/,"-");e[m]?m+=e[m]++:e[m]=1;l._id=m;g(q.children)&&(q.children=d(q.children,q))}return t}
var e={},t=[],k=[],l=a.Array.indexOf;return b&&d(b)},_setColumnset:function(a){this.set("columns",a);return g(a)?a:b},_setData:function(a){null===a&&(a=[]);if(g(a))this._initDataProperty(),this.data.reset(a,{silent:!0}),a=this.data;else if(!a||!a.each||!a.toJSON)a=b;return a},_setRecordset:function(b){var c;b&&(a.Recordset&&b instanceof a.Recordset)&&(c=[],b.each(function(a){c.push(a.get("data"))}),b=c);this.set("data",b);return b},_setRecordType:function(a){var c;e(a)&&a.prototype.toJSON&&a.prototype.setAttrs?
c=a:f(a)&&(c=this._createRecordClass(a));return c||b}})},"3.17.2",{requires:["escape","model-list","node-event-delegate"]});
YUI.add("datatable-table",function(a,d){var b=a.Array,c=a.Lang,e=c.sub,f=c.isArray,g=c.isFunction;a.namespace("DataTable").TableView=a.Base.create("table",a.View,[],{CAPTION_TEMPLATE:'<caption class="{className}"></caption>',TABLE_TEMPLATE:'<table cellspacing="0" class="{className}"></table>',getCell:function(){return this.body&&this.body.getCell&&this.body.getCell.apply(this.body,arguments)},getClassName:function(){var c=this.host,d=c&&c.constructor.NAME||this.constructor.NAME;return c&&c.getClassName?
c.getClassName.apply(c,arguments):a.ClassNameManager.getClassName.apply(a.ClassNameManager,[d].concat(b(arguments,0,!0)))},getRecord:function(){return this.body&&this.body.getRecord&&this.body.getRecord.apply(this.body,arguments)},getRow:function(){return this.body&&this.body.getRow&&this.body.getRow.apply(this.body,arguments)},_afterSummaryChange:function(a){this._uiSetSummary(a.newVal)},_afterCaptionChange:function(a){this._uiSetCaption(a.newVal)},_afterWidthChange:function(a){this._uiSetWidth(a.newVal)},
_bindUI:function(){var b;this._eventHandles||(b=a.bind("_relayAttrChange",this),this._eventHandles=this.after({columnsChange:b,modelListChange:b,summaryChange:a.bind("_afterSummaryChange",this),captionChange:a.bind("_afterCaptionChange",this),widthChange:a.bind("_afterWidthChange",this)}))},_createTable:function(){return a.Node.create(e(this.TABLE_TEMPLATE,{className:this.getClassName("table")})).empty()},_defRenderBodyFn:function(a){a.view.render()},_defRenderFooterFn:function(a){a.view.render()},
_defRenderHeaderFn:function(a){a.view.render()},_defRenderTableFn:function(b){var c=this.get("container"),d=this.getAttrs();this.tableNode||(this.tableNode=this._createTable());d.host=this.get("host")||this;d.table=this;d.container=this.tableNode;this._uiSetCaption(this.get("caption"));this._uiSetSummary(this.get("summary"));this._uiSetWidth(this.get("width"));if(this.head||b.headerView)this.head||(this.head=new b.headerView(a.merge(d,b.headerConfig))),this.fire("renderHeader",{view:this.head});if(this.foot||
b.footerView)this.foot||(this.foot=new b.footerView(a.merge(d,b.footerConfig))),this.fire("renderFooter",{view:this.foot});d.columns=this.displayColumns;if(this.body||b.bodyView)this.body||(this.body=new b.bodyView(a.merge(d,b.bodyConfig))),this.fire("renderBody",{view:this.body});c.contains(this.tableNode)||c.append(this.tableNode);this._bindUI()},destructor:function(){this.head&&this.head.destroy&&this.head.destroy();delete this.head;this.foot&&this.foot.destroy&&this.foot.destroy();delete this.foot;
this.body&&this.body.destroy&&this.body.destroy();delete this.body;this._eventHandles&&(this._eventHandles.detach(),delete this._eventHandles);this.tableNode&&this.tableNode.remove().destroy(!0)},_extractDisplayColumns:function(){function a(b){var d,e,g;d=0;for(e=b.length;d<e;++d)g=b[d],f(g.children)?a(g.children):c.push(g)}var b=this.get("columns"),c=[];b&&a(b);this.displayColumns=c},_initEvents:function(){this.publish({renderTable:{defaultFn:a.bind("_defRenderTableFn",this)},renderHeader:{defaultFn:a.bind("_defRenderHeaderFn",
this)},renderBody:{defaultFn:a.bind("_defRenderBodyFn",this)},renderFooter:{defaultFn:a.bind("_defRenderFooterFn",this)}})},initializer:function(a){this.host=a.host;this._initEvents();this._extractDisplayColumns();this.after("columnsChange",this._extractDisplayColumns,this)},_relayAttrChange:function(a){var b=a.attrName;a=a.newVal;this.head&&this.head.set(b,a);this.foot&&this.foot.set(b,a);this.body&&("columns"===b&&(a=this.displayColumns),this.body.set(b,a))},render:function(){this.get("container")&&
this.fire("renderTable",{headerView:this.get("headerView"),headerConfig:this.get("headerConfig"),bodyView:this.get("bodyView"),bodyConfig:this.get("bodyConfig"),footerView:this.get("footerView"),footerConfig:this.get("footerConfig")});return this},_uiSetCaption:function(b){var c=this.tableNode,d=this.captionNode;b?(d||(this.captionNode=d=a.Node.create(e(this.CAPTION_TEMPLATE,{className:this.getClassName("caption")})),c.prepend(this.captionNode)),d.setHTML(b)):d&&(d.remove(!0),delete this.captionNode)},
_uiSetSummary:function(a){a?this.tableNode.setAttribute("summary",a):this.tableNode.removeAttribute("summary")},_uiSetWidth:function(a){var b=this.tableNode;b.setStyle("width",!a?"":this.get("container").get("offsetWidth")-(parseInt(b.getComputedStyle("borderLeftWidth"),10)||0)-(parseInt(b.getComputedStyle("borderLeftWidth"),10)||0)+"px");b.setStyle("width",a)},_validateView:function(a){return g(a)&&a.prototype.render}},{ATTRS:{columns:{validator:f},width:{value:"",validator:c.isString},headerView:{value:a.DataTable.HeaderView,
validator:"_validateView"},footerView:{validator:"_validateView"},bodyView:{value:a.DataTable.BodyView,validator:"_validateView"}}})},"3.17.2",{requires:["datatable-core","datatable-head","datatable-body","view","classnamemanager"]});
YUI.add("datatable-head",function(a,d){var b=a.Lang,c=b.sub,e=b.isArray,f=a.Array;a.namespace("DataTable").HeaderView=a.Base.create("tableHeader",a.View,[],{CELL_TEMPLATE:'<th id="{id}" colspan="{_colspan}" rowspan="{_rowspan}" class="{className}" scope="col" {_id}{abbr}{title}>{content}</th>',ROW_TEMPLATE:"<tr>{content}</tr>",THEAD_TEMPLATE:'<thead class="{className}"></thead>',getClassName:function(){var b=this.host,c=b&&b.constructor.NAME||this.constructor.NAME;return b&&b.getClassName?b.getClassName.apply(b,
arguments):a.ClassNameManager.getClassName.apply(a.ClassNameManager,[c].concat(f(arguments,0,!0)))},render:function(){var b=this.get("container"),d=this.theadNode||(this.theadNode=this._createTHeadNode()),e=this.columns,f={_colspan:1,_rowspan:1,abbr:"",title:""},l,n,p,r,s,t,q,z;if(d&&e){t="";if(e.length){l=0;for(n=e.length;l<n;++l){q="";p=0;for(r=e[l].length;p<r;++p)s=e[l][p],z=a.merge(f,s,{className:this.getClassName("header"),content:s.label||s.key||"Column "+(p+1)}),z._id=s._id?' data-yui3-col-id="'+
s._id+'"':"",s.abbr&&(z.abbr=' abbr="'+s.abbr+'"'),s.title&&(z.title=' title="'+s.title+'"'),s.className&&(z.className+=" "+s.className),s._first&&(z.className+=" "+this.getClassName("first","header")),s._id&&(z.className+=" "+this.getClassName("col",s._id)),q+=c(s.headerTemplate||this.CELL_TEMPLATE,z);t+=c(this.ROW_TEMPLATE,{content:q})}}d.setHTML(t);d.get("parentNode")!==b&&b.insertBefore(d,b.one("tfoot, tbody"))}this.bindUI();return this},_afterColumnsChange:function(a){this.columns=this._parseColumns(a.newVal);
this.render()},bindUI:function(){this._eventHandles.columnsChange||(this._eventHandles.columnsChange=this.after("columnsChange",a.bind("_afterColumnsChange",this)))},_createTHeadNode:function(){return a.Node.create(c(this.THEAD_TEMPLATE,{className:this.getClassName("columns")}))},destructor:function(){(new a.EventHandle(a.Object.values(this._eventHandles))).detach()},initializer:function(a){this.host=a.host;this.columns=this._parseColumns(a.columns);this._eventHandles=[]},_parseColumns:function(b){var c=
[],d=[],f=1,l,n,p,r,s,t,q;if(e(b)&&b.length){b=b.slice();for(d.push([b,-1]);d.length;){l=d[d.length-1];n=l[0];t=l[1]+1;for(q=n.length;t<q;++t)if(n[t]=p=a.merge(n[t]),r=p.children,a.stamp(p),p.id||(p.id=a.guid()),e(r)&&r.length){d.push([r,-1]);l[1]=t;f=Math.max(f,d.length);break}else p._colspan=1;if(t>=q){if(1<d.length){l=d[d.length-2];s=l[0][l[1]];t=s._colspan=0;for(q=n.length;t<q;++t)n[t]._parent=s,s._colspan+=n[t]._colspan}d.pop()}}for(t=0;t<f;++t)c.push([]);for(d.push([b,-1]);d.length;){l=d[d.length-
1];n=l[0];t=l[1]+1;for(q=n.length;t<q;++t){p=n[t];r=p.children;c[d.length-1].push(p);l[1]=t;p._headers=[p.id];for(b=d.length-2;0<=b;--b)s=d[b][0][d[b][1]],p._headers.unshift(s.id);if(r&&r.length){d.push([r,-1]);break}else p._rowspan=f-d.length+1}t>=q&&d.pop()}}t=0;for(q=c.length;t<q;t+=p._rowspan)p=c[t][0],p._first=!0;return c}})},"3.17.2",{requires:["datatable-core","view","classnamemanager"]});
YUI.add("view",function(a,d){function b(){b.superclass.constructor.apply(this,arguments)}a.View=a.extend(b,a.Base,{containerTemplate:"<div/>",events:{},template:"",_allowAdHocAttrs:!0,initializer:function(b){b||(b={});b.containerTemplate&&(this.containerTemplate=b.containerTemplate);b.template&&(this.template=b.template);this.events=b.events?a.merge(this.events,b.events):this.events;this.after("containerChange",this._afterContainerChange)},destroy:function(a){if(a&&(a.remove||a["delete"]))this.onceAfter("destroy",
function(){this._destroyContainer()});return b.superclass.destroy.call(this)},destructor:function(){this.detachEvents();delete this._container},attachEvents:function(b){var d=this.get("container"),f=a.Object.owns,g,h,k,m;this.detachEvents();b||(b=this.events);for(m in b)if(f(b,m))for(k in h=b[m],h)f(h,k)&&(g=h[k],"string"===typeof g&&(g=this[g]),g&&this._attachedViewEvents.push(d.delegate(k,g,m,this)));return this},create:function(b){return b?a.one(b):a.Node.create(this.containerTemplate)},detachEvents:function(){a.Array.each(this._attachedViewEvents,
function(a){a&&a.detach()});this._attachedViewEvents=[];return this},remove:function(){var a=this.get("container");a&&a.remove();return this},render:function(){return this},_destroyContainer:function(){var a=this.get("container");a&&a.remove(!0)},_getContainer:function(a){this._container||(a?(this._container=a,this.attachEvents()):(a=this._container=this.create(),this._set("container",a)));return a},_afterContainerChange:function(){this.attachEvents(this.events)}},{NAME:"view",ATTRS:{container:{getter:"_getContainer",
setter:a.one,writeOnce:!0}},_NON_ATTRS_CFG:["containerTemplate","events","template"]})},"3.17.2",{requires:["base-build","node-event-delegate"]});
YUI.add("datatable-body",function(a,d){var b=a.Lang,c=b.isArray,e=b.isNumber,f=b.isString,g=b.sub,h=a.Escape.html,k=a.Array,m=a.bind,l=a.Object,n=/\{value\}/g,p={above:[-1,0],below:[1,0],next:[0,1],prev:[0,-1],previous:[0,-1]};a.namespace("DataTable").BodyView=a.Base.create("tableBody",a.View,[],{CELL_TEMPLATE:'<td {headers} class="{className}">{content}</td>',ROW_TEMPLATE:'<tr id="{rowId}" data-yui3-record="{clientId}" class="{rowClass}">{content}</tr>',TBODY_TEMPLATE:'<tbody class="{className}"></tbody>',
getCell:function(b,d){var e=this.tbodyNode,g,n,h;b&&e&&(c(b)?n=(g=e.get("children").item(b[0]))&&g.get("children").item(b[1]):b._node&&(n=b.ancestor("."+this.getClassName("cell"),!0)),n&&d&&(g=e.get("firstChild.rowIndex"),f(d)&&(p[d]||a.error("Unrecognized shift: "+d,null,"datatable-body"),d=p[d]),c(d)&&(h=n.get("parentNode.rowIndex")+d[0]-g,g=e.get("children").item(h),h=n.get("cellIndex")+d[1],n=g&&g.get("children").item(h))));return n||null},getClassName:function(){var b=this.host;if(b&&b.getClassName)return b.getClassName.apply(b,
arguments);b=k(arguments);b.unshift(this.constructor.NAME);return a.ClassNameManager.getClassName.apply(a.ClassNameManager,b)},getRecord:function(a){var b=this.get("modelList"),c=this.tbodyNode,d=null,e;c&&(f(a)&&(a=c.one("#"+a)),a&&a._node&&(e=(d=a.ancestor(function(a){return a.get("parentNode").compareTo(c)},!0))&&b.getByClientId(d.getData("yui3-record"))));return e||null},getRow:function(a){var b=this.tbodyNode,c=null;b&&(a&&(a=this._idMap[a.get?a.get("clientId"):a]||a),c=e(a)?b.get("children").item(a):
b.one("#"+a));return c},render:function(){var a=this.get("container"),b=this.get("modelList"),c=this.get("columns"),d=this.tbodyNode||(this.tbodyNode=this._createTBodyNode());this._createRowTemplate(c);b&&(d.setHTML(this._createDataHTML(c)),this._applyNodeFormatters(d,c));d.get("parentNode")!==a&&a.appendChild(d);this.bindUI();return this},refreshRow:function(a,b,c){var d,e=c.length,f;for(f=0;f<e;f++)d=this.getColumn(c[f]),null!==d&&(d=a.one("."+this.getClassName("col",d._id||d.key)),this.refreshCell(d,
b));return this},refreshCell:function(b,c,d){var e,f,g=c.toJSON();b=this.getCell(b);c||(c=this.getRecord(b));d||(d=this.getColumn(b));if(d.nodeFormatter)c={cell:b.one("."+this.getClassName("liner"))||b,column:d,data:g,record:c,rowIndex:this._getRowIndex(b.ancestor("tr")),td:b,value:g[d.key]},keep=d.nodeFormatter.call(host,c),!1===keep&&b.destroy(!0);else if(d.formatter){d._formatterFn||(d=this._setColumnsFormatterFn([d])[0]);if(f=d._formatterFn||null)c={value:g[d.key],data:g,column:d,record:c,className:"",
rowClass:"",rowIndex:this._getRowIndex(b.ancestor("tr"))},e=f.call(this.get("host"),c),void 0===e&&(e=c.value);if(void 0===e||null===e||""===e)e=d.emptyCellValue||""}else e=g[d.key]||d.emptyCellValue||"";b.setHTML(d.allowHTML?e:a.Escape.html(e));return this},getColumn:function(b){b&&b._node&&(b=b.get("className").match(RegExp(this.getClassName("col")+"-([^ ]*)"))[1]);if(this.host)return this.host._columnMap[b]||null;var c=this.get("columns"),d=null;a.Array.some(c,function(a){if((a._id||a.key)===b)return d=
a,!0});return d},_afterColumnsChange:function(){this.render()},_afterDataChange:function(b){var c=(b.type.match(/:(add|change|remove)$/)||[])[1],d=b.index,e=this.get("columns"),f,g=b.changed&&a.Object.keys(b.changed),n,h;n=0;for(h=e.length;n<h;n++)if(f=e[n],f.hasOwnProperty("nodeFormatter")){this.render();this.fire("contentUpdate");return}switch(c){case "change":n=0;for(h=e.length;n<h;n++)f=e[n],d=f.key,f.formatter&&!b.changed[d]&&g.push(d);this.refreshRow(this.getRow(b.target),b.target,g);break;
case "add":d=Math.min(d,this.get("modelList").size()-1);this._setColumnsFormatterFn(e);b=a.Node.create(this._createRowHTML(b.model,d,e));this.tbodyNode.insert(b,d);this._restripe(d);break;case "remove":this.getRow(d).remove(!0);this._restripe(d-1);break;default:this.render()}this.fire("contentUpdate")},_restripe:function(a){var b=this._restripeTask,c;a=Math.max(a|0,0);b?b.index=Math.min(b.index,a):(c=this,this._restripeTask={timer:setTimeout(function(){if(c&&!c.get("destroy")&&c.tbodyNode&&c.tbodyNode.inDoc()){var a=
[c.CLASS_ODD,c.CLASS_EVEN],b=[c.CLASS_EVEN,c.CLASS_ODD],d=c._restripeTask.index;c.tbodyNode.get("childNodes").slice(d).each(function(c,e){c.replaceClass.apply(c,(d+e)%2?b:a)})}c._restripeTask=null},0),index:a})},_afterModelListChange:function(){var a=this._eventHandles;a.dataChange&&(a.dataChange.detach(),delete a.dataChange,this.bindUI());this.tbodyNode&&this.render()},_applyNodeFormatters:function(a,b){var c=this.host||this,d=this.get("modelList"),e=[],f="."+this.getClassName("liner"),g,n,h;n=0;
for(h=b.length;n<h;++n)b[n].nodeFormatter&&e.push(n);d&&e.length&&(g=a.get("childNodes"),d.each(function(a,d){var r={data:a.toJSON(),record:a,rowIndex:d},n=g.item(d),h,l,q,k,E;if(n){k=n.get("childNodes");n=0;for(h=e.length;n<h;++n)if(E=k.item(e[n]))l=r.column=b[e[n]],q=l.key||l.id,r.value=a.get(q),r.td=E,r.cell=E.one(f)||E,l=l.nodeFormatter.call(c,r),!1===l&&E.destroy(!0)}}))},bindUI:function(){var a=this._eventHandles,b=this.get("modelList"),c=b.model.NAME+":change";a.columnsChange||(a.columnsChange=
this.after("columnsChange",m("_afterColumnsChange",this)));b&&!a.dataChange&&(a.dataChange=b.after(["add","remove","reset",c],m("_afterDataChange",this)))},_createDataHTML:function(a){var b=this.get("modelList"),c="";b&&b.each(function(b,d){c+=this._createRowHTML(b,d,a)},this);return c},_createRowHTML:function(a,b,c){var d=a.toJSON(),e=a.get("clientId"),e={rowId:this._getRowId(e),clientId:e,rowClass:b%2?this.CLASS_ODD:this.CLASS_EVEN},f=this.host||this,n,l,k,p,m,C;n=0;for(l=c.length;n<l;++n)if(k=
c[n],m=d[k.key],p=k._id||k.key,e[p+"-className"]="",k._formatterFn&&(C={value:m,data:d,column:k,record:a,className:"",rowClass:"",rowIndex:b},m=k._formatterFn.call(f,C),void 0===m&&(m=C.value),e[p+"-className"]=C.className,e.rowClass+=" "+C.rowClass),!e.hasOwnProperty(p)||d.hasOwnProperty(k.key)){if(void 0===m||null===m||""===m)m=k.emptyCellValue||"";e[p]=k.allowHTML?m:h(m)}e.rowClass=e.rowClass.replace(/\s+/g," ");return g(this._rowTemplate,e)},_getRowIndex:function(a){var b=this.tbodyNode,c=1;if(b&&
a){if(a.ancestor("tbody")!==b)return null;for(;a=a.previous();)c++}return c},_createRowTemplate:function(a){var b="",c=this.CELL_TEMPLATE,d,e,f,h,l,k;this._setColumnsFormatterFn(a);d=0;for(e=a.length;d<e;++d)f=a[d],h=f.key,l=f._id||h,h=f._formatterFn,k=1<(f._headers||[]).length?'headers="'+f._headers.join(" ")+'"':"",l={content:"{"+l+"}",headers:k,className:this.getClassName("col",l)+" "+(f.className||"")+" "+this.getClassName("cell")+" {"+l+"-className}"},!h&&f.formatter&&(l.content=f.formatter.replace(n,
l.content)),f.nodeFormatter&&(l.content=""),b+=g(f.cellTemplate||c,l);this._rowTemplate=g(this.ROW_TEMPLATE,{content:b})},_setColumnsFormatterFn:function(c){var d=a.DataTable.BodyView.Formatters,e,f,g,n;g=0;for(n=c.length;g<n;g++)f=c[g],e=f.formatter,!f._formatterFn&&e&&(b.isFunction(e)?f._formatterFn=e:e in d&&(f._formatterFn=d[e].call(this.host||this,f)));return c},_createTBodyNode:function(){return a.Node.create(g(this.TBODY_TEMPLATE,{className:this.getClassName("data")}))},destructor:function(){(new a.EventHandle(l.values(this._eventHandles))).detach()},
_getRowId:function(b){return this._idMap[b]||(this._idMap[b]=a.guid())},initializer:function(a){this.host=a.host;this._eventHandles={modelListChange:this.after("modelListChange",m("_afterModelListChange",this))};this._idMap={};this.CLASS_ODD=this.getClassName("odd");this.CLASS_EVEN=this.getClassName("even")}},{Formatters:{}})},"3.17.2",{requires:["datatable-core","view","classnamemanager"]});
YUI.add("datatable-base",function(a,d){a.DataTable.Base=a.Base.create("datatable",a.Widget,[a.DataTable.Core],{delegate:function(){var a=this.get("contentBox");return a.delegate.apply(a,arguments)},destructor:function(){this.view&&this.view.destroy()},getCell:function(){return this.view&&this.view.getCell&&this.view.getCell.apply(this.view,arguments)},getRow:function(){return this.view&&this.view.getRow&&this.view.getRow.apply(this.view,arguments)},_afterDisplayColumnsChange:function(a){this._extractDisplayColumns(a.newVal||
[])},bindUI:function(){this._eventHandles.relayCoreChanges=this.after(["columnsChange","dataChange","summaryChange","captionChange","widthChange"],a.bind("_relayCoreAttrChange",this))},_defRenderViewFn:function(a){a.view.render()},_extractDisplayColumns:function(b){function c(b){var g,h,k;g=0;for(h=b.length;g<h;++g)k=b[g],a.Lang.isArray(k.children)?c(k.children):d.push(k)}var d=[];c(b);this._displayColumns=d},initializer:function(){this.publish("renderView",{defaultFn:a.bind("_defRenderViewFn",this)});
this._extractDisplayColumns(this.get("columns")||[]);this.after("columnsChange",a.bind("_afterDisplayColumnsChange",this))},_relayCoreAttrChange:function(a){this.view.set("data"===a.attrName?"modelList":a.attrName,a.newVal)},renderUI:function(){var b=this,c=this.get("view");c&&(this.view=new c(a.merge(this.getAttrs(),{host:this,container:this.get("contentBox"),modelList:this.data},this.get("viewConfig"))),this._eventHandles.legacyFeatureProps||(this._eventHandles.legacyFeatureProps=this.view.after({renderHeader:function(a){b.head=
a.view;b._theadNode=a.view.theadNode;b._tableNode=a.view.get("container")},renderFooter:function(a){b.foot=a.view;b._tfootNode=a.view.tfootNode;b._tableNode=a.view.get("container")},renderBody:function(a){b.body=a.view;b._tbodyNode=a.view.tbodyNode;b._tableNode=a.view.get("container")},renderTable:function(){var a=this.get("container");b._tableNode=this.tableNode||a.one("."+this.getClassName("table")+", table");b._captionNode=this.captionNode||a.one("caption");b._theadNode||(b._theadNode=a.one("."+
this.getClassName("columns")+", thead"));b._tbodyNode||(b._tbodyNode=a.one("."+this.getClassName("data")+", tbody"));b._tfootNode||(b._tfootNode=a.one("."+this.getClassName("footer")+", tfoot"))}})),this.view.addTarget(this))},syncUI:function(){this.view&&this.fire("renderView",{view:this.view})},_validateView:function(b){return null===b||a.Lang.isFunction(b)&&b.prototype.render}},{ATTRS:{view:{value:a.DataTable.TableView,validator:"_validateView"},viewConfig:{}}});a.DataTable=a.mix(a.Base.create("datatable",
a.DataTable.Base,[]),a.DataTable)},"3.17.2",{requires:"datatable-core datatable-table datatable-head datatable-body base-build widget".split(" "),skinnable:!0});
YUI.add("datatable-column-widths",function(a,d){function b(){}var c=a.Lang.isNumber,e=a.Array.indexOf;a.Features.add("table","badColWidth",{test:function(){var b=a.one("body"),c;b&&(b=b.insertBefore('<table style="position:absolute;visibility:hidden;border:0 none"><colgroup><col style="width:9px"></colgroup><tbody><tr><td style="padding:0 4px;font:normal 2px/2px arial;border:0 none">.</td></tr></tbody></table>',b.get("firstChild")),c="1px"!==b.one("td").getComputedStyle("width"),b.remove(!0));return c}});
a.mix(b.prototype,{COL_TEMPLATE:"<col/>",COLGROUP_TEMPLATE:"<colgroup/>",setColumnWidth:function(a,b){var d=this.getColumn(a),k=d&&e(this._displayColumns,d);-1<k&&(c(b)&&(b+="px"),d.width=b,this._setColumnWidth(k,b));return this},_createColumnGroup:function(){return a.Node.create(this.COLGROUP_TEMPLATE)},initializer:function(){this.after(["renderView","columnsChange"],this._uiSetColumnWidths)},_setColumnWidth:function(b,d){var e=this._colgroupNode,e=e&&e.all("col").item(b),k,m;if(e&&(d&&c(d)&&(d+=
"px"),e.setStyle("width",d),d&&a.Features.test("table","badColWidth")&&(k=this.getCell([0,b]))))m=function(a){return parseInt(k.getComputedStyle(a),10)||0},e.setStyle("width",parseInt(d,10)-m("paddingLeft")-m("paddingRight")-m("borderLeftWidth")-m("borderRightWidth")+"px")},_uiSetColumnWidths:function(){if(this.view){var a=this.COL_TEMPLATE,b=this._colgroupNode,c=this._displayColumns,d,e;b?b.empty():(b=this._colgroupNode=this._createColumnGroup(),this._tableNode.insertBefore(b,this._tableNode.one("> thead, > tfoot, > tbody")));
d=0;for(e=c.length;d<e;++d)b.append(a),this._setColumnWidth(d,c[d].width)}}},!0);a.DataTable.ColumnWidths=b;a.Base.mix(a.DataTable,[b])},"3.17.2",{requires:["datatable-base"]});
YUI.add("datatable-message",function(a,d){var b;a.namespace("DataTable").Message=b=function(){};b.ATTRS={showMessages:{value:!0,validator:a.Lang.isBoolean}};a.mix(b.prototype,{MESSAGE_TEMPLATE:'<tbody class="{className}"><tr><td class="{contentClass}" colspan="{colspan}"></td></tr></tbody>',hideMessage:function(){this.get("boundingBox").removeClass(this.getClassName("message","visible"));return this},showMessage:function(a){a=this.getString(a)||a;this._messageNode||this._initMessageNode();this.get("showMessages")&&
(a?(this._messageNode.one("."+this.getClassName("message","content")).setHTML(a),this.get("boundingBox").addClass(this.getClassName("message","visible"))):this.hideMessage());return this},_afterMessageColumnsChange:function(){var a;this._messageNode&&(a=this._messageNode.one("."+this.getClassName("message","content")))&&a.set("colSpan",this._displayColumns.length)},_afterMessageDataChange:function(){this._uiSetMessage()},_afterShowMessagesChange:function(a){a.newVal?this._uiSetMessage(a):this._messageNode&&
(this.get("boundingBox").removeClass(this.getClassName("message","visible")),this._messageNode.remove().destroy(!0),this._messageNode=null)},_bindMessageUI:function(){this.after(["dataChange","*:add","*:remove","*:reset"],a.bind("_afterMessageDataChange",this));this.after("columnsChange",a.bind("_afterMessageColumnsChange",this));this.after("showMessagesChange",a.bind("_afterShowMessagesChange",this))},initializer:function(){this._initMessageStrings();this.get("showMessages")&&this.after("table:renderBody",
a.bind("_initMessageNode",this));this.after(a.bind("_bindMessageUI",this),this,"bindUI");this.after(a.bind("_syncMessageUI",this),this,"syncUI")},_initMessageNode:function(){this._messageNode||(this._messageNode=a.Node.create(a.Lang.sub(this.MESSAGE_TEMPLATE,{className:this.getClassName("message"),contentClass:this.getClassName("message","content"),colspan:this._displayColumns.length||1})),this._tableNode.insertBefore(this._messageNode,this._tbodyNode))},_initMessageStrings:function(){this.set("strings",
a.mix(this.get("strings")||{},a.Intl.get("datatable-message")))},_syncMessageUI:function(){this._uiSetMessage()},_uiSetMessage:function(a){this.data.size()?this.hideMessage():this.showMessage(a&&a.message||"emptyMessage")}});a.Lang.isFunction(a.DataTable)&&a.Base.mix(a.DataTable,[b])},"3.17.2",{requires:["datatable-base"],lang:["en","fr","es","hu","it"],skinnable:!0});
YUI.add("datatable-mutable",function(a,d){var b=a.Array,c=a.Lang,e=c.isString,f=c.isArray,g=c.isObject,h=c.isNumber,k=a.Array.indexOf,m;a.namespace("DataTable").Mutable=m=function(){};m.ATTRS={autoSync:{value:!1,validator:c.isBoolean}};a.mix(m.prototype,{addColumn:function(a,b){e(a)&&(a={key:a});if(a){if(2>arguments.length||!h(b)&&!f(b))b=this.get("columns").length;this.fire("addColumn",{column:a,index:b})}return this},modifyColumn:function(a,b){e(b)&&(b={key:b});g(b)&&this.fire("modifyColumn",{column:a,
newColumnDef:b});return this},moveColumn:function(a,b){void 0!==a&&(h(b)||f(b))&&this.fire("moveColumn",{column:a,index:b});return this},removeColumn:function(a){void 0!==a&&this.fire("removeColumn",{column:a});return this},addRow:function(a,c){var d=c&&"sync"in c?c.sync:this.get("autoSync"),e,f,g,h;if(a&&this.data&&(e=this.data.add.apply(this.data,arguments),d)){e=b(e);h=b(arguments,1,!0);f=0;for(g=e.length;f<g;++f)d=e[f],d.isNew()&&e[f].save.apply(e[f],h)}return this},removeRow:function(a,c){var d=
this.data,e=c&&"sync"in c?c.sync:this.get("autoSync"),f,h,k;g(a)&&a instanceof this.get("recordType")?f=a:d&&void 0!==a&&(f=d.getById(a)||d.getByClientId(a)||d.item(a));if(f&&(k=b(arguments,1,!0),d=d.remove.apply(d,[f].concat(k)),e)){g(k[0])||k.unshift({});k[0]["delete"]=!0;d=b(d);e=0;for(h=d.length;e<h;++e)f=d[e],f.destroy.apply(f,k)}return this},modifyRow:function(a,c,d){var e=this.data,f=d&&"sync"in d?d.sync:this.get("autoSync"),h;g(a)&&a instanceof this.get("recordType")?h=a:e&&void 0!==a&&(h=
e.getById(a)||e.getByClientId(a)||e.item(a));h&&g(c)&&(e=b(arguments,1,!0),h.setAttrs.apply(h,e),f&&!h.isNew()&&h.save.apply(h,e));return this},_defAddColumnFn:function(a){var c=b(a.index),d=this.get("columns"),e=d,f,g;f=0;for(g=c.length-1;e&&f<g;++f)e=e[c[f]]&&e[c[f]].children;e&&(e.splice(c[f],0,a.column),this.set("columns",d,{originEvent:a}))},_defModifyColumnFn:function(b){var c=this.get("columns"),d=this.getColumn(b.column);d&&(a.mix(d,b.newColumnDef,!0),this.set("columns",c,{originEvent:b}))},
_defMoveColumnFn:function(a){var c=this.get("columns"),d=this.getColumn(a.column),e=b(a.index),f,g,h,m,u;if(d&&(f=d._parent?d._parent.children:c,g=k(f,d),-1<g)){h=c;m=0;for(u=e.length-1;h&&m<u;++m)h=h[e[m]]&&h[e[m]].children;h&&(u=h.length,f.splice(g,1),e=e[m],u>h.lenth&&g<e&&e--,h.splice(e,0,d),this.set("columns",c,{originEvent:a}))}},_defRemoveColumnFn:function(b){var c=this.get("columns"),d=this.getColumn(b.column),e;d&&(e=d._parent?d._parent.children:c,d=a.Array.indexOf(e,d),-1<d&&(e.splice(d,
1),this.set("columns",c,{originEvent:b})))},initializer:function(){this.publish({addColumn:{defaultFn:a.bind("_defAddColumnFn",this)},removeColumn:{defaultFn:a.bind("_defRemoveColumnFn",this)},moveColumn:{defaultFn:a.bind("_defMoveColumnFn",this)},modifyColumn:{defaultFn:a.bind("_defModifyColumnFn",this)}})}});m.prototype.addRows=m.prototype.addRow;c.isFunction(a.DataTable)&&a.Base.mix(a.DataTable,[m])},"3.17.2",{requires:["datatable-base"]});
YUI.add("datatable-sort",function(a,d){function b(){}var c=a.Lang,e=c.isBoolean,f=c.isString,g=c.isArray,h=c.isObject,k=a.Array,m=c.sub,l={asc:1,desc:-1,1:1,"-1":-1};b.ATTRS={sortable:{value:"auto",validator:"_validateSortable"},sortBy:{validator:"_validateSortBy",getter:"_getSortBy"},strings:{}};a.mix(b.prototype,{sort:function(b,c){return this.fire("sort",a.merge(c||{},{sortBy:b||this.get("sortBy")}))},SORTABLE_HEADER_TEMPLATE:'<div class="{className}" tabindex="0" unselectable="on"><span class="{indicatorClass}"></span></div>',
toggleSort:function(b,c){var d=this._sortBy,e=[],f,g,h;f=0;for(g=d.length;f<g;++f)h={},h[d[f]._id]=d[f].sortDir,e.push(h);if(b){b=k(b);f=0;for(g=b.length;f<g;++f){h=b[f];for(d=e.length-1;0<=f;--f)if(e[d][h]){e[d][h]*=-1;break}}}else{f=0;for(g=e.length;f<g;++f)for(h in e[f])if(e[f].hasOwnProperty(h)){e[f][h]*=-1;break}}return this.fire("sort",a.merge(c||{},{sortBy:e}))},_afterSortByChange:function(){this._setSortBy();this._sortBy.length&&(this.data.comparator||(this.data.comparator=this._sortComparator),
this.data.sort())},_afterSortDataChange:function(a){(a.prevVal!==a.newVal||a.newVal.hasOwnProperty("_compare"))&&this._initSortFn()},_afterSortRecordChange:function(a){var b,c;b=0;for(c=this._sortBy.length;b<c;++b)if(a.changed[this._sortBy[b].key]){this.data.sort();break}},_bindSortUI:function(){var b=this._eventHandles;b.sortAttrs||(b.sortAttrs=this.after(["sortableChange","sortByChange","columnsChange"],a.bind("_uiSetSortable",this)));!b.sortUITrigger&&this._theadNode&&(b.sortUITrigger=this.delegate(["click",
"keydown"],a.rbind("_onUITriggerSort",this),"."+this.getClassName("sortable","column")))},_defSortFn:function(a){this.set.apply(this,["sortBy",a.sortBy].concat(a.details))},_getSortBy:function(a,b){var c,d,e,f;b=b.slice(7);if("state"===b){c=[];d=0;for(e=this._sortBy.length;d<e;++d)f=this._sortBy[d],c.push({column:f._id,dir:f.sortDir});return{state:1===c.length?c[0]:c}}return a},initializer:function(){var b=a.bind("_parseSortable",this);this._parseSortable();this._setSortBy();this._initSortFn();this._initSortStrings();
this.after({"table:renderHeader":a.bind("_renderSortable",this),dataChange:a.bind("_afterSortDataChange",this),sortByChange:a.bind("_afterSortByChange",this),sortableChange:b,columnsChange:b});this.data.after(this.data.model.NAME+":change",a.bind("_afterSortRecordChange",this));this.publish("sort",{defaultFn:a.bind("_defSortFn",this)})},_initSortFn:function(){var a=this;this.data._compare=function(b,c){var d=0,e,f,g,h,k;e=0;for(f=a._sortBy.length;!d&&e<f;++e)g=a._sortBy[e],d=g.sortDir,h=g.caseSensitive,
g.sortFn?d=g.sortFn(b,c,-1===d):(k=b.get(g.key)||"",g=c.get(g.key)||"",!h&&("string"===typeof k&&"string"===typeof g)&&(k=k.toLowerCase(),g=g.toLowerCase()),d=k>g?d:k<g?-d:0);return d};this._sortBy.length?(this.data.comparator=this._sortComparator,this.data.sort()):delete this.data.comparator},_initSortStrings:function(){this.set("strings",a.mix(this.get("strings")||{},a.Intl.get("datatable-sort")))},_onUITriggerSort:function(a){var b=a.currentTarget.getAttribute("data-yui3-col-id"),c=b&&this.getColumn(b),
d,e,f;if(!("keydown"===a.type&&32!==a.keyCode)&&(a.preventDefault(),c)){if(a.shiftKey){d=this.get("sortBy")||[];e=0;for(f=d.length;e<f;++e)if(b===d[e]||1===Math.abs(d[e][b])){h(d[e])||(d[e]={});d[e][b]=-(c.sortDir||0)||1;break}e>=f&&d.push(c._id)}else d=[{}],d[0][b]=-(c.sortDir||0)||1;this.fire("sort",{originEvent:a,sortBy:d})}},_parseSortable:function(){var a=this.get("sortable"),b=[],c,d,e;if(g(a)){c=0;for(d=a.length;c<d;++c){e=a[c];if(!h(e,!0)||g(e))e=this.getColumn(e);e&&b.push(e)}}else if(a&&
(b=this._displayColumns.slice(),"auto"===a))for(c=b.length-1;0<=c;--c)b[c].sortable||b.splice(c,1);this._sortable=b},_renderSortable:function(){this._uiSetSortable();this._bindSortUI()},_setSortBy:function(){var a=this._displayColumns,b=this.get("sortBy")||[],c=" "+this.getClassName("sorted"),d,e,f,g;this._sortBy=[];d=0;for(e=a.length;d<e;++d)f=a[d],delete f.sortDir,f.className&&(f.className=f.className.replace(c,""));b=k(b);d=0;for(e=b.length;d<e;++d){f=b[d];a=1;if(h(f))for(f in g=f,g)if(g.hasOwnProperty(f)){a=
l[g[f]];break}f&&(f=this.getColumn(f)||{_id:f,key:f},f.sortDir=a,f.className||(f.className=""),f.className+=c,this._sortBy.push(f))}},_sortComparator:function(a){return a},_uiSetSortable:function(){var b=this._sortable||[],c=this.getClassName("sortable","column"),d=this.getClassName("sorted"),e=this.getClassName("sorted","desc"),f=this.getClassName("sort","liner"),g=this.getClassName("sort","indicator"),h={},k,l,x,v,w,B;this.get("boundingBox").toggleClass(this.getClassName("sortable"),b.length);k=
0;for(l=b.length;k<l;++k)h[b[k].id]=b[k];this._theadNode.all("."+c).each(function(a){var b=h[a.get("id")],k=a.one("."+f);b?b.sortDir||a.removeClass(d).removeClass(e):(a.removeClass(c).removeClass(d).removeClass(e),k&&k.replace(k.get("childNodes").toFrag()),(a=a.one("."+g))&&a.remove().destroy(!0))});k=0;for(l=b.length;k<l;++k)x=b[k],v=this._theadNode.one("#"+x.id),B=-1===x.sortDir,v&&(w=v.one("."+f),v.addClass(c),x.sortDir&&(v.addClass(d),v.toggleClass(e,B),v.setAttribute("aria-sort",B?"descending":
"ascending")),w||(w=a.Node.create(a.Lang.sub(this.SORTABLE_HEADER_TEMPLATE,{className:f,indicatorClass:g})),w.prepend(v.get("childNodes").toFrag()),v.append(w)),w=m(this.getString(1===x.sortDir?"reverseSortBy":"sortBy"),{title:x.title||"",key:x.key||"",abbr:x.abbr||"",label:x.label||"",column:x.abbr||x.label||x.key||"column "+k}),v.setAttribute("title",w),v.setAttribute("aria-labelledby",x.id))},_validateSortable:function(a){return"auto"===a||e(a)||g(a)},_validateSortBy:function(a){return null===
a||f(a)||h(a,!0)||g(a)&&(f(a[0])||h(a,!0))}},!0);a.DataTable.Sortable=b;a.Base.mix(a.DataTable,[b])},"3.17.2",{requires:["datatable-base"],lang:["en","fr","es","hu"],skinnable:!0});
YUI.add("datatable-datasource",function(a,d){function b(){b.superclass.constructor.apply(this,arguments)}a.mix(b,{NS:"datasource",NAME:"dataTableDataSource",ATTRS:{datasource:{setter:"_setDataSource"},initialRequest:{setter:"_setInitialRequest"}}});a.extend(b,a.Plugin.Base,{_setDataSource:function(b){return b||new a.DataSource.Local(b)},_setInitialRequest:function(){},initializer:function(b){a.Lang.isUndefined(b.initialRequest)||this.load({request:b.initialRequest})},load:function(b){b=b||{};b.request=
b.request||this.get("initialRequest");b.callback=b.callback||{success:a.bind(this.onDataReturnInitializeTable,this),failure:a.bind(this.onDataReturnInitializeTable,this),argument:this.get("host").get("state")};var d=b.datasource||this.get("datasource");d&&d.sendRequest(b)},onDataReturnInitializeTable:function(a){a=a.response&&a.response.results||[];this.get("host").set("data",a)}});a.namespace("Plugin").DataTableDataSource=b},"3.17.2",{requires:["datatable-base","plugin","datasource-local"]});
YUI.add("calendar",function(a,d){function b(){b.superclass.constructor.apply(this,arguments)}var c=a.ClassNameManager.getClassName,e=c("calendar","day-selected"),f=c("calendar","day-highlighted"),g=c("calendar","day"),h=c("calendar","prevmonth-day"),k=c("calendar","nextmonth-day"),m=c("calendar","grid"),l=a.DataType.Date,n=c("calendar","pane"),p=a.UA.os;a.Calendar=a.extend(b,a.CalendarBase,{_keyEvents:[],_highlightedDateNode:null,_lastSelectedDate:null,initializer:function(){this.plug(a.Plugin.CalendarNavigator);
this._keyEvents=[];this._lastSelectedDate=this._highlightedDateNode=null},_bindCalendarEvents:function(){var a=this.get("contentBox").one("."+n);a.on("selectstart",this._preventSelectionStart);a.delegate("click",this._clickCalendar,"."+g+", ."+h+", ."+k,this);a.delegate("keydown",this._keydownCalendar,"."+m,this);a.delegate("focus",this._focusCalendarGrid,"."+m,this);a.delegate("focus",this._focusCalendarCell,"."+g,this);a.delegate("blur",this._blurCalendarGrid,"."+m+",."+g,this);this.after(["minimumDateChange",
"maximumDateChange"],this._afterCustomRendererChange)},_preventSelectionStart:function(a){a.preventDefault()},_highlightDateNode:function(a){this._unhighlightCurrentDateNode();a=this._dateToNode(a);a.focus();a.addClass(f)},_unhighlightCurrentDateNode:function(){var a=this.get("contentBox").all("."+f);a&&a.removeClass(f)},_getGridNumber:function(a){a=a.get("id").split("_").reverse();return parseInt(a[0],10)},_blurCalendarGrid:function(){this._unhighlightCurrentDateNode()},_focusCalendarCell:function(a){this._highlightedDateNode=
a.target;a.stopPropagation()},_focusCalendarGrid:function(){this._unhighlightCurrentDateNode();this._highlightedDateNode=null},_keydownCalendar:function(a){var b=this._getGridNumber(a.target),c=!this._highlightedDateNode?null:this._nodeToDate(this._highlightedDateNode),d=a.keyCode,f=0,g;switch(d){case 40:f=7;break;case 38:f=-7;break;case 37:f=-1;break;case 39:f=1;break;case 32:case 13:if(a.preventDefault(),this._highlightedDateNode)if(g=this.get("selectionMode"),"single"===g&&!this._highlightedDateNode.hasClass(e))this._clearSelection(!0),
this._addDateToSelection(c);else if("multiple"===g||"multiple-sticky"===g)this._highlightedDateNode.hasClass(e)?this._removeDateFromSelection(c):this._addDateToSelection(c)}if(40===d||38===d||37===d||39===d)c||(c=l.addMonths(this.get("date"),b),f=0),a.preventDefault(),a=l.addDays(c,f),b=this.get("date"),c=l.addMonths(this.get("date"),this._paneNumber-1),d=new Date(c),c.setDate(l.daysInMonth(c)),l.isInRange(a,b,c)?this._highlightDateNode(a):l.isGreater(b,a)?l.isGreaterOrEqual(this.get("minimumDate"),
b)||(this.set("date",l.addMonths(b,-1)),this._highlightDateNode(a)):l.isGreater(a,c)&&!l.isGreaterOrEqual(d,this.get("maximumDate"))&&(this.set("date",l.addMonths(b,1)),this._highlightDateNode(a))},_clickCalendar:function(a){var b=a.currentTarget,c=b.hasClass(g)&&!b.hasClass(h)&&!b.hasClass(k),d=b.hasClass(e);switch(this.get("selectionMode")){case "single":c&&!d&&(this._clearSelection(!0),this._addDateToSelection(this._nodeToDate(b)));break;case "multiple-sticky":c&&(d?this._removeDateFromSelection(this._nodeToDate(b)):
this._addDateToSelection(this._nodeToDate(b)));break;case "multiple":c&&(!a.metaKey&&!a.ctrlKey&&!a.shiftKey?(this._clearSelection(!0),this._lastSelectedDate=this._nodeToDate(b),this._addDateToSelection(this._lastSelectedDate)):("macintosh"===p&&a.metaKey||"macintosh"!==p&&a.ctrlKey)&&!a.shiftKey?d?(this._removeDateFromSelection(this._nodeToDate(b)),this._lastSelectedDate=null):(this._lastSelectedDate=this._nodeToDate(b),this._addDateToSelection(this._lastSelectedDate)):("macintosh"===p&&a.metaKey||
"macintosh"!==p&&a.ctrlKey)&&a.shiftKey?this._lastSelectedDate?(a=this._nodeToDate(b),this._addDateRangeToSelection(a,this._lastSelectedDate),this._lastSelectedDate=a):(this._lastSelectedDate=this._nodeToDate(b),this._addDateToSelection(this._lastSelectedDate)):a.shiftKey&&(this._lastSelectedDate?(a=this._nodeToDate(b),this._clearSelection(!0),this._addDateRangeToSelection(a,this._lastSelectedDate),this._lastSelectedDate=a):(this._clearSelection(!0),this._lastSelectedDate=this._nodeToDate(b),this._addDateToSelection(this._lastSelectedDate))))}c?
this.fire("dateClick",{cell:b,date:this._nodeToDate(b)}):b.hasClass(h)?this.fire("prevMonthClick"):b.hasClass(k)&&this.fire("nextMonthClick")},_canBeSelected:function(a){var c=this.get("minimumDate"),d=this.get("maximumDate");return c&&!l.isGreaterOrEqual(a,c)||d&&l.isGreater(a,d)?!1:b.superclass._canBeSelected.call(this,a)},_renderCustomRules:function(){b.superclass._renderCustomRules.call(this);var a=this.get("minimumDate"),c=this.get("maximumDate"),d=[],e,f;if(a||c){for(f=0;f<this._paneNumber;f++)e=
l.addMonths(this.get("date"),f),d=d.concat(l.listOfDatesInMonth(e));if(a){e=0;for(f=d.length;e<f&&!l.isGreaterOrEqual(d[e],a);e++)this._disableDate(d[e])}if(c)for(e=d.length-1;0<=e;e--)if(l.isGreater(d[e],c))this._disableDate(d[e]);else break}},subtractMonth:function(a){this.set("date",l.addMonths(this.get("date"),-1));a&&a.halt();return this},subtractYear:function(a){this.set("date",l.addYears(this.get("date"),-1));a&&a.halt();return this},addMonth:function(a){this.set("date",l.addMonths(this.get("date"),
1));a&&a.halt();return this},addYear:function(a){this.set("date",l.addYears(this.get("date"),1));a&&a.halt();return this}},{NAME:"calendar",ATTRS:{selectionMode:{value:"single"},date:{value:new Date,lazyAdd:!1,setter:function(a){a=this._normalizeDate(a);var b=l.addMonths(a,this._paneNumber-1),c=this.get("minimumDate"),d=this.get("maximumDate");if((!c||l.isGreaterOrEqual(a,c))&&(!d||l.isGreaterOrEqual(d,b)))return a;if(c&&l.isGreater(c,a))return this._normalizeDate(c);if(d&&l.isGreater(b,d))return l.addMonths(this._normalizeDate(d),
1-this._paneNumber)}},minimumDate:{value:null,setter:function(b){if(a.Lang.isDate(b)){var c=this.get("date"),d=this._normalizeTime(b);c&&!l.isGreaterOrEqual(c,d)&&this.set("date",b);return d}return null}},maximumDate:{value:null,setter:function(b){if(a.Lang.isDate(b)){var c=this.get("date");c&&!l.isGreaterOrEqual(b,l.addMonths(c,this._paneNumber-1))&&this.set("date",l.addMonths(this._normalizeDate(b),1-this._paneNumber));return this._normalizeTime(b)}return null}}}})},"3.17.2",{requires:["calendar-base",
"calendarnavigator"],skinnable:!0});
YUI.add("calendar-base",function(a,d){function b(){b.superclass.constructor.apply(this,arguments)}var c=a.ClassNameManager.getClassName,e=c("calendar","grid"),f=c("calendar","left-grid"),g=c("calendar","right-grid"),h=c("calendar","body"),k=c("calendar","header"),m=c("calendar","header-label"),l=c("calendar","weekdayrow"),n=c("calendar","weekday"),p=c("calendar","column-hidden"),r=c("calendar","day-selected"),s=c("calendar","selection-disabled"),t=c("calendar","row"),q=c("calendar","day"),z=c("calendar",
"prevmonth-day"),u=c("calendar","nextmonth-day"),A=c("calendar","anchor"),x=c("calendar","pane"),c=c("calendar","status"),v=a.Lang,w=v.sub,B=a.Array.each,C=a.Object.each,F=a.Array.indexOf,D=a.Object.hasKey,H=a.Object.setValue,G=a.Object.isEmpty,y=a.DataType.Date;a.CalendarBase=a.extend(b,a.Widget,{_paneProperties:{},_paneNumber:1,_calendarId:null,_selectedDates:{},_rules:{},_filterFunction:null,_storedDateCells:{},initializer:function(){this._paneProperties={};this._calendarId=a.guid("calendar");
this._selectedDates={};G(this._rules)&&(this._rules={});this._storedDateCells={}},renderUI:function(){this.get("contentBox").appendChild(this._initCalendarHTML(this.get("date")));this.get("showPrevMonth")&&this._afterShowPrevMonthChange();this.get("showNextMonth")&&this._afterShowNextMonthChange();this._renderCustomRules();this._renderSelectedDates();this.get("boundingBox").setAttribute("aria-labelledby",this._calendarId+"_header")},bindUI:function(){this.after("dateChange",this._afterDateChange);
this.after("showPrevMonthChange",this._afterShowPrevMonthChange);this.after("showNextMonthChange",this._afterShowNextMonthChange);this.after("headerRendererChange",this._afterHeaderRendererChange);this.after("customRendererChange",this._afterCustomRendererChange);this.after("enabledDatesRuleChange",this._afterCustomRendererChange);this.after("disabledDatesRuleChange",this._afterCustomRendererChange);this.after("focusedChange",this._afterFocusedChange);this.after("selectionChange",this._renderSelectedDates);
this._bindCalendarEvents()},_getSelectedDatesList:function(){var a=[];C(this._selectedDates,function(b){C(b,function(b){C(b,function(b){a.push(b)},this)},this)},this);return a},_getSelectedDatesInMonth:function(b){var c=b.getFullYear();b=b.getMonth();return D(this._selectedDates,c)&&D(this._selectedDates[c],b)?a.Object.values(this._selectedDates[c][b]):[]},_isNumInList:function(a,b){if("all"===b)return!0;for(var c=b.split(","),d=c.length,e;d--;)if(e=c[d].split("-"),2===e.length&&a>=parseInt(e[0],
10)&&a<=parseInt(e[1],10)||1===e.length&&parseInt(c[d],10)===a)return!0;return!1},_getRulesForDate:function(a){var b=a.getFullYear(),c=a.getMonth(),d=a.getDate();a=a.getDay();var e=this._rules,f=[],g,h,k,l;for(g in e)if(this._isNumInList(b,g))if(v.isString(e[g]))f.push(e[g]);else for(h in e[g])if(this._isNumInList(c,h))if(v.isString(e[g][h]))f.push(e[g][h]);else for(k in e[g][h])if(this._isNumInList(d,k))if(v.isString(e[g][h][k]))f.push(e[g][h][k]);else for(l in e[g][h][k])this._isNumInList(a,l)&&
v.isString(e[g][h][k][l])&&f.push(e[g][h][k][l]);return f},_matchesRule:function(a,b){return 0<=F(this._getRulesForDate(a),b)},_canBeSelected:function(a){var b=this.get("enabledDatesRule"),c=this.get("disabledDatesRule");return b?this._matchesRule(a,b):c?!this._matchesRule(a,c):!0},selectDates:function(a){y.isValidDate(a)?this._addDateToSelection(a):v.isArray(a)&&this._addDatesToSelection(a);return this},deselectDates:function(a){a?y.isValidDate(a)?this._removeDateFromSelection(a):v.isArray(a)&&this._removeDatesFromSelection(a):
this._clearSelection();return this},_addDateToSelection:function(a,b){a=this._normalizeTime(a);if(this._canBeSelected(a)){var c=a.getFullYear(),d=a.getMonth(),e=a.getDate();D(this._selectedDates,c)?D(this._selectedDates[c],d)||(this._selectedDates[c][d]={}):(this._selectedDates[c]={},this._selectedDates[c][d]={});this._selectedDates[c][d][e]=a;this._selectedDates=H(this._selectedDates,[c,d,e],a);b||this._fireSelectionChange()}},_addDatesToSelection:function(a){B(a,this._addDateToSelection,this);this._fireSelectionChange()},
_addDateRangeToSelection:function(a,b){var c=6E4*(b.getTimezoneOffset()-a.getTimezoneOffset()),d=a.getTime(),e=b.getTime(),f;d>e?(f=d,d=e,e=f+c):e-=c;for(c=d;c<=e;c+=864E5)d=new Date(c),d.setHours(12),this._addDateToSelection(d,c);this._fireSelectionChange()},_removeDateFromSelection:function(a,b){var c=a.getFullYear(),d=a.getMonth(),e=a.getDate();D(this._selectedDates,c)&&(D(this._selectedDates[c],d)&&D(this._selectedDates[c][d],e))&&(delete this._selectedDates[c][d][e],b||this._fireSelectionChange())},
_removeDatesFromSelection:function(a){B(a,this._removeDateFromSelection,this);this._fireSelectionChange()},_removeDateRangeFromSelection:function(a,b){for(var c=a.getTime(),d=b.getTime();c<=d;c+=864E5)this._removeDateFromSelection(new Date(c),c);this._fireSelectionChange()},_clearSelection:function(a){this._selectedDates={};this.get("contentBox").all("."+r).removeClass(r).setAttribute("aria-selected",!1);a||this._fireSelectionChange()},_fireSelectionChange:function(){this.fire("selectionChange",{newSelection:this._getSelectedDatesList()})},
_restoreModifiedCells:function(){var a=this.get("contentBox"),b;for(b in this._storedDateCells)a.one("#"+b).replace(this._storedDateCells[b]),delete this._storedDateCells[b]},_renderCustomRules:function(){this.get("contentBox").all("."+q+",."+u).removeClass(s).setAttribute("aria-disabled",!1);if(!G(this._rules)){var b,c;for(b=0;b<this._paneNumber;b++)c=y.addMonths(this.get("date"),b),c=y.listOfDatesInMonth(c),B(c,a.bind(this._renderCustomRulesHelper,this))}},_renderCustomRulesHelper:function(a){var b=
this.get("enabledDatesRule"),c=this.get("disabledDatesRule"),d;d=this._getRulesForDate(a);0<d.length?((b&&0>F(d,b)||!b&&c&&0<=F(d,c))&&this._disableDate(a),v.isFunction(this._filterFunction)&&(b=this._dateToNode(a),this._storedDateCells[b.get("id")]=b.cloneNode(!0),this._filterFunction(a,b,d))):b&&this._disableDate(a)},_renderSelectedDates:function(){this.get("contentBox").all("."+r).removeClass(r).setAttribute("aria-selected",!1);var b,c;for(b=0;b<this._paneNumber;b++)c=y.addMonths(this.get("date"),
b),c=this._getSelectedDatesInMonth(c),B(c,a.bind(this._renderSelectedDatesHelper,this))},_renderSelectedDatesHelper:function(a){this._dateToNode(a).addClass(r).setAttribute("aria-selected",!0)},_disableDate:function(a){this._dateToNode(a).addClass(s).setAttribute("aria-disabled",!0)},_dateToNode:function(a){var b=a.getDate(),c=0,d=b%7;a=(12+a.getMonth()-this.get("date").getMonth())%12;var e=this._paneProperties[this._calendarId+"_pane_"+a].cutoffCol;switch(d){case 0:c=6<=e?12:5;break;case 1:c=6;break;
case 2:c=0<e?7:0;break;case 3:c=1<e?8:1;break;case 4:c=2<e?9:2;break;case 5:c=3<e?10:3;break;case 6:c=4<e?11:4}return this.get("contentBox").one("#"+this._calendarId+"_pane_"+a+"_"+c+"_"+b)},_nodeToDate:function(a){a=a.get("id").split("_").reverse();var b=parseInt(a[2],10);a=parseInt(a[0],10);var c=y.addMonths(this.get("date"),b),b=c.getFullYear(),c=c.getMonth();return new Date(b,c,a,12,0,0,0)},_bindCalendarEvents:function(){},_normalizeDate:function(a){return a?new Date(a.getFullYear(),a.getMonth(),
1,12,0,0,0):null},_normalizeTime:function(a){return a?new Date(a.getFullYear(),a.getMonth(),a.getDate(),12,0,0,0):null},_getCutoffColumn:function(a,b){return 6-(this._normalizeDate(a).getDay()-b+7)%7},_turnPrevMonthOn:function(a){var b=a.get("id"),c=y.daysInMonth(y.addMonths(this._paneProperties[b].paneDate,-1)),d;this._paneProperties[b].hasOwnProperty("daysInPrevMonth")||(this._paneProperties[b].daysInPrevMonth=0);if(c!==this._paneProperties[b].daysInPrevMonth){this._paneProperties[b].daysInPrevMonth=
c;for(d=5;0<=d;d--)a.one("#"+b+"_"+d+"_"+(d-5)).set("text",c--)}},_turnPrevMonthOff:function(a){var b=a.get("id"),c;this._paneProperties[b].daysInPrevMonth=0;for(c=5;0<=c;c--)a.one("#"+b+"_"+c+"_"+(c-5)).setContent("&nbsp;")},_cleanUpNextMonthCells:function(a){var b=a.get("id");a.one("#"+b+"_6_29").removeClass(u);a.one("#"+b+"_7_30").removeClass(u);a.one("#"+b+"_8_31").removeClass(u);a.one("#"+b+"_0_30").removeClass(u);a.one("#"+b+"_1_31").removeClass(u)},_turnNextMonthOn:function(a){var b=1,c=a.get("id"),
d=this._paneProperties[c].daysInMonth,e=this._paneProperties[c].cutoffCol,f;for(f=d-22;f<e+7;f++)a.one("#"+c+"_"+f+"_"+(f+23)).set("text",b++).addClass(u);f=e;for(31===d&&1>=e?f=2:30===d&&0===e&&(f=1);f<e+7;f++)a.one("#"+c+"_"+f+"_"+(f+30)).set("text",b++).addClass(u)},_turnNextMonthOff:function(a){var b=a.get("id"),c=this._paneProperties[b].daysInMonth,d=this._paneProperties[b].cutoffCol,e;for(e=c-22;12>=e;e++)a.one("#"+b+"_"+e+"_"+(e+23)).setContent("&nbsp;").addClass(u);e=0;for(31===c&&1>=d?e=
2:30===c&&0===d&&(e=1);12>=e;e++)a.one("#"+b+"_"+e+"_"+(e+30)).setContent("&nbsp;").addClass(u)},_afterShowNextMonthChange:function(){var a=this.get("contentBox").one("#"+this._calendarId+"_pane_"+(this._paneNumber-1));this._cleanUpNextMonthCells(a);this.get("showNextMonth")?this._turnNextMonthOn(a):this._turnNextMonthOff(a)},_afterShowPrevMonthChange:function(){var a=this.get("contentBox").one("#"+this._calendarId+"_pane_0");this.get("showPrevMonth")?this._turnPrevMonthOn(a):this._turnPrevMonthOff(a)},
_afterHeaderRendererChange:function(){this.get("contentBox").one("."+m).setContent(this._updateCalendarHeader(this.get("date")))},_afterCustomRendererChange:function(){this._restoreModifiedCells();this._renderCustomRules()},_afterDateChange:function(){var a=this.get("contentBox"),b=a.one("."+k).one("."+m),c=a.all("."+e),d=this.get("date"),f=0;a.setStyle("visibility","hidden");b.setContent(this._updateCalendarHeader(d));this._restoreModifiedCells();c.each(function(a){this._rerenderCalendarPane(y.addMonths(d,
f++),a)},this);this._afterShowPrevMonthChange();this._afterShowNextMonthChange();this._renderCustomRules();this._renderSelectedDates();a.setStyle("visibility","inherit")},_initCalendarPane:function(c,d){var e=this.get("strings.very_short_weekdays")||"Su Mo Tu We Th Fr Sa".split(" "),f=a.Intl.get("datatype-date-format").A,g=this.get("strings.first_weekday")||0,h=this._getCutoffColumn(c,g),k=y.daysInMonth(c),l="     ".split(" "),n={},m,r,s;n.weekday_row="";for(m=g;m<=g+6;m++)n.weekday_row+=w(b.WEEKDAY_TEMPLATE,
{short_weekdayname:e[m%7],weekdayname:f[m%7]});n.weekday_row_template=w(b.WEEKDAY_ROW_TEMPLATE,n);for(e=0;5>=e;e++)for(f=0;12>=f;f++){g=7*e-5+f;m=d+"_"+f+"_"+g;r=q;1>g?r=z:g>k&&(r=u);if(1>g||g>k)g="&nbsp;";s=f>=h&&f<h+7?"":p;l[e]+=w(b.CALDAY_TEMPLATE,{day_content:g,calendar_col_class:"calendar_col"+f,calendar_col_visibility_class:s,calendar_day_class:r,calendar_day_id:m})}n.body_template="";B(l,function(a){n.body_template+=w(b.CALDAY_ROW_TEMPLATE,{calday_row:a})});n.calendar_pane_id=d;n.calendar_pane_tabindex=
this.get("tabIndex");n.pane_arialabel=y.format(c,{format:"%B %Y"});l=w(w(b.CALENDAR_GRID_TEMPLATE,n),b.CALENDAR_STRINGS);this._paneProperties[d]={cutoffCol:h,daysInMonth:k,paneDate:c};return l},_rerenderCalendarPane:function(a,b){var c=this.get("strings.first_weekday")||0,c=this._getCutoffColumn(a,c),d=y.daysInMonth(a),e=b.get("id"),f,g;b.setStyle("visibility","hidden");b.setAttribute("aria-label",y.format(a,{format:"%B %Y"}));for(f=0;12>=f;f++)if(g=b.all(".calendar_col"+f),g.removeClass(p),f<c||
f>=c+7)g.addClass(p);else switch(f){case 0:g=b.one("#"+e+"_0_30");30<=d?(g.set("text","30"),g.removeClass(u).addClass(q)):(g.setContent("&nbsp;"),g.removeClass(q).addClass(u));break;case 1:g=b.one("#"+e+"_1_31");31<=d?(g.set("text","31"),g.removeClass(u).addClass(q)):(g.setContent("&nbsp;"),g.removeClass(q).addClass(u));break;case 6:g=b.one("#"+e+"_6_29");29<=d?(g.set("text","29"),g.removeClass(u).addClass(q)):(g.setContent("&nbsp;"),g.removeClass(q).addClass(u));break;case 7:g=b.one("#"+e+"_7_30");
30<=d?(g.set("text","30"),g.removeClass(u).addClass(q)):(g.setContent("&nbsp;"),g.removeClass(q).addClass(u));break;case 8:g=b.one("#"+e+"_8_31"),31<=d?(g.set("text","31"),g.removeClass(u).addClass(q)):(g.setContent("&nbsp;"),g.removeClass(q).addClass(u))}this._paneProperties[e].cutoffCol=c;this._paneProperties[e].daysInMonth=d;this._paneProperties[e].paneDate=a;b.setStyle("visibility","inherit")},_updateCalendarHeader:function(b){var c="",d=this.get("headerRenderer");a.Lang.isString(d)?c=y.format(b,
{format:d}):d instanceof Function&&(c=d.call(this,b));return c},_initCalendarHeader:function(a){return w(w(b.HEADER_TEMPLATE,{calheader:this._updateCalendarHeader(a),calendar_id:this._calendarId}),b.CALENDAR_STRINGS)},_initCalendarHTML:function(c){var d={},e=0,f,g;d.header_template=this._initCalendarHeader(c);d.calendar_id=this._calendarId;d.body_template=w(w(b.CONTENT_TEMPLATE,d),b.CALENDAR_STRINGS);g=d.body_template.replace(/\{calendar_grid_template\}/g,a.bind(function(){f=this._initCalendarPane(y.addMonths(c,
e),d.calendar_id+"_pane_"+e);e++;return f},this));this._paneNumber=e;return g}},{CALENDAR_STRINGS:{calendar_grid_class:e,calendar_body_class:h,calendar_hd_class:k,calendar_hd_label_class:m,calendar_weekdayrow_class:l,calendar_weekday_class:n,calendar_row_class:t,calendar_day_class:q,calendar_dayanchor_class:A,calendar_pane_class:x,calendar_right_grid_class:g,calendar_left_grid_class:f,calendar_status_class:c},CONTENT_TEMPLATE:'<div class="yui3-g {calendar_pane_class}" id="{calendar_id}">{header_template}<div class="yui3-u-1">{calendar_grid_template}</div></div>',
ONE_PANE_TEMPLATE:'<div class="yui3-g {calendar_pane_class}" id="{calendar_id}">{header_template}<div class="yui3-u-1">{calendar_grid_template}</div></div>',TWO_PANE_TEMPLATE:'<div class="yui3-g {calendar_pane_class}" id="{calendar_id}">{header_template}<div class="yui3-u-1-2"><div class = "{calendar_left_grid_class}">{calendar_grid_template}</div></div><div class="yui3-u-1-2"><div class = "{calendar_right_grid_class}">{calendar_grid_template}</div></div></div>',THREE_PANE_TEMPLATE:'<div class="yui3-g {calendar_pane_class}" id="{calendar_id}">{header_template}<div class="yui3-u-1-3"><div class="{calendar_left_grid_class}">{calendar_grid_template}</div></div><div class="yui3-u-1-3">{calendar_grid_template}</div><div class="yui3-u-1-3"><div class="{calendar_right_grid_class}">{calendar_grid_template}</div></div></div>',
CALENDAR_GRID_TEMPLATE:'<table class="{calendar_grid_class}" id="{calendar_pane_id}" role="grid" aria-readonly="true" aria-label="{pane_arialabel}" tabindex="{calendar_pane_tabindex}"><thead>{weekday_row_template}</thead><tbody>{body_template}</tbody></table>',HEADER_TEMPLATE:'<div class="yui3-g {calendar_hd_class}"><div class="yui3-u {calendar_hd_label_class}" id="{calendar_id}_header" aria-role="heading">{calheader}</div></div>',WEEKDAY_ROW_TEMPLATE:'<tr class="{calendar_weekdayrow_class}" role="row">{weekday_row}</tr>',
CALDAY_ROW_TEMPLATE:'<tr class="{calendar_row_class}" role="row">{calday_row}</tr>',WEEKDAY_TEMPLATE:'<th class="{calendar_weekday_class}" role="columnheader" aria-label="{weekdayname}">{short_weekdayname}</th>',CALDAY_TEMPLATE:'<td class="{calendar_col_class} {calendar_day_class} {calendar_col_visibility_class}" id="{calendar_day_id}" role="gridcell" tabindex="-1">{day_content}</td>',NAME:"calendarBase",ATTRS:{tabIndex:{value:1},date:{value:new Date,setter:function(a){a=this._normalizeDate(a);return y.areEqual(a,
this.get("date"))?this.get("date"):a}},showPrevMonth:{value:!1},showNextMonth:{value:!1},strings:{valueFn:function(){return a.Intl.get("calendar-base")}},headerRenderer:{value:"%B %Y"},enabledDatesRule:{value:null},disabledDatesRule:{value:null},selectedDates:{readOnly:!0,getter:function(){return this._getSelectedDatesList()}},customRenderer:{lazyAdd:!1,value:{},setter:function(a){this._rules=a.rules;this._filterFunction=a.filterFunction}}}})},"3.17.2",{requires:["widget","datatype-date","datatype-date-math",
"cssgrids"],lang:"de en es es-AR fr hu it ja nb-NO nl pt-BR ru zh-Hans zh-Hans-CN zh-Hant zh-Hant-HK zh-HANT-TW".split(" "),skinnable:!0});
YUI.add("calendarnavigator",function(a,d){function b(){b.superclass.constructor.apply(this,arguments)}var c=a.ClassNameManager.getClassName,e=a.Lang.sub,f=a.Node.create,g=c("calendar","header"),h=c("calendarnav","prevmonth"),k=c("calendarnav","nextmonth"),m=c("calendarnav","month-disabled"),l=a.DataType.Date;b.NS="navigator";b.NAME="pluginCalendarNavigator";b.ATTRS={shiftByMonths:{value:1}};b.CALENDARNAV_STRINGS={prev_month_class:h,next_month_class:k};b.PREV_MONTH_CONTROL_TEMPLATE='<a class="yui3-u {prev_month_class}" role="button" aria-label="{prev_month_arialabel}" tabindex="{control_tabindex}" />';
b.NEXT_MONTH_CONTROL_TEMPLATE='<a class="yui3-u {next_month_class}" role="button" aria-label="{next_month_arialabel}" tabindex="{control_tabindex}" />';a.extend(b,a.Plugin.Base,{_eventAttachments:{},_controls:{},initializer:function(){this._controls={};this._eventAttachments={};this.afterHostMethod("renderUI",this._initNavigationControls)},destructor:function(){},_focusNavigation:function(a){a.currentTarget.focus()},_subtractMonths:function(a){if("click"===a.type||"keydown"===a.type&&(13===a.keyCode||
32===a.keyCode)){var b=this.get("host"),c=b.get("date");b.set("date",l.addMonths(c,-1*this.get("shiftByMonths")));a.preventDefault()}},_addMonths:function(a){if("click"===a.type||"keydown"===a.type&&(13===a.keyCode||32===a.keyCode)){var b=this.get("host"),c=b.get("date");b.set("date",l.addMonths(c,this.get("shiftByMonths")));a.preventDefault()}},_updateControlState:function(){var a=this.get("host"),b=a.get("date"),c=l.addMonths(b,a._paneNumber-1),d=a._normalizeDate(a.get("minimumDate")),a=a._normalizeDate(a.get("maximumDate"));
l.areEqual(d,b)?(this._eventAttachments.prevMonth&&(this._eventAttachments.prevMonth.detach(),this._eventAttachments.prevMonth=!1),this._controls.prevMonth.hasClass(m)||this._controls.prevMonth.addClass(m).setAttribute("aria-disabled","true")):(this._eventAttachments.prevMonth||(this._eventAttachments.prevMonth=this._controls.prevMonth.on(["click","keydown"],this._subtractMonths,this)),this._controls.prevMonth.hasClass(m)&&this._controls.prevMonth.removeClass(m).setAttribute("aria-disabled","false"));
l.areEqual(a,c)?(this._eventAttachments.nextMonth&&(this._eventAttachments.nextMonth.detach(),this._eventAttachments.nextMonth=!1),this._controls.nextMonth.hasClass(m)||this._controls.nextMonth.addClass(m).setAttribute("aria-disabled","true")):(this._eventAttachments.nextMonth||(this._eventAttachments.nextMonth=this._controls.nextMonth.on(["click","keydown"],this._addMonths,this)),this._controls.nextMonth.hasClass(m)&&this._controls.nextMonth.removeClass(m).setAttribute("aria-disabled","false"));
this._controls.prevMonth.on(["click","keydown"],this._focusNavigation,this);this._controls.nextMonth.on(["click","keydown"],this._focusNavigation,this)},_renderPrevControls:function(){var a=f(e(b.PREV_MONTH_CONTROL_TEMPLATE,b.CALENDARNAV_STRINGS));a.on("selectstart",this.get("host")._preventSelectionStart);return a},_renderNextControls:function(){var a=f(e(b.NEXT_MONTH_CONTROL_TEMPLATE,b.CALENDARNAV_STRINGS));a.on("selectstart",this.get("host")._preventSelectionStart);return a},_initNavigationControls:function(){var a=
this.get("host"),c=a.get("contentBox").one("."+g);b.CALENDARNAV_STRINGS.control_tabindex=a.get("tabIndex");b.CALENDARNAV_STRINGS.prev_month_arialabel="Go to previous month";b.CALENDARNAV_STRINGS.next_month_arialabel="Go to next month";this._controls.prevMonth=this._renderPrevControls();this._controls.nextMonth=this._renderNextControls();this._updateControlState();a.after(["dateChange","minimumDateChange","maximumDateChange"],this._updateControlState,this);c.prepend(this._controls.prevMonth);c.append(this._controls.nextMonth)}});
a.namespace("Plugin").CalendarNavigator=b},"3.17.2",{requires:["plugin","classnamemanager","datatype-date","node"],skinnable:!0});
YUI.add("squarespace-gizmo",function(a){a.namespace("Squarespace");var d=RegExp("[ ]+","g"),b=RegExp("[^a-zA-Z0-9\\-]","g"),c=function(b,c,d,e,m){return(m?a.Array.reject:a.Array.filter)(b,function(a){for(var b=0;b<d.length;++b)if(a[d[b]]!==e[b])return!1;c&&c(a);return!0})},e=function(b,c,d,k,m){if(!this._destroyed){if(a.Lang.isArray(c))return a.Array.map(c,function(c){return e.apply(this,[b].concat(a.Array(c)))},this);if(a.Lang.isObject(c)&&a.Lang.isFunction(c[b])){var l=[d,k,m||this],l=l.concat(Array.prototype.slice.call(arguments,
5)),l=c[b].apply(c,l);this._eventSubList.push({object:c,event:d,eventSub:l});return l}throw"Gizmo["+this._name+"]: Could not subscribe to event: "+d;}};a.Squarespace.Gizmo=Class.create({_name:"Gizmo",_events:{render:{},rendered:{},destroy:{},destroyed:{}},initialize:function(b){a.augment(this,a.EventTarget,!0,null,{prefix:this._name});this.params=a.merge(b);this._initState();b=this;for(var c=function(a,b){this.publish(b,a)};null!==b&&void 0!==b;)a.Object.each(b._events,c,this),b=b.superclass},getClassNames:function(){for(var a=
this,b=[];;a=a.superclass){if(!a)return b;b.push(a.getClassName())}},_initState:function(){this._parentEl=this._el=null;this._eventSubList=[];this._anims=[];this._timers=[];this.destroyed=this._destroyed=!1;this._children=[];this._guid=a.guid();this._name||(this._name="No Name")},getClassName:function(){return this._name},getId:function(){return this._guid},getCssClassName:function(){var a=this._name,a=a.trim().replace(d,"-").replace(b,"").toLowerCase();return"squarespace-"+a},getElement:function(){return this._el},
render:function(b){this.fire("render");b=b||this._parentEl;this.params.noBoundingBox?this._el=this._render():(this._el=a.Node.create("<div></div>"),this._el.addClass(this.getCssClassName()+"-bbox"),this._el.append(this._render()));b&&a.Lang.isFunction(b.append)&&b.append(this._el);this._parentEl=b;this.fire("rendered")},_render:function(){},_subscribe:function(b,c,d,k){var m=["on"].concat(a.Array(arguments));return e.apply(this,m)},_subscribeOnce:function(b,c,d,k){var m=["once"].concat(a.Array(arguments));
return e.apply(this,m)},_subscribeBefore:function(b,c,d,k){var m=["before"].concat(a.Array(arguments));return e.apply(this,m)},_subscribeAfter:function(b,c,d,k){var m=["after"].concat(a.Array(arguments));return e.apply(this,m)},_unsubscribe:function(b,d){this._eventSubList=c(this._eventSubList,function(a){a.eventSub.detach()},d?["object","event"]:["object"],a.Array(arguments),!0)},_detach:function(a){this._eventSubList=c(this._eventSubList,function(a){a.eventSub.detach()},["eventSub"],[a],!0)},_clearEvents:function(){for(var a=
this._eventSubList,b=0;b<a.length;++b)a[b].eventSub.detach();this._eventSubList=[]},destroy:function(){if(this._destroyed)console.warn("Gizmo["+this._name+"] already destroyed.");else{if(!this._eventSubList)throw console.error("Gizmo not initialized for...",this),"Gizmo["+this._name+"] was never initialzed.  Missing _super?";this.fire("destroy");this._destroy();var b=0;this._clearEvents();this._eventSubList=[];var c=[];a.Array.each(this._anims,function(a){c.push(a)},this);a.Array.each(c,function(a){a.get("running")&&
a.stop(!1);a.destroy()});this._anims=null;for(b=this._children;0<b.length;){var d=b[0];d._removeParent();d.destroy()}this._children=null;d=this._timers;for(b=0;b<d.length;++b)d[b].cancel();this._timers=null;this._el&&a.Lang.isFunction(this._el.remove)&&(this._el.remove(),this._el=null);this.destroyed=this._destroyed=!0;this.fire("destroyed")}},_destroy:function(){},isDestroyed:function(){return this._destroyed},_setParent:function(a){this._parentGizmo=a},_removeParent:function(){this._parentGizmo&&
(this._parentGizmo._removeChild(this),this._parentGizmo=null)},_addChild:function(a){this._children&&(a._setParent&&a._setParent(this),this._children.push(a))},_removeChild:function(a){this._children.splice(this._children.indexOf(a),1)},_getChildren:function(){return this._children},_anim:function(b){if(!this._destroyed){if(!b.node)throw"Gizmo["+this._name+"]: Animation must specify a node!";var c;b.node.ancestor("body",!0)?b.node._node?(c=new a.Anim(b),c.on("end",function(a){this._removeAnim(c)},
this),this._anims.push(c)):(console.warn("Gizmo["+this._name+"]: _anim passed a YUI node with _node = null! Returning an empty animation."),console.trace(),c=new a.Anim):(console.warn("Gizmo["+this._name+"]: _anim passed a YUI node not in the DOM! Returning an empty animation."),c=new a.Anim);return c}},_removeAnim:function(a){a=this._anims.indexOf(a);-1!==a&&this._anims.splice(a,1)},_trace:function(b){for(var c=this.getEvent(b).getSubs(),d=[],e=function(a,b){if(a.context&&a.context.getName)d.push(a.context.getName());
else{var c={};c[a.fn.name]=a.fn.toString();d.push(c)}},m=0;m<c.length;++m)a.Object.each(c[m],e);console.log("[trace] Event",b,"is notifying the following:",d);this.fire(b)},_later:function(b,c,d,e,m){if(!this._destroyed)return b=a.later(b,d||this,c,e,m),this._timers.push(b),b},_cb:function(b){return a.bind(function(){if(!this._destroyed)return b.apply(this,arguments)},this)}});a.augment(a.Squarespace.Gizmo,a.EventTarget);a.Squarespace.ZombieGizmo=Class.extend(a.Squarespace.Gizmo,{_name:"ZombieGizmo",
_events:{resurrect:{},resurrected:{}},initialize:function(a){this._super(a)},destroy:function(){this._super();this.resurrect()},resurrect:function(){this.fire("resurrect");this._initState();this.fire("resurrected")}})},"1.0",{requires:["array-extras","node","event-custom"]});
YUI.add("squarespace-toggle",function(a){function d(){d.superclass.constructor.apply(this,arguments)}a.namespace("Squarespace.Widgets").ToggleButton=a.Base.create("toggleButton",a.Widget,[a.WidgetChild],{renderUI:function(){var b=this.get("contentBox"),c=this.get("active")?"active":"inactive";b.append(a.DB.DIV("switch-box-container animate "+c,a.DB.DIV("switch-box",a.DB.DIV("toggle-box",a.DB.DIV("togglebg",a.DB.DIV("on",{html:this.get("onLabel")}),a.DB.DIV("off",{html:this.get("offLabel")})))),a.DB.DIV("switch-shadow",
{html:"&nbsp;"}),a.DB.DIV("handle-wrapper",a.DB.DIV("handle",{html:"&nbsp;"}))))},destructor:function(){a.detachAll(this.get("id")+"|*")},bindUI:function(){var a=this.get("contentBox"),c=this.get("id");a.one(".handle-wrapper").on(c+"|click",this._onClick,this);this.after(["activeChange","enabledChange"],this.syncUI,this)},_onClick:function(a){a.halt();this.get("enabled")&&this.set("active",!this.get("active"))},syncUI:function(){var a=this.get("contentBox"),c=a.one(".switch-box-container"),a=a.all(".togglebg, .handle"),
d=this.get("active");a.setStyles({marginLeft:null,left:null});d?c.removeClass("inactive").addClass("active"):c.removeClass("active").addClass("inactive");c=this.get("boundingBox");this.get("enabled")?c.removeClass("disabled").addClass("enabled"):c.removeClass("enabled").addClass("disabled")}},{CSS_PREFIX:"sqs-toggle-button",ATTRS:{active:{value:!1},onLabel:{value:"On"},offLabel:{value:"Off"},enabled:{value:!0}}});d.NAME="toggleDragPlugin";d.NS="drag";a.extend(d,a.Plugin.Base,{initializer:function(){this._host=
this.get("host");this.afterHostMethod("bindUI",this._afterBindUI)},destructor:function(){a.detachAll(this.get("id")+"|*");this._handleDrag&&this._handleDrag.destroy()},_afterBindUI:function(){var b=this._host.get("contentBox");b.one(".switch-box");b.one(".handle-wrapper").get("region");var c=this.get("id");this._handleDrag=new a.DD.Drag({node:b.one(".handle")});this._handleDrag.plug(a.Plugin.DDProxy);this._handleDrag.on(c+"|drag:start",this._onDragStart,this);this._handleDrag.on(c+"|drag:drag",this._onDragDrag,
this);this._handleDrag.on(c+"|drag:end",this._onDragEnd,this)},_onDragStart:function(b){b=b.target;var c=this._host.get("contentBox").one(".handle-wrapper").get("region");b.hasPlugin("con")||b.plug(a.Plugin.DDConstrained,{constrain:c})},_onDragDrag:function(a){var c=a.target,d=this._host.get("contentBox"),f=this.get("maxValue"),g=d.one(".handle-wrapper").getX(),c=Math.abs(g-c.lastXY[0]),c=Math.max(0,c),c=Math.min(f,c);d.one(".togglebg").setStyle("marginLeft",c);d.one(".handle").setStyle("left",a.target.get("dragNode").getX()-
d.one(".handle-wrapper").getX())},_onDragEnd:function(a){a=a.target;var c=a.get("node"),d=a.con.get("constrain"),d=Math.abs(d.left-d.right);a=Math.abs(a.nodeXY[0]-a.lastXY[0])/(d-c.get("offsetWidth"));c=this._host.get("active");0.5<a&&this._host.set("active",!c);this._host.get("active")===c&&this._host.syncUI()}},{ATTRS:{resistance:{value:10},maxValue:{value:70}}});a.Squarespace.ToggleDrag=d},"1.0",{requires:["widget","widget-child","dd-drag","dd-constrain","dd-proxy"]});
YUI.add("squarespace-structured-input",function(a){a.namespace("Squarespace.Widgets");var d=a.Squarespace.Widgets.StructuredInput=a.Base.create("structuredInput",a.Squarespace.Widgets.SSWidget,[a.WidgetChild],{destructor:function(){this._cursorBlinkInterval&&this._cursorBlinkInterval.cancel();this._scrapeInterval&&this._scrapeInterval.cancel();this._resumeBlinkTimer&&this._resumeBlinkTimer.cancel();this.tooltip&&this.tooltip.destroy()},renderUI:function(){d.superclass.renderUI.call(this);var a=this.get("contentBox");
this.targetEl=a;this.contentEl=a.one(".structured-content");this.cursorEl=a.one(".cursor");this.helpEl=a.one(".help-tag");this.inputEl=a.one("input");this.get("tabIndex")&&this.inputEl.set("tabIndex",this.get("tabIndex"));var c=parseInt(a.getStyle("paddingLeft"),10),e=parseInt(a.getStyle("paddingTop"),10),a=a.get("offsetHeight")-2*e;this.set("topPadding",e);this.set("leftPadding",c);this.set("lineHeight",a);this.cursorEl.setStyle("height",a+"px");this.cursorEl.setStyle("top",e+"px");this._configureToolTip();
this._scrapeChars()},bindUI:function(){d.superclass.bindUI.call(this);var a=this.get("contentBox"),c=a.one("input");a.on("mousedown",this._startDragging,this);a.on("mousemove",this._dragTextInput,this);a.on("mouseup",this._endDragging,this);a.on("dblclick",this._selectAllInput,this);c.on("focus",this._handleOnFocus,this);c.on("blur",this._handleBlurEvent,this);c.on("keydown",this._handleTextInput,this)},syncUI:function(){d.superclass.syncUI.call(this);this._updateContent();this._updateCursor()},_handleTextInput:function(b){var c=
b.keyCode,d=this.hasSel();this._pauseBlink();if((8===c||46===c)&&d)this.deleteSelection();else if(b.shiftKey&&!d&&(this.selEnd=this.selStart=this.cursorPos),8===c)this.deleteChars(this.cursorPos-1,1);else if(46===c)this.deleteChars(this.cursorPos,1);else if(65===c&&b.metaKey)this.selStart=this.cursorPos=0,this.selEnd=this.length(),this._updateCursor();else if(38===c)this.cursorPos=0,b.shiftKey?this.selEnd=this.cursorPos:d&&this._clearSel(),this.movingLeft=!0,this._updateCursor();else if(40===c)this.cursorPos=
this.length(),b.shiftKey?this.selEnd=this.cursorPos:d&&this._clearSel(),this.movingLeft=!1,this._updateCursor();else if(37===c){if(b.shiftKey){if(0===this.selEnd)return;this.selEnd--}else if(d)this.cursorPos=Math.min(this.selStart,this.selEnd),this._clearSel();else{if(0===this.cursorPos)return;this.cursorPos--}this.movingLeft=!0;this._updateCursor()}else if(39===c){if(b.shiftKey){if(this.selEnd==this.length())return;this.selEnd++}else if(d)this.cursorPos=Math.max(this.selStart,this.selEnd),this._clearSel();
else{if(this.cursorPos==this.length())return;this.cursorPos++}this.movingLeft=!1;this._updateCursor()}else a.later(1,this,this._scrapeChars)},_handleOnFocus:function(a){this._startScrape();this._resumeBlink();this.hasSel()||this.cursorEl.setStyle("display","block")},_handleBlurEvent:function(a){this.mousepressed=!1;this._stopScrape();this._clearSel();this._pauseBlink();this._updateCursor();this.cursorEl.setStyle("display","none")},_startDragging:function(a){this.mousepressed=!0;this.focus(a);a.halt()},
_dragTextInput:function(a){this.mousepressed&&(this.hasSel()||(this.selStart=this.cursorPos),a=a.clientX-this.targetEl.getXY()[0]-this.get("leftPadding")-this.get("fieldScroll"),this.selEnd=this.getDistanceToPos(a,"px"),this._updateCursor())},_endDragging:function(a){this.mousepressed=!1},focus:function(a){var c=this.length(),d=!1;a?(a=a.clientX-this.targetEl.getXY()[0]-this.get("leftPadding")-this.get("fieldScroll"),this.cursorPos=this.getDistanceToPos(a,"px")):this.cursorPos=c;!this.get("focused")&&
this.cursorPos==c&&(this.selStart=c,this.selEnd=0,d=this.get("selectAllOnFocus"));d||this._clearSel();this._updateCursor();this.inputEl.focus()},_stopScrape:function(){this._scrapeInterval&&this._scrapeInterval.cancel()},_startScrape:function(){this._scrapeInterval=a.later(50,this,this._scrapeChars,null,!0)},_scrapeChars:function(){var b=this.inputEl.get("value");this.inputEl.set("value","");a.Lang.isString(b)&&0<b.length&&(this.hasSel()&&this.deleteSelection(),this.insertChars(b))},_pauseBlink:function(){this._cursorBlinkInterval&&
(this._cursorBlinkInterval.cancel(),this._cursorBlinkInterval=null,this.cursorEl.setStyle("visibility","visible"),this._resumeBlinkTimer&&this._resumeBlinkTimer.cancel(),this._resumeBlinkTimer=a.later(400,this,this._resumeBlink))},_resumeBlink:function(){this._cursorBlinkInterval||(this._resumeBlinkTimer&&(this._resumeBlinkTimer.cancel(),this._resumeBlinkTimer=null),this._cursorBlinkInterval=a.later(600,this,this._blinkCursor,null,!0));this.cursorEl.setStyle("visibility","visible")},_blinkCursor:function(){"hidden"==
this.cursorEl.getStyle("visibility")?this.cursorEl.setStyle("visibility","visible"):this.cursorEl.setStyle("visibility","hidden")},_updateCursor:function(){var b,c=this.get("leftPadding"),d=this.get("fieldScroll");if(this.hasSel()){var f=this.getDistanceToPos(this.selStart,"cursor"),g=this.getDistanceToPos(this.selEnd,"cursor");b=this.movingLeft?Math.min(f,g):Math.max(f,g);this.selEl||(this.selEl=a.Node.create('<div class="sel"></div>'),this.targetEl.append(this.selEl),this.selEl.setStyles({top:parseInt(this.cursorEl.getStyle("top"),
10)-1+"px",height:this.get("lineHeight")+4+"px"}),this.cursorEl.setStyle("display","none"));this.selEl.setStyles({left:c+Math.min(f,g)+d+"px",width:Math.abs(f-g)+"px"})}else a.Lang.isUndefined(this.cursorPos)&&(this.cursorPos=this.length()),b=f=this.getDistanceToPos(this.cursorPos,"cursor"),this.cursorEl.setStyle("left",c+f+"px"),this.selEl&&(this.selEl.remove(),this.selEl=null,this.cursorEl.setStyle("display","block"));c=this.targetEl.get("offsetWidth")-64;f=!1;if(b+d-1>c){for(;b+d-1>c;)d-=60;f=
!0}else if(b<-d){for(;b<-d;)d+=60;f=!0}f&&(this.contentEl.setStyle("margin-left",d+"px"),this.cursorEl.setStyle("margin-left",d+"px"));this.set("fieldScroll",d)},_updateContent:function(){var b=this.get("value"),c,d,f="";if(0===b.length)this.contentEl.setContent("&nbsp;");else{this.contentEl.setContent("");for(d=0;d<b.length;++d)if(this.isVariableAt(b,d)){0<f.length&&(c=a.Node.create("<span>"+this.escapeBuffer(f)+"</span>"),this.contentEl.append(c),f="");c=b[d]+b[d+1];var g=this.get("variables")[c];
g?(c=a.Node.create('<span class="unbreakable">'+g.title+"</span>"),c.setAttribute("title",g.tip),this.contentEl.append(c)):f+=c;d+=this.getVariableLengthAt(b,d)-1}else f+=b[d];0<f.length&&(c=a.Node.create("<span>"+this.escapeBuffer(f)+"</span>"),this.contentEl.append(c))}},insertChars:function(a){var c=this._compressVariables(this.get("value")),d=c.substring(0,this.cursorPos),c=c.substring(this.cursorPos);this.set("value",this._uncompressVariables((d+a+c).replace(RegExp("\\s+","g")," ")));this.cursorPos+=
a.length;this.syncUI()},escapeBuffer:function(a){return a.replace(RegExp("&","g"),"&amp;").replace(RegExp("\\s+","g"),"&nbsp;")},unescapeBuffer:function(a){return a.replace(RegExp("&nbsp;","g")," ").replace(RegExp("&amp;","g"),"&")},isVariableAt:function(b,c){var d;if(!("%"!=b[c]||c+1>=b.length))return d=this.get("variables")[this.getVariableAt(b,c)],!a.Lang.isUndefined(d)},getVariableAt:function(a,c){return a[c]+a[c+1]},getVariableLengthAt:function(a,c){return 2},_compressVariables:function(a){var c=
"",d,f;this.varStack=[];for(f=0;f<a.length;++f){if(this.isVariableAt(a,f)&&(d=this.getVariableAt(a,f),this.get("variables")[d])){this.varStack.push(d);c+="\u0001";f+=this.getVariableLengthAt(a,f)-1;continue}c+=a[f]}return c},_uncompressVariables:function(a){var c="",d=0,f,g;f=0;for(g=a.length;f<g;++f)this.isVariableAt(a,f)&&(this.cursorPos-=this.getVariableLengthAt(a,f)-1),"\u0001"==a[f]?(c+=this.varStack[d],++d):c+=a[f];delete this.varStack;return c},_varCount:function(a){for(var c=0,d=-1;;){d=a.indexOf("\u0001",
d);if(-1==d)break;c++;d++}return c},deleteChars:function(a,c){if(!(0>a)){var d=this._compressVariables(this.get("value")),f=d.substring(0,a),g=d.substring(a,a+c),d=d.substring(a+c),g=this._varCount(g);if(0<g)for(var h=this._varCount(f);0<g;)this.varStack.splice(h,1),g--;this.set("value",this._uncompressVariables(f+d));a<this.cursorPos&&(this.cursorPos-=c);this.syncUI()}},deleteSelection:function(){this.deleteChars(Math.min(this.selStart,this.selEnd),Math.abs(this.selStart-this.selEnd));this.cursorPos=
Math.min(this.selStart,this.selEnd);this._clearSel();this._updateCursor()},length:function(){return this._compressVariables(this.get("value")).length},getDistanceToPos:function(b,c){if(0===b)return 0;var d=a.Node.create('<span class="measure-span" style="visibility: hidden; left: -9999px"></span>'),f=0,g,h;this.targetEl.append(d);this.contentEl.all("span").each(function(k){if(!("cursor"==c&&f==b||"px"==c&&d.get("offsetWidth")>=b))if(k.hasClass("unbreakable"))f++,d.append(a.Node.create('<span class="unbreakable">'+
k.getContent()+"</span>")),"px"==c&&d.get("offsetWidth")>=b&&f--;else if(k=this.unescapeBuffer(k.getContent()),"cursor"==c){var l="";g=0;for(h=k.length;g<h&&!(l+=k[g],f++,f==b);++g);""!==l&&d.append(a.Node.create("<span>"+this.escapeBuffer(l)+"</span>"))}else{l=a.Node.create("<span></span>");d.append(l);g=0;for(h=k.length;g<h;++g){var n=k[g];f++;" "==n&&(n="&nbsp;");l.setContent(l.getContent()+n);if(d.get("offsetWidth")>=b){f--;break}}}},this);var k=d.get("offsetWidth");d.remove();return"cursor"==
c?k:f},_configureToolTip:function(){var b="This field accepts variables.  Type one of the codes below to activate a variable:<br/><br/>";a.Object.each(this.get("variables"),function(c,d){b+=a.Lang.sub("<strong>{key}</strong> &mdash; {tip}<br>",{key:d,tip:c.tip})});this.tooltip=new a.Squarespace.ToolTip({target:this.helpEl,title:"Formatting",dialogTooltip:!0,body:b.trim(),showTimeout:200,width:300,clickToShow:!0})},_clearSel:function(){delete this.selStart;delete this.selEnd},hasSel:function(){return!a.Lang.isUndefined(this.selStart)&&
!a.Lang.isUndefined(this.selStart)},_selectAllInput:function(){this.selStart=0;this.selEnd=this.length();this._updateCursor()}},{CSS_PREFIX:"sqs-structured-input",TEMPLATE:'<div><input class="structured-text-input" type="text"/><div class="structured-content"> </div><div class="help-tag"> </div><div class="cursor"></div></div>',ATTRS:{fieldScroll:{value:0},lineHeight:{},leftPadding:{},topPadding:{},tabIndex:{},targetEl:{},selectAllOnFocus:{value:!1},strings:{},value:{value:"",validator:a.Lang.isString},
variables:{}}})},"1.0",{requires:["base","squarespace-ss-widget","widget-child","squarespace-dombuilder","squarespace-ui-base"]});
YUI.add("squarespace-mailcheck",function(a){a.namespace("Squarespace.Plugin");a.Squarespace.Plugin.MailCheck=a.Base.create("MailCheck",a.Plugin.Base,[],{initializer:function(a){this._host=a.host;this._host.on("blur",this.checkMailAddress,this)},checkMailAddress:function(d){d=this._host.get("value");null!==d&&3<d.length&&Kicksend.mailcheck.run({email:d,suggested:a.bind(this.emailSuggestions,this),empty:a.bind(this.noEmailSuggestions,this)})},emailSuggestions:function(d){this._host.hasPlugin("flyoutPlugin")||
this._host.plug(a.Squarespace.Animations.Flyout,{duration:0.3});this.get("field").showError('Did you mean <a class="corrected-email" href="#">'+d.full+"</a>?");if(a.one(".corrected-email"))a.one(".corrected-email").once("click",this._onClick,this)},noEmailSuggestions:function(a){(a=this._host.flyoutPlugin)&&a.hide()},_onClick:function(a){a.preventDefault();a.halt();if(a=this._host.flyoutPlugin)this._host.set("value",a.get("node").one("a").getHTML()),a.hide(),this.get("field").clearError()},destructor:function(){}},
{NS:"mailCheck",ATTRS:{field:{}}})},"1.0",{requires:["thirdparty-kicksend","squarespace-node-flyout"]});
var Kicksend={mailcheck:{threshold:3,defaultDomains:"yahoo.com google.com hotmail.com gmail.com me.com aol.com mac.com live.com comcast.net googlemail.com msn.com hotmail.co.uk yahoo.co.uk facebook.com verizon.net sbcglobal.net att.net gmx.com mail.com".split(" "),defaultTopLevelDomains:"co.uk com net org info edu gov mil au com.au se de me dk co.nz it be".split(" "),run:function(a){a.domains=a.domains||Kicksend.mailcheck.defaultDomains;a.topLevelDomains=a.topLevelDomains||Kicksend.mailcheck.defaultTopLevelDomains;
a.distanceFunction=a.distanceFunction||Kicksend.sift3Distance;var d=Kicksend.mailcheck.suggest(encodeURI(a.email),a.domains,a.topLevelDomains,a.distanceFunction);d?a.suggested&&a.suggested(d):a.empty&&a.empty()},suggest:function(a,d,b,c){a=a.toLowerCase();a=this.splitEmail(a);if(d=this.findClosestDomain(a.domain,d,c)){if(d!=a.domain)return{address:a.address,domain:d,full:a.address+"@"+d}}else if(b=this.findClosestDomain(a.topLevelDomain,b),a.domain&&b&&b!=a.topLevelDomain)return d=a.domain,d=d.substring(0,
d.lastIndexOf(a.topLevelDomain))+b,{address:a.address,domain:d,full:a.address+"@"+d};return!1},findClosestDomain:function(a,d,b){var c,e=99,f=null;if(!a||!d)return!1;b||(b=this.sift3Distance);for(var g=0;g<d.length;g++){if(a===d[g])return a;c=b(a,d[g]);c<e&&(e=c,f=d[g])}return e<=this.threshold&&null!==f?f:!1},sift3Distance:function(a,d){if(null==a||0===a.length)return null==d||0===d.length?0:d.length;if(null==d||0===d.length)return a.length;for(var b=0,c=0,e=0,f=0;b+c<a.length&&b+e<d.length;){if(a.charAt(b+
c)==d.charAt(b+e))f++;else for(var g=e=c=0;5>g;g++){if(b+g<a.length&&a.charAt(b+g)==d.charAt(b)){c=g;break}if(b+g<d.length&&a.charAt(b)==d.charAt(b+g)){e=g;break}}b++}return(a.length+d.length)/2-f},splitEmail:function(a){a=a.split("@");if(2>a.length)return!1;for(var d=0;d<a.length;d++)if(""===a[d])return!1;var b=a.pop(),c=b.split("."),e="";if(0==c.length)return!1;if(1==c.length)e=c[0];else{for(d=1;d<c.length;d++)e+=c[d]+".";2<=c.length&&(e=e.substring(0,e.length-1))}return{topLevelDomain:e,domain:b,
address:a.join("@")}}}};window.jQuery&&function(a){a.fn.mailcheck=function(a){var b=this;if(a.suggested){var c=a.suggested;a.suggested=function(a){c(b,a)}}if(a.empty){var e=a.empty;a.empty=function(){e.call(null,b)}}a.email=this.val();Kicksend.mailcheck.run(a)}}(jQuery);YUI.add("thirdparty-kicksend",function(a){},"1.0",{});
YUI.add("squarespace-dialog-fields-generators",function(a){function d(a){return!{13:!0,27:!0,16:!0,17:!0,18:!0,20:!0,36:!0,35:!0,33:!0,34:!0,37:!0,38:!0,39:!0,40:!0,112:!0,113:!0,114:!0,115:!0,116:!0,117:!0,118:!0,119:!0,120:!0,121:!0,122:!0,123:!0,45:!0,91:!0,144:!0}[a]}a.namespace("Squarespace.DialogFieldGenerators");a.Squarespace.DialogFieldGenerators["multi-frame"]=Class.extend(a.Squarespace.DialogField,{initialize:function(b,c,d){this._super(b,c,d);this.frames={};this.activeEl=null;this.value=
this.config.initialFrame;this.panel.bodyEvents.push(a.on("click",this.onClick,this.html,this))},onClick:function(a){this.panel.fire("datachange",this)},show:function(b){var c=this.frames[b];if(this.activeEl){if(this.activeEl==c)return;this.activeEl.a&&this.activeEl.a.stop();var d=this.activeEl.fields;this.activeEl.a=this._anim({node:this.activeEl.el,to:{height:0},duration:0.3,easing:a.Easing.easeOutStrong});d.forEach(this.setInActiveFrame(!1),this);this.activeEl.a.on("end",function(a){a.target.get("node").addClass("hidden")},
this);this.activeEl.a.run()}c.a&&c.a.stop();this.activeEl&&c.el.ancestor().insertBefore(c.el,this.activeEl.el.next());c.el.removeClass("hidden");d=c.el.getStyle("height");c.el.setStyles({height:null});c.realHeight=c.el.get("offsetHeight");c.el.setStyles({height:d});c.a=this._anim({node:c.el,to:{height:c.realHeight},duration:0.3,easing:a.Easing.easeOutStrong});c.a.on("end",function(a,b){for(var c=0;c<b.fields.length;++c){var d=this.panel.fields[b.fields[c].name];d&&d.updateInlineTitle&&d.updateInlineTitle()}this.focusCurrentFrame()},
this,c);c.a.run();c.fields.forEach(this.setInActiveFrame(!0),this);this.activeEl=c;this.value=b},focusCurrentFrame:function(){for(var b,c=0;c<this.activeEl.fields.length;++c)if(b=this.activeEl.fields[c],b=this.panel.fields[b.name||a.Object.getValue(b,["config","name"])],a.Lang.isValue(b)&&b.getNode){b.getNode().focus();break}},setInActiveFrame:function(a){return function(c){c.name&&(c=this.panel.getField(c.name),c.inActiveFrame=a,c.fire("mutli-frame-focus"))}},append:function(b,c,d,f){for(var g in this.config.frames){c=
this.config.frames[g];var h=a.DB.DIV("frame-wrapper clear");d.append(h);this.panel._renderFields(b,c.fields,h,f);this.frames[g]=this.config.frames[g];this.frames[g].el=h;this.frames[g].realHeight=h.get("offsetHeight");g!=this.config.initialFrame?(h.setStyle("height","0px"),h.addClass("hidden"),this.frames[g].visible=!1,this.config.frames[g].fields.forEach(this.setInActiveFrame(!1),this)):(this.activeEl=this.frames[g],this.frames[g].visible=!0,this.config.frames[g].fields.forEach(this.setInActiveFrame(!0),
this))}}});a.Squarespace.DialogFieldGenerators.select=Class.extend(a.Squarespace.DialogField,{initialize:function(b,c,d){this._super(b,c,d);this.config.options||(this.config.options=[],console.warn("Select '"+this.config.name+"' has no options."));this.config.icon||(this.config.icon="",this.noIcon=!0);this.control=a.DB.DIV("field-input-wrapper select "+(this.config.className?this.config.className:""),{html:"&nbsp;"});this.config.width?a.Lang.isNumber(this.config.width)?1<=this.config.width&&(this.selectElWidth=
this.config.width+"px"):a.Lang.isString(this.config.width)?this.selectElWidth=this.config.width:console.log("dialog: [DialogField] Width is not a number or string",this):this.selectElWidth=!1;this.underlyingControl=a.DB.SELECT("input",{tabIndex:d.getNextTabIndex(),style:"position: absolute; top: 0; left: 0px; opacity: 0"});var f,g;for(g in this.config.options)c[this.config.name]==g&&(this.value=g),f||(f=g),this.underlyingControl.append(a.DB.OPTION({html:this.config.options[g].title,value:g}));if(a.Lang.isUndefined(this.value)||
a.Lang.isNull(this.value)||!this.config.options[this.value])null!=this.config.defaultValue&&!a.Lang.isUndefined(this.config.defaultValue)&&this.config.options[this.config.defaultValue]?this.value=this.config.defaultValue:this.value=f;this.html=a.DB.DIV("field-wrapper select-field-wrapper clear thin dialog-field-"+this.config.name,this.config.title?a.DB.DIV("field-title",{html:this.config.title}):null,a.DB.DIV("field-wrapper-inner clear"+(this.config.icon?" icon "+this.config.icon:""),{style:"position: relative;"+
(this.selectElWidth?"width: "+this.selectElWidth:"")},a.DB.DIV("field-rhs",this.control),this.underlyingControl),this.config.description?a.DB.DIV("field-description-wrapper",a.DB.DIV("field-description",{html:this.config.description})):null);this.setValue(this.value);this._subscribe([[this.html.one(".field-wrapper-inner"),"click",this.onClick],[this.underlyingControl,"change",this.onChange]]);this.config.onChange&&this._subscribe([[this.underlyingControl,"change",this.config.onChange]]);a.Object.isEmpty(this.config.options)&&
this.html.setStyle("display","none");b.hidden&&this.temporaryHide(!0)},didDataChange:function(){return a.Lang.isNumber(Number(this.initialData[this.getName()]))&&a.Lang.isNumber(this.getValue())?Number(this.initialData[this.getName()])!=Number(this.getValue()):this.initialData[this.getName()]!=this.getValue()},updateOptions:function(b,c){b=b||{};this.html.setStyle("display",a.Object.isEmpty(b)?"none":null);this.config.options=b;this.underlyingControl.set("innerHTML","");a.Object.each(b,function(c,
d){this.underlyingControl.append(a.DB.OPTION({html:b[d].title,value:d}))},this);!a.Lang.isUndefined(c)&&null!=b[c]&&(this.setValue(c),this.html.one(".field-input-wrapper.select").setContent(this.getValueTitle(c)))},onClick:function(a){a.halt();if(!this._disabled&&"SELECT"!=a.target.get("tagName")){if(a.target.hasClass("field-wrapper-inner"))a=a.target;else{if(a.target.ancestors(".field-wrapper-inner").isEmpty())return;a=a.target.ancestors(".field-wrapper-inner").item(0)}a.one("select").simulate("mousedown")}},
show:function(){if(!this.noIcon){var a=parseInt(this.html.get("offsetWidth"),10)-parseInt(this.html.getStyle("paddingLeft"),10)-5;this.underlyingControl.setStyle("width",a+"px")}},onChange:function(){this.setValue(this.underlyingControl.get("value"));this.fire("change",this.getValue());this.dialog.fire("datachange",this)},hideDescription:function(){this.html.one(".field-description").hide()},showDescription:function(a){this.html.one(".field-description").show();this.html.one(".field-description").setContent(a)},
getDescription:function(){return this.html.one(".field-description")},rollback:function(){this.setValue(this.previousValue);this.html.one(".field-input-wrapper.select").setContent(this.getValueTitle(this.getValue()))},setValue:function(b){this.previousValue=this.value;this.value=b;this.underlyingControl.set("value",b);a.Object.isEmpty(this.config.options)||(this.control.setContent(this.getValueTitle()),this.getValueIsEmpty()?this.html.addClass("empty-value"):this.html.removeClass("empty-value"))},
getPreviousValue:function(){return this.previousValue},getValue:function(){return this.underlyingControl.get("value")},getValueTitle:function(){return this.config.options[this.underlyingControl.get("value")].title},getValueIsEmpty:function(){return this.config.options[this.underlyingControl.get("value")].empty},disable:function(){this._disabled=!0;this.underlyingControl.setAttribute("disabled","disabled");this.html.addClass("disabled")},enable:function(){this._disabled=!1;this.underlyingControl.removeAttribute("disabled");
this.html.removeClass("disabled")}});a.Squarespace.DialogFieldGenerators["multi-option"]=Class.extend(a.Squarespace.DialogField,{initialize:function(b,c,d){this._super(b,c,d);this.config.options=this.config.options.filter(function(b){return!a.Lang.isUndefined(b)&&!a.Lang.isNull(b)});this.value=c[this.config.name]?c[this.config.name]:this.config.defaultValue;this.config.columns||(this.config.columns=this.config.options.length);!this.value&&this.config.multi&&(this.value=[]);this.options=[];this.tips=
[];this.remover={};this.dds=[];for(b=0;b<this.config.options.length;++b)if(c=this.config.options[b]){if(this.config.multi){d=!1;for(var f=0;f<this.value.length;++f)if(this.value[f]==c.value){d=!0;break}}else d=c.value==this.value;if(!c.disabled||!this.config.hideDisabled&&c.disabled)d=a.DB.DIV("multioption-element option-"+c.value+(d?" active":"")+(this.config.buttonStyle?" button":"")+(this.config.optionStyle?" "+this.config.optionStyle:"")+(c.optionStyle?" "+c.optionStyle:"")+(c.disabled?" disabled":
""),{html:'<div class="text clear"><div class="title">'+c.title+"</div>"+(c.description?'<div class="description">'+c.description+"</div>":"")+"</div>",style:"background-position: center "+this.config.iconDropPx+"px; padding: "+this.config.optionPadding,data:{value:c.value}}),c.icon&&d.setStyle("backgroundImage","url("+c.icon+")"),this.config.height&&d.setStyle("height",this.config.height),!c.title&&!c.description&&d.setStyle("visibility","hidden"),this.options.push(d),this.remover[c.value]=d,c.value==
this.value&&(this.activeEl=d),this.config.dragTray&&(d.setStyle("cursor","move"),d.setData(c),d=(new a.DD.Drag({node:d})).plug(a.Plugin.DDProxy,{moveOnEnd:!1,hideOnEnd:!1,borderStyle:"none"}),this.dds.push(d),d.on("drag:start",function(b,c,d){b=b.target.get("node");a.one("body").append(b);b.addClass("free-block reattached-node");this.dds.splice(this.dds.indexOf(c),1);this.panel.close()},this,d,c.value),d.on("drag:end",function(b,c,d){b=a.DD.DDM.activeDrag;d=b.get("node");b.get("dragNode").transition({easing:"ease-out",
transform:{value:!d.placeholder?"scale(1.04)":"scale(.6)",duration:0.4},opacity:{value:0,duration:0.4}},function(){this.setStyle("display","none");this.setStyle("transform","");this.setStyle("opacity","")});c.destroy();(c=a.one("body").one(".reattached-node"))&&c.remove()},this,d,c.value),this.config.attachDragHandlers(d))}this.empty=a.DB.DIV("multioption-placeholder",{style:this.config.backgroundIcon?"backgroundImage: url("+this.config.backgroundIcon+")":""});this.elements=a.DB.DIV("field-input-wrapper",
0<this.options.length?this.options:this.empty);this.control=this.html=a.DB.DIV("field-wrapper multioption-field-wrapper clear "+(this.config.alwaysShowTitles?" show-titles ":"")+(this.config.style?this.config.style:""),this.config.padding?{style:"padding-top: "+this.config.padding[0]+"; padding-bottom: "+this.config.padding[1]+";"}:null,this.config.title&&("left"==this.config.titleStyle||"top"==this.config.titleStyle)?a.DB.DIV("field-lhs "+this.config.titleStyle,{html:this.config.title}):null,a.DB.DIV("field-rhs",
this.elements,this.config.description?a.DB.DIV("field-description-wrapper",a.DB.DIV("field-description "+this.config.titleStyle,{html:this.config.description})):null));this.panel.bodyEvents.push(a.on("click",this.onClick,this.html,this));this.panel.bodyEvents.push(a.on("contextmenu",this.onRightClick,this.html,this))},show:function(){this.config.options.forEach(function(b){var c=a.one(".option-"+b.value);b.tip&&c&&this.tips.push(new a.Squarespace.ToolTip({target:c,alwaysEnable:!0,title:b.tip.title,
body:b.tip.text,dialogTooltip:!0}))},this)},onRightClick:function(a){var c=a.target.ancestor(".multioption-element",!0);if(c){var d=this.value;this.value=c.data().value;this.panel.fire("contextmenu",this);this.value=d;a.halt()}},onClick:function(a){this.previousValue=this.value;var c=a.target.ancestor(".multioption-element",!0);a.halt();if(c){a=c.getData();var d=a.value;d&&(c.hasClass("disabled")?this.fire("disabled-click",a.value):(this.panel.fire("multioption-click",c.data().value),this.config.multi?
(c.toggleClass("active"),this.value=[],this.html.all(".multioption-element.active").each(function(a){this.value.push(a.data().value)},this)):(this.activeEl&&this.activeEl.removeClass("active"),c.addClass("active"),this.activeEl=c,this.value=d),this.config.linkFrame&&this.panel.getField(this.config.linkFrame).show(this.value),this.panel.fire("datachange",this,a)))}},resize:function(){var a=parseInt(this.html.getStyle("width"),10);"left"==this.config.titleStyle&&(a-=110);for(var a=(a-2*this.config.columns)/
this.config.columns,c=0;c<this.options.length;++c)this.options[c].setStyle("width",a+"px")},add:function(b,c,d){this.empty.setStyle("display","none");c=a.DB.DIV("multioption-element "+(b==this.value?"active":"")+(this.config.buttonStyle?"button":""),{html:'<div class="multioption-thumbnail" style="background-image:url('+c+')"></div><div class="multioption-title">'+d+"</div>",style:"padding: "+this.config.optionPadding+(this.config.height?"height: "+this.config.height+"px;":""),data:{value:b}});this.remover[b]=
c;this.elements.appendChild(this.remover[b])},remove:function(a){this.remover[a]&&(this.remover[a].remove(),delete this.remover[a])},clear:function(){for(var a in this.remover)!1!==a&&void 0!==a&&(this.remover[a].remove(),delete this.remover[a]);this.empty.setStyle("display","block")},setHighlight:function(a){this.remover[a]&&this.remover[a].addClass("highlighted")},removeHighlight:function(a){this.remover[a]&&this.remover[a].removeClass("highlighted")},clearHighlight:function(a){this.html.all(".multioption-element").removeClass("highlighted")},
_destroy:function(){var a;this._super();for(a=0;a<this.tips.length;++a)this.tips[a].destroy();for(a=0;a<this.dds.length;++a)this.dds[a].destroy()}});a.Squarespace.DialogFieldGenerators.check=Class.extend(a.Squarespace.DialogField,{initialize:function(b,c,d){this._super(b,c,d);this.active=(void 0===c[this.config.name]?this.config.defaultValue:c[this.config.name])?!0:!1;this.html=a.DB.DIV("field-wrapper check-field-wrapper clear thin",this.config.padding?{style:"padding-top: "+this.config.padding[0]+
"; padding-bottom: "+this.config.padding[1]+";"}:null,a.DB.DIV("check-element "+(this.active?"active":""),this.config.title?a.DB.DIV("field-title",{html:this.config.title}):null,this.config.description?a.DB.DIV("field-description-wrapper",a.DB.DIV("field-description",{html:this.config.description})):null));b.hidden&&this.temporaryHide(!0);this.panel.bodyEvents.push(a.on("click",this.onClick,this.html,this))},onClick:function(a){this.setValue(!this.active);this.panel.fire("datachange",this);this.fire("changed",
this.getValue())},setValue:function(a){(this.active=a)?this.html.one(".check-element").addClass("active"):this.html.one(".check-element").removeClass("active")},getValue:function(){return this.active},didDataChange:function(){return!this.initialData[this.getName()]&&!this.getValue()?!1:this._super()}});a.Squarespace.DialogFieldGenerators.text=Class.extend(a.Squarespace.DialogField,{initialize:function(b,c,d){this.hideAnim=null;this._super(b,c,d);c=c[this.config.name];if(a.Lang.isUndefined(c)||a.Lang.isNull(c))c=
"";this.control=a.DB.INPUT("field-input "+(this.config.className?this.config.className:""),{type:this.config.password?"password":"text",spellcheck:"false",tabIndex:this.panel.getNextTabIndex(),value:c,style:(b.bold?"font-weight: bold;":"")+(b.width&&1<b.width?"width: "+b.width+"px;":""),maxLength:b.maxLength?b.maxLength:"",placeholder:this.config.placeholder?this.config.placeholder:""});this.config.readonly&&this.control.setAttribute("readonly",!0);this.config.titleStyle||(this.config.titleStyle=
"top");this.config.style||(this.config.style="normal");this.config.filter||(this.config.filter="none");this.config.icon||(this.config.icon="none");if("minor"==this.config.style)this.html=a.DB.DIV("field-wrapper text-field-wrapper clear minor dialog-field-"+this.config.name,a.DB.DIV("field-rhs",a.DB.DIV("field-input-wrapper",this.control),this.config.title&&"top"==this.config.titleStyle?a.DB.DIV("field-lhs",{html:this.config.title}):null,this.config.description?a.DB.DIV("field-description-wrapper",
a.DB.DIV("field-description",{html:this.config.description})):null));else if("thin"==this.config.style||"small"==this.config.style)this.prefixEl=a.DB.DIV("field-lhs",{html:this.config.prefix}),this.html=a.DB.DIV("field-wrapper text-field-wrapper clear "+this.config.style+" dialog-field-"+this.config.name,this.config.title&&"small"!=this.config.style?a.DB.DIV("field-title",{html:this.config.title}):null,a.DB.DIV("field-wrapper-inner clear "+this.config.icon,this.prefixEl,a.DB.DIV("field-rhs",a.DB.DIV("field-input-wrapper",
this.control))),this.config.description?a.DB.DIV("field-description-wrapper",a.DB.DIV("field-description",{html:this.config.description})):null),this.errorFlyoutAnchor=this.html.one(".field-wrapper-inner");else if("normal"==this.config.style||"major"==this.config.style||"title"==this.config.style){if(this.config.prefixText)this.titleEl=a.DB.DIV("field-lhs left",{html:this.config.prefixText});else if(this.config.title&&("left"==this.config.titleStyle||"top"==this.config.titleStyle))this.titleEl=a.DB.DIV("field-lhs "+
this.config.titleStyle,{html:this.config.title});this.html=a.DB.DIV("field-wrapper text-field-wrapper clear "+this.config.style+" dialog-field-"+this.config.name,this.titleEl,a.DB.DIV("field-rhs",a.DB.DIV("field-input-wrapper",this.control),this.config.description?a.DB.DIV("field-description-wrapper",a.DB.DIV("field-description "+this.config.titleStyle,{html:this.config.description})):null))}this.config.hide&&this.html.setStyle("display","none");this.panel.bodyEvents.push(a.on("paste",this.onPaste,
this.control,this));this.panel.bodyEvents.push(a.on("keyup",this.onKeyUp,this.control,this));this.panel.bodyEvents.push(a.on("keypress",this.applyKeyFilter,this.control,this));this.panel.bodyEvents.push(a.on("keydown",this.onKeyDown,this.control,this));this.panel.bodyEvents.push(a.on("key",this.onSubmit,this.control,"down:13",this));this._subscribe([[this.control,"change",this.onChange]]);b.mailcheck&&this.control.plug(a.Squarespace.Plugin.MailCheck,{field:this})},onChange:function(){this.fire("change",
this.getValue());this.dialog.fire("datachange",this)},onPaste:function(b){a.later(1,this,function(){this.updateInlineTitle();this.updateTextSuffix()})},onKeyDown:function(a){9===a.keyCode?(this.updateInlineTitle(),this.updateTextSuffix()):d(a.keyCode)&&this.hideInlineTitle();27!==a.keyCode&&a.stopPropagation()},applyKeyFilter:function(b){if(this.config.keyFilter&&(0===a.UA.gecko||b._event.isChar)){var c=String.fromCharCode(b.which);!c.match(RegExp(this.config.keyFilter))&&0<c.length&&(this.config.keyFilterExplanation&&
this.showError(this.config.keyFilterExplanation),b.halt())}},onKeyUp:function(b){if("url-slug"===this.config.filter||"url-slug-with-slash"==this.config.filter){var c,e=this.control.get("value");c="url-slug"===this.config.filter?a.Squarespace.Utils.createUrl(e):a.Squarespace.Utils.createUrlWithSlash(e);var f=this.control._node.selectionStart-(32==b.keyCode?0:1);e!=c&&(this.control.set("value",c),this.control._node.selectionStart=f,this.control._node.selectionEnd=f)}this.config.syncedField&&this.panel.getField(this.config.syncedField).setValue(this.getValue());
d(b.keyCode)&&(this.panel.fire("keyup",this),this.updateInlineTitle(),this.updateTextSuffix(),this.panel.fire("datachange",this),this.clearError(),b.stopPropagation());13==b.keyCode&&this.fire("keyup-enter")},onSubmit:function(a){a.halt(!0);this.config.submitOnEnter&&this.dialog.saveAndClose();this.config.saveOnEnter&&this.panel.save()},isEmpty:function(){return!this.control?!1:0===this.control.get("value").length},enable:function(){this.html.removeClass("disabled");this.control.set("disabled","")},
disable:function(){this.html.addClass("disabled");this.control.set("disabled","true")},showInlineTitle:function(){null!==this.hideAnim&&(this.hideAnim.stop(),this.hideAnim=null);if(null==this.control.getDOMNode()||null==this.html.getDOMNode())console.warn("Text field DOM nodes in invalid states. Bailing.");else{this.inlineTitle||(this.inlineTitle=a.DB.DIV("inline-field-title "+this.config.style,{html:this.config.title}),this.inlineTitle.event=a.on("click",this.focus,this.inlineTitle,this),null!==
this.html.getDOMNode()?a.one(this.html).append(this.inlineTitle):console.warn('Text Field "html" property is null.'));var b,c;switch(this.config.style){case "major":b=16;break;case "title":b=17;break;case "small":b=3;break;default:b=15}this.config.prefixText&&(b+=110);c=this.control.get("offsetTop")+(this.control.get("offsetHeight")-this.inlineTitle.get("offsetHeight"))/2;this.currentXY=[b+26,c];this.inlineTitle.setStyles({left:this.currentXY[0]+"px",top:this.currentXY[1]+"px",opacity:1})}},hideInlineTitle:function(){null!==
this.hideAnim&&(this.hideAnim.stop(),this.hideAnim=null);this.inlineTitle&&this.inlineTitle.inDoc()&&(this.hideAnim=this._anim({node:this.inlineTitle,from:{opacity:1},to:{opacity:0},duration:0.05,easing:a.Easing.easeOutStrong}),this.hideAnim.on("end",function(){this.inlineTitle.event.detach();this.inlineTitle.remove();this.hideAnim=this.inlineTitle=null},this),this.hideAnim.run())},updateInlineTitle:function(){"inline"==this.config.titleStyle&&(this.isEmpty()?this.showInlineTitle():this.hideInlineTitle())},
showTextSuffix:function(){var b=null,c=10,d=6;"major"==this.config.style&&(c=12,d=11);"title"==this.config.style&&(c=19,d=10);"small"==this.config.style&&(d=c=3);this.textSuffixwrapper||(b=a.DB.DIV("suffix inline-field-title "+this.config.style,{style:"position: relative;",html:this.config.suffix}),b.setStyles({top:d+"px",opacity:1}),this.textSuffixwrapper=a.DB.DIV("suffix-wrapper",b),this.textSuffixwrapper.setStyle("height",this.control.get("offsetHeight")+"px"),this.textSuffixwrapper.setStyle("width",
this.control.get("offsetWidth")+"px"),this.textSuffixwrapper.setStyle("top",d+"px"),this.textSuffixwrapper.setStyle("overflow","hidden"),this.textSuffixwrapper.setStyle("position","absolute"),this.textSuffixwrapper.event=this.textSuffixwrapper.on("click",this.focus,this),a.one(this.html.one(".field-input-wrapper")).append(this.textSuffixwrapper),this.measurementEl=a.DB.DIV("measurement-el inline-field-title "+this.config.style,{style:"position: absolute; opacity: 0;",html:""}),a.one(this.html.one(".field-input-wrapper")).append(this.measurementEl));
if(null===b)this.textSuffixwrapper.one(".suffix");b=this.getValue().replace(/ /g,".");this.measurementEl.setContent(b);c+=this.measurementEl.get("offsetWidth");b=this.control.get("offsetWidth");this.textSuffixwrapper.setStyle("width",b-c+"px");this.textSuffixwrapper.setStyle("left",23+c+"px");this.textSuffixwrapper.setStyle("top","0px")},hideTextSuffix:function(){this.textSuffixwrapper&&(this.textSuffixwrapper.remove(),this.textSuffixwrapper.event.detach(),this.textSuffixwrapper=null,this.measurementEl.remove())},
updateTextSuffix:function(){this.config.suffix&&(this.isEmpty()?this.hideTextSuffix():this.showTextSuffix())},resize:function(){var a;"left"==this.config.titleStyle?(a=parseInt(this.html.getStyle("width"),10)-parseInt(this.titleEl.get("offsetWidth"),10),this.control.setStyle("width",a+"px")):"thin"==this.config.style&&(a=parseInt(this.html.getStyle("width"),10)-parseInt(this.html.getStyle("paddingLeft"),10)-parseInt(this.html.getStyle("paddingRight"),10),this.control.setStyle("width",a-this.prefixEl.get("offsetWidth")-
(""!==this.config.icon?18:0)+"px"))},focus:function(a){a&&a.halt();this.control&&this.control.focus()},show:function(){"inline"==this.config.titleStyle&&(this.isEmpty()?this.showInlineTitle():this.updateTextSuffix());this._super()},hide:function(){"inline"==this.config.titleStyle&&this.hideInlineTitle();this._super()},getErrors:function(){var a=this._super();return this.config.required&&""===this.control.get("value")?["Required field."]:a},getValue:function(){return this.control.get("value")},setValue:function(a){this.control&&
(this.control.set("value",void 0!==a?a:""),this.updateInlineTitle(),this.updateTextSuffix(),this.clearError())},_destroy:function(){this._super();this.testSuffixwrapper&&this.testSuffixwrapper.event&&this.testSuffixwrapper.event.detach()}});a.Squarespace.DialogFieldGenerators.textarea=Class.extend(a.Squarespace.DialogField,{initialize:function(b,c,e){this.hideAnim=null;this._super(b,c,e);this.control=a.DB.TEXTAREA("field-textarea",{tabIndex:e.getNextTabIndex()});this.config.titleStyle||(this.config.titleStyle=
"top");c[this.config.name]&&this.control.set("value",c[this.config.name]);this.fieldTitleEl=this.config.title&&"top"==this.config.titleStyle?a.DB.DIV("field-lhs top",{html:this.config.title}):null;this.html=a.DB.DIV("field-wrapper textarea-field-wrapper clear "+this.config.style,this.fieldTitleEl,a.DB.DIV("field-rhs",a.DB.DIV("field-input-wrapper",this.control),this.config.description?a.DB.DIV("field-description-wrapper",a.DB.DIV("field-description",{html:this.config.description})):null));this.config.height&&
this.control.setStyle("height",this.config.height+"px");this.panel.bodyEvents.push(a.on("keydown",function(a){9===a.keyCode&&this.updateInlineTitle();a.stopPropagation()},this.control,this));this.panel.bodyEvents.push(a.on("keyup",function(a){if(d(a.keyCode)||13==a.keyCode)this.onDataChanged(a)},this.control,this));this.panel.bodyEvents.push(a.on("focus",this.onFocus,this.control,this));this.panel.bodyEvents.push(a.on("blur",this.onBlur,this.control,this));this.value&&this.setValue(c[this.config.name]);
this.config.hide&&this.html.setStyle("display","none")},isEmpty:function(){return!this.control?!1:0===this.control.get("value").length},enable:function(){this.html.removeClass("disabled");this.control.set("disabled","")},disable:function(){this.html.addClass("disabled");this.control.set("disabled","true")},showInlineTitle:function(){null!==this.hideAnim&&(this.hideAnim.stop(),this.hideAnim=null);this.inlineTitle||(this.inlineTitle=a.DB.DIV("inline-field-title textarea",{html:this.config.title}),this.currentXY=
[38,12],this.inlineTitle.setStyles({top:this.currentXY[1]+"px",left:this.currentXY[0]+"px",opacity:1}),this.inlineTitle.event=a.on("click",this.focus,this.inlineTitle,this),a.one(this.html).append(this.inlineTitle))},hideInlineTitle:function(){this.inlineTitle&&null===this.hideAnim&&(this.hideAnim=this._anim({node:this.inlineTitle,from:{opacity:1},to:{opacity:0},duration:0.05,easing:a.Easing.easeOutStrong}),this.hideAnim.on("end",function(){this.inlineTitle.event.detach();this.inlineTitle.remove();
this.hideAnim=this.inlineTitle=null},this),this.hideAnim.run())},updateInlineTitle:function(){"inline"==this.config.titleStyle&&(this.isEmpty()?this.showInlineTitle():this.hideInlineTitle())},focus:function(){this.control.focus()},onDataChanged:function(a){this.updateInlineTitle();this.panel.fire("datachange",this);this.clearError()},onBlur:function(){window.CONFIG_PANEL&&window.CONFIG_PANEL.set("allowContextMenu",!1)},onFocus:function(){window.CONFIG_PANEL&&window.CONFIG_PANEL.set("allowContextMenu",
!0)},show:function(){"inline"==this.config.titleStyle&&this.isEmpty()&&this.showInlineTitle()},hide:function(){"inline"==this.config.titleStyle&&this.hideInlineTitle()},getTakenHeight:function(){return this.config.verticalSpan?this.html.get("offsetHeight")-this.control.get("offsetHeight"):this.html.get("offsetHeight")},getValue:function(){return this.control.get("value")},setValue:function(a){this.control.set("value",a?a:"");this.updateInlineTitle();this.clearError()}});a.Squarespace.DialogFieldGenerators.progress=
Class.extend(a.Squarespace.DialogField,{initialize:function(b,c,d){this._super(b,c,d);this.config=b;this.panel=d;this.control=a.DB.DIV("field-progress-inner",{html:"&nbsp;",style:"width: 0px;"});this.controlContainer=a.DB.DIV("field-progress-wrapper",this.control);this.html=a.DB.DIV("field-wrapper clear",this.config.title?a.DB.DIV("field-lhs",{html:this.config.title}):null,a.DB.DIV("field-rhs",this.controlContainer))},setMessage:function(a){this.control.set("innerHTML",'<div class="text dialog-element">'+
a+"</div>")},setProgress:function(b,c){1<b&&(b=1);0>b&&(b=0);this.a=this._anim({node:this.control,to:{width:Math.round(b*this.controlContainer.get("offsetWidth")-6)},duration:0.25,easing:a.Easing.easeOutStrong});if(c)this.a.on("end",function(){this.control.set("innerHTML",'<div class="text dialog-element">'+c+"</div>");this.a=null},this);else this.a.on("end",function(){this.control.set("innerHTML",'<div class="text dialog-element">'+Math.round(100*b)+"%</div>");this.a=null},this);this.a.run();this.previousPercentage=
b},hide:function(){this.a&&this.a.stop()}});a.Squarespace.DialogFieldGenerators.html=Class.extend(a.Squarespace.DialogField,{initialize:function(b,c,d){this._super(b,c,d);this.html=("string"==typeof this.config.html?a.Node.create(this.config.html):this.config.html.cloneNode(!0)).addClass("field-wrapper clear html-field"+("name"in this.config?" "+this.config.name:"")+("className"in this.config?" "+this.config.className:""))},getNode:function(){return this.getWrapperNode()},getWrapperNode:function(){return this.html},
getContent:function(){return this.html.getContent()},setContent:function(a){this.html.setContent(a)}});a.Squarespace.DialogFieldGenerators.description=Class.extend(a.Squarespace.DialogField,{initialize:function(b,c,d){this._super(b,c,d);this.config=b;this.panel=d;this.config.text||(this.config.text="");this.html=a.DB.DIV("field-wrapper clear",a.DB.DIV("custom-field-description "+(this.config.className?this.config.className:""),{html:this.config.title?'<div class="title">'+this.config.title+'</div><div class="text">'+
this.config.text+"</div>":this.config.text,style:(this.config.width&&1<this.config.width?"width: "+this.config.width+"px;":"")+(this.config.padding?"padding-top: "+this.config.padding[0]+"px;":"")+(this.config.padding?"padding-bottom: "+this.config.padding[1]+"px;":"")}))},setTitle:function(a){this.html.one(".title").setContent(a)},setText:function(a){a=this.config.title?'<div class="title">'+this.config.title+'</div><div class="text">'+a+"</div>":a;this.html.one(".custom-field-description").setContent(a)},
onClick:function(a){this.panel.fire("click",this.config.name)}});a.Squarespace.DialogFieldGenerators.link=Class.extend(a.Squarespace.DialogField,{initialize:function(b,c,d){this._super(b,c,d);this.config=b;this.panel=d;this.html=a.DB.DIV("field-wrapper clear active custom-field-link "+(this.config.className?this.config.className:""),{html:"<span>"+(this.config.href?'<a href="'+this.config.href+'">'+this.config.title+"</a>":this.config.title)+"</span>"});b.align&&this.html.setStyle("textAlign",b.align);
this.html.on("click",this.onClick,this)},onClick:function(a){this.panel.fire("link-"+this.config.name,this.config.name)}});a.Squarespace.DialogFieldGenerators["section-title"]=Class.extend(a.Squarespace.DialogField,{initialize:function(b,c,d){this._super(b,c,d);this.config=b;this.panel=d;this.value=null;this.titleRhs=[];this.tabEls={};if(this.config.tabs)for(b=0;b<this.config.tabs.length;++b)c=this.config.tabs[b],this.tabEls[c.name]=a.DB.DIV("tab",{html:c.title,data:{value:c.name}}),this.titleRhs.push(this.tabEls[c.name]),
c.active&&(this.tabEls[c.name].addClass("active"),this.activeEl=this.tabEls[c.name],this.value=c.name);this.html=a.DB.DIV("field-wrapper clear",a.DB.DIV("nothing",{style:(this.config.padding?"padding-top: "+this.config.padding[0]+"px;":"")+(this.config.padding?"padding-bottom: "+this.config.padding[1]+"px;":"")},a.DB.DIV("field-section-title clear "+this.config.className,a.DB.DIV("lhs",{html:this.config.text}),a.DB.DIV("rhs",this.titleRhs))));this.panel.bodyEvents.push(a.on("click",this.onClick,this.html,
this))},onClick:function(b){b.target.hasClass("tab")&&(this.activeEl&&this.activeEl.removeClass("active"),b.target.addClass("active"),this.activeEl=b.target,this.value=a.DB.unpackData(b.target).value,this.config.linkFrame&&this.panel.getField(this.config.linkFrame).show(this.value),this.panel.fire("datachange",this))},getValue:function(){return this.value}});a.Squarespace.DialogFieldGenerators.rating=Class.extend(a.Squarespace.DialogField,{initialize:function(b,c,d){this._super(b,c,d);this.config=
b;this.panel=d;this.active=c[this.config.name]?!0:!1;this.value=0;this.control=a.DB.DIV("rating-slider");this.html=a.DB.DIV("field-wrapper",a.DB.DIV("rating-field-wrapper",a.DB.DIV("rating-element",a.DB.DIV("rating-overlay"),this.control)));this.panel.bodyEvents.push(a.on("mousedown",this.onClick,this.html,this));this.setValue(c.rating?c.rating:0)},onClick:function(a){a=a.pageX-this.html.one(".rating-element").getX();for(var c=0,d=0;11>d;d++)if(0<13*d-a){c=d;break}this.value=c/2;this.control.setStyle("width",
13*c)},setValue:function(a){0>a||5<a||(this.value=Math.round(2*a)/2,this.control.setStyle("width",26*this.value))},getValue:function(){return this.value?this.value:0}});a.Squarespace.DialogFieldGenerators["social-accounts"]=Class.extend(a.Squarespace.DialogField,{initialize:function(b,c,d){this._super(b,c,d);this.config=b;this.panel=d;this.config.networks="facebook twitter foursquare google tumblr email blogger linkedin reddit stumbleupon".split(" ");this.accountContainerEl=a.DB.DIV("social-accounts");
this.html=a.DB.DIV("field-wrapper social-adder-wrapper",a.DB.DIV("header",a.DB.DIV("title",{html:"Social Links"}),a.DB.DIV("description",{html:"Add your social links."})),this.accountContainerEl);this.html.append(this.chooser);this.panel.bodyEvents.push(a.on("click",this.onClick,this.html,this));this.panel.bodyEvents.push(a.on("keyup",this.onKeyUp,this.html,this));c[this.config.name]?this.render(c[this.config.name]):this.accountContainerEl.append(this.renderSocialAccount({type:this.config.networks[0],
username:""}))},onKeyUp:function(a){this.panel.fire("datachange",this)},onClick:function(a){var c=a.target,d=c.ancestor(".social-account",!0);!c.hasClass("logo")&&(!c.hasClass("chooser-button")&&this.activeEl)&&this.hideChooser(this.activeEl);a.halt();if(c.hasClass("logo"))this.toggleChooser(d);else if(c.hasClass("plus"))this.getCount()>=this.config.maxCount||(this.showChooser(d.insert(this.renderSocialAccount({type:this.config.networks[0],username:""}),"after").next()),this.panel.fire("datachange",
this));else if(c.hasClass("minus"))d.remove(),1>this.getCount()&&this.accountContainerEl.append(this.renderSocialAccount({type:this.config.networks[0],username:""})),this.panel.fire("datachange",this);else if(c.hasClass("chooser-button")){c=d.one(".logo");d.one(".chooser");this.clearSocial(c);for(var f=this.config.networks,g=0;g<f.length;g++)a.target.hasClass(f[g])&&(c.addClass(f[g]),d.one(".type").set("text",f[g]));this.hideChooser(d);this.panel.fire("datachange",this)}},clearSocial:function(a){for(var c=
this.config.networks,d=0;d<c.length;d++)console.log(c[d]),a.removeClass(c[d])},toggleChooser:function(a){a.one(".logo").hasClass("active")?this.hideChooser(a):this.showChooser(a)},hideChooser:function(b){b.one(".logo").removeClass("active");this.activeEl=null;this._anim({node:b.one(".chooser"),to:{width:0},duration:0.25,easing:a.Easing.easeOutStrong}).run()},showChooser:function(b){var c=b.one(".chooser");a.all(".social-account .chooser").setStyle("width","0");var d=this._anim({node:c,to:{width:154},
duration:0.25,easing:a.Easing.easeOutStrong});this._subscribe(d,"end",function(){var a=this.panel.bodyEl,b=c.get("region").bottom,d=a.get("region").bottom;a.hasClass("scrollable")&&b>d&&a.set("scrollTop",a.get("scrollHeight"))},this);d.run();b.one(".logo").addClass("active");this.activeEl=b},renderSocialAccount:function(b,c){for(var d=a.DB.DIV("chooser-container"),f=this.config.networks,g=0;g<f.length;g++)d.append(a.DB.DIV("chooser-button "+f[g]));return a.DB.DIV("social-account "+(c?"hidden":""),
a.DB.DIV("logo "+(b.type?b.type:""),a.DB.DIV("chooser",d)),a.DB.DIV("type",{html:b.type}),a.DB.INPUT("username",{value:b.username,placeholder:"Enter Username",maxlength:30,spellcheck:!1,autocomplete:!1}),a.DB.DIV("buttons",a.DB.DIV("plus"),a.DB.DIV("minus")))},render:function(a){this.accountContainerEl.set("innerHTML","");if(a)for(var c=0;c<a.length;c++)this.accountContainerEl.append(this.renderSocialAccount(a[c]))},getValue:function(){var a=[];this.accountContainerEl.all(".social-account").each(function(c){c=
{type:c.one(".type").get("text"),username:c.one("input").get("value").replace(" ","")};0<c.username.length&&a.push(c)},this);return a},setValue:function(a){this.render(a)},getCount:function(){var a=0;this.accountContainerEl.all(".social-account").each(function(c){a++},this);return a}});a.Squarespace.DialogFieldGenerators["date-picker"]=Class.extend(a.Squarespace.DialogField,{_name:"date-picker",_defaultOptions:{"yui3-calendar":{showPrevMonth:!0,showNextMonth:!0,width:"100%",height:"100%",selectionMode:"single"}},
initialize:function(b,c,d){this._super(b,c,d);this.config=a.merge(this._defaultOptions,b);this.calendarOptions=a.merge(this._defaultOptions["yui3-calendar"]);b["yui3-calendar"]&&(this.calendarOptions=a.merge(this.calendarOptions,b["yui3-calendar"]));c[this.config.name]&&(this.calendarOptions.date=new Date(c[this.config.name]));this.config.width&&(this.calendarOptions.width=this.config.width);this.config.height&&(this.calendarOptions.height=this.config.height);this.calendar=new a.Calendar(this.calendarOptions);
this.html=a.DB.DIV("field-wrapper clear"+(this.config.className?this.config.className:"")+" date-picker");this.calendarWrapper=a.DB.DIV("calendar-wrapper");this.html.append(this.calendarWrapper);this._subscribe(this.calendar,"dateClick",this.onSelectionChange);this.value=c[this.config.name]||null;this.calendar.selectDates([new Date(this.value)]);this.render()},render:function(){this.calendar.render(this.calendarWrapper)},focus:function(){this.calendar.focus()},enable:function(){this.html.removeClass("disabled");
this.calendar.enable()},disable:function(){this.html.addClass("disabled");this.calendar.disable()},getValue:function(){return this.value?this.value.valueOf():null},onSelectionChange:function(a){this.value=a.date},setValue:function(b){this._super(b);a.Lang.isValue(b)&&(this.calendar.deselectDates(),this.calendar.selectDates([this._shiftToWebsiteTimeZone(b)]))},_destroy:function(){this.calendar.destroy()},_shiftToWebsiteTimeZone:function(b){b=new Date(b);var c=a.Squarespace.DateUtils.getTimeOffsetToWebsiteTimezone(b);
b.setMinutes(b.getMinutes()+c);return b},_shiftFromWebsiteTimeZone:function(b){b=new Date(b);var c=a.Squarespace.DateUtils.getTimeOffsetToWebsiteTimezone(b);b.setMinutes(b.getMinutes()-c);return b}});a.Squarespace.DialogFieldGenerators["datetime-picker"]=Class.extend(a.Squarespace.DialogFieldGenerators["date-picker"],{_name:"datetime-picker",initialize:function(b,c,d){this._super(a.merge({dateFormat:"%A, %B %d %Y at %I:%M%p"},b),c,d);c[b.name]?this.setValue(new Date(c[b.name])):this.config.clearable?
this.setValue(null):this.setValue(new Date)},render:function(){this._renderPicker();this._renderLabel()},_renderPicker:function(){this.html=a.DB.DIV("field-wrapper clear "+(this.config.className?this.config.className:"")+" datetime-picker-field");this.calendarWrapper=a.DB.DIV("calendar-wrapper");var b=new Date(this.value);this.hourControl=a.DB.INPUT("time-control hour",{maxlength:2,style:"text-align: right;"});this.minuteControl=a.DB.INPUT("time-control minute",{maxlength:2,style:"text-align: left;"});
this.ampmControl=a.DB.INPUT("time-control ampm",{maxlength:2,style:"text-align: left; width: 36px;"});this.timeWrapper=a.DB.DIV("time-wrapper",a.DB.DIV("time-wrapper-content",this.hourControl,a.DB.DIV("time-control",{html:":",style:"display:inline-block;width: 5px; border: 0px"}),this.minuteControl,this.ampmControl));b&&this.updateFlyout(b);this.calendar.render(this.calendarWrapper);this.dateFlyoutEvents=[a.on("keyup",this.onTimeFieldKeyUp,this.hourControl,this),a.on("keyup",this.onTimeFieldKeyUp,
this.minuteControl,this),a.on("keydown",this.onTimeFieldKeyDown,this.hourControl,this),a.on("keydown",this.onTimeFieldKeyDown,this.minuteControl,this),a.on("keydown",this.onTimeFieldKeyDown,this.ampmControl,this),a.on("blur",this.onTimeFieldBlur,this.hourControl,this),a.on("blur",this.onTimeFieldBlur,this.minuteControl,this),a.on("click",this.onTimeFieldClick,this.hourControl,this),a.on("click",this.onTimeFieldClick,this.minuteControl,this),a.on("click",this.onTimeFieldClick,this.ampmControl,this),
a.on("resize",this.onResize,a.one(window),this)];this.errorFlyoutAnchor=this.html},updateFlyout:function(b){this.hourControl.set("value",a.Lang.trim(a.Squarespace.DateUtils.dateFormat(b,{format:"%l"})));this.minuteControl.set("value",a.Squarespace.DateUtils.dateFormat(b,{format:"%M"}));this.ampmControl.set("value",a.Squarespace.DateUtils.dateFormat(b,{format:"%p"}));this.calendar.set("date",b)},_renderLabel:function(){this.label=a.DB.DIV("field-workflow-description",a.DB.SPAN("datetime-label",this.config.title+
"&nbsp;"),a.DB.SPAN("date","Feb 20 2012"));this.html.append(a.DB.DIV("date-picker-field",this.label));this.panel.bodyEvents.push(a.on("click",this.onDatetimeChangeRequest,this.label.one(".date"),this));if(this.config.clearable){var b=a.DB.DIV("remove-date",{html:"&nbsp;"});this.label.append(b);b.on("click",this.onClearDate,this)}},onClearDate:function(){this.setValue(null)},setValue:function(a){this._super(a);this.updateDisplay()},onDatetimeChangeRequest:function(a){this.flyout||(a.target.hasClass("date")?
(this.html.addClass("date-picker-active"),this.openFlyout(),this.calendarWrapper.one(".yui3-calendar").setStyle("width","auto"),this.refreshTimeField()):this.closeFlyout())},onResize:function(){this.flyout&&this.alignFlyout()},alignFlyout:function(){a.one(document.body).get("docScrollY");this.dateFlyoutWidth=this.flyout.get("offsetWidth");var b=this.label.getX()-(this.dateFlyoutWidth-this.label.get("offsetWidth"))/2-15,c=this.label.getY()+this.label.get("offsetHeight")+5;this.flyout.setXY([b,c])},
openFlyout:function(){this.label.getX();this.flyout=a.DB.DIV("workflow-flyout tight",a.DB.DIV("workflow-flyout-content",a.DB.DIV("flyout-notch-select-top"),a.DB.DIV("workflow-flyout-options",{style:"position:relative; top:-1px;"},a.DB.DIV("flyout-title","Select a Date & Time"),a.DB.DIV("flyout-calendar",this.calendarWrapper,this.timeWrapper))));a.one(document.body).append(this.flyout);this.flyout.one(".flyout-notch-select-top").setStyles({marginLeft:192});this.dateFlyoutHeight=this.flyout.get("offsetHeight");
this.dateFlyoutWidth=this.flyout.get("offsetWidth");this.flyout.setStyles({width:"400px",height:this.dateFlyoutHeight+"px",opacity:1});this.dateFlyoutContents=this.flyout.one(".workflow-flyout-content");this.dateFlyoutContents.setStyles({marginTop:-1*this.dateFlyoutHeight,opacity:0});this.alignFlyout();this._anim({node:this.dateFlyoutContents,to:{marginTop:0,opacity:1},duration:0.2,easing:a.Easing.easeOutStrong}).run();this.panel.setActiveFlyout({constraintClasses:".workflow-flyout, .calendar-wrapper",
field:this})},refreshTimeField:function(){this.value?(this.timeWrapper.removeClass("disabled"),this.hourControl.set("value",a.Squarespace.DateUtils.dateFormat(this.value,{format:"%I"})),this.minuteControl.set("value",a.Squarespace.DateUtils.dateFormat(this.value,{format:"%M"})),this.ampmControl.set("value",a.Squarespace.DateUtils.dateFormat(this.value,{format:"%p"}))):(this.timeWrapper.addClass("disabled"),this.hourControl.set("value","10"),this.minuteControl.set("value","00"),this.ampmControl.set("value",
"AM"))},updateDisplay:function(){this.label?this.value?(this.label.one(".date").setContent(a.Squarespace.DateUtils.dateFormat(this.value,{format:this.config.dateFormat})),this.html.removeClass("no-date")):(this.label.one(".date").setContent("Not Set"),this.html.addClass("no-date")):console.log("[datetime-picker] tried to update display but no label el was found")},closeFlyout:function(){if(this.flyout){this.html.removeClass("date-picker-active");var b=this.flyout.get("offsetHeight");animation=this._anim({node:this.dateFlyoutContents,
to:{marginTop:-1*b,opacity:0},duration:0.2,easing:a.Easing.easeOutStrong});animation.on("end",function(){this.flyout.remove();this.dateFlyoutContents=this.flyout=null},this);animation.run();this.panel.clearActiveFlyout()}},onTimeFieldKeyUp:function(a){a.target.hasClass("hour")?(a=parseInt(this.hourControl.get("value"),10),(12<a||1>a)&&this.hourControl.set("value",this.prevVal)):a.target.hasClass("minute")&&(a=parseInt(this.minuteControl.get("value"),10),(60<a||0>a)&&this.minuteControl.set("value",
this.prevVal));this._updateTime()},onTimeFieldClick:function(a){a.target.hasClass("hour")?this.hourControl.select():a.target.hasClass("minute")?this.minuteControl.select():a.target.hasClass("ampm")&&this.ampmControl.select()},onTimeFieldBlur:function(a){a.target.hasClass("hour")?(a=this.hourControl.get("value"),0===a.indexOf("0")&&this.hourControl.set("value",parseInt(a,10)),a=parseInt(a,10),(12<a||1>a)&&this.hourControl.set("value",12)):a.target.hasClass("minute")&&(a=parseInt(this.minuteControl.get("value"),
10),0<=a&&9>=a&&this.minuteControl.set("value","0"+a),a=parseInt(a,10),(60<a||0>a)&&this.minuteControl.set("value",0));this._updateTime()},onTimeFieldKeyDown:function(a){65==a.keyCode?(this.ampmControl.set("value","AM"),a.halt(),this._updateTime()):80==a.keyCode?(this.ampmControl.set("value","PM"),a.halt(),this._updateTime()):13==a.keyCode?this.closeFlyout():a.target.hasClass("hour")?186==a.keyCode?(this.minuteControl.select(),a.halt()):(57<a.keyCode||48>a.keyCode)&&(96>a.keyCode||105<a.keyCode)&&
9!=a.keyCode&&37!=a.keyCode&&39!=a.keyCode&&16!=a.keyCode&&46!=a.keyCode&&8!=a.keyCode?a.halt():this.prevVal=this.hourControl.get("value"):a.target.hasClass("minute")?32==a.keyCode?(this.ampmControl.select(),a.halt()):(57<a.keyCode||48>a.keyCode)&&(96>a.keyCode||105<a.keyCode)&&9!=a.keyCode&&37!=a.keyCode&&39!=a.keyCode&&16!=a.keyCode&&46!=a.keyCode&&8!=a.keyCode?a.halt():this.prevVal=this.minuteControl.get("value"):a.target.hasClass("ampm")&&9!=a.keyCode&&a.halt()},_updateTime:function(){var b=parseInt(this.hourControl.get("value"),
10),c=parseInt(this.minuteControl.get("value"),10),d=this.ampmControl.get("value");if(!isNaN(b)&&!isNaN(c)){if(12<b||0>=b)b=12;if(60<c||0>c)c=0;12==b&&"AM"==d?b=0:12!=b&&"PM"==d&&(b+=12);d=new Date(this.value.getTime());b-=a.Lang.trim(a.Squarespace.DateUtils.dateFormat(d,{format:"%H"}));c-=a.Lang.trim(a.Squarespace.DateUtils.dateFormat(d,{format:"%M"}));d.setHours(d.getHours()+b);d.setMinutes(d.getMinutes()+c);this.setValue(d);this.updateDisplay()}},onSelectionChange:function(a){if(this.label){a=
a.date;var c=this._shiftToWebsiteTimeZone(this.value.getTime());c.set({year:a.getFullYear(),month:a.getMonth(),day:a.getDate(),second:0,millisecond:0});this.setValue(this._shiftFromWebsiteTimeZone(c.getTime()));this.updateDisplay()}}});a.Squarespace.DialogFieldGenerators["textbox-datetime-picker"]=Class.extend(a.Squarespace.DialogFieldGenerators["datetime-picker"],{initialize:function(b,c,d){this._super(b,c,d);a.Squarespace.EscManager.addTarget(this);b["yui3-calendar"]&&(this.maximumDate=b["yui3-calendar"].maximumDate)},
getValue:function(){return null!==this.value?this.value.valueOf():null},render:function(){this._renderPicker();this.label=a.Node.create('<input type = "text" class = "field-input date" spellcheck="false"/>');a.Lang.isValue(this.config.title)&&(this.title=a.Node.create('<div class="title">'+this.config.title+"</div>"),this.html.append(this.title));this.html.append(this.label);this.panel.bodyEvents.push(a.on("click",this.onDatetimeChangeRequest,this.label,this));this.label.on("keyup",function(b){d(b.keyCode)&&
(this.lastChangeTime=(new Date).valueOf(),a.later(500,this,this.onKeyup,[this.lastChangeTime]))},this);this.label.on("blur",this.updateDisplay,this)},updateDisplay:function(){if(this.value){var b=a.Squarespace.DateUtils.dateFormat(this.value,{format:"%D @ %I:%M %p"});this.label.set("value",b)}else this.label.set("value","")},closeFlyout:function(){this._super();this.updateDisplay()},onKeyup:function(b){b=new Date(this.label.get("value"));a.Lang.isNumber(b.valueOf())&&(this.value=b,this.calendar.deselectDates(),
this.updateFlyout(b),this.calendar.selectDates([b]))},onSelectionChange:function(b){b=b.date;var c=this.value?new Date(this.value):new Date;b&&(b.setHours(c.getHours()),b.setMinutes(c.getMinutes()),a.DataType.Date.isGreater(b,this.maximumDate)?this.setValue(c):(this.value=b,this.label&&(""===this.label.get("value")||b.valueOf()!==c.valueOf())&&this.updateDisplay()))},_destroy:function(){this._super();a.Squarespace.EscManager.removeTarget(this)},close:function(){this.closeFlyout()}});a.Squarespace.DialogFieldGenerators.picker=
Class.extend(a.Squarespace.DialogField,{_name:"Picker",initialize:function(b,c,d){this._super(b,c,d);this.control=a.DB.DIV("field-input-wrapper select",{html:"test"});this.html=a.DB.DIV("field-wrapper picker clear");this.valueToNode={};this.value=c[this.config.name]},render:function(){var b=a.DB.DIV("options-wrapper");this.config.groups||this.renderGroup(b,this.config.data);b.delegate("click",this.onClick,".option",this);this.html.append(b);this.value&&this.setValue(this.value)},onClick:function(a){a=
a.target.ancestor(".option",!0).getData("value");this.setValue(a)},setValue:function(a){var c=this.getValue();this._super(a);this.panel.fire("datachange",this);this.isValidValue(a)&&(c&&this.getNode(c).removeClass("active"),this.getNode(a).addClass("active"));this.dialog.edited=!0},renderGroup:function(b,c){a.Array.each(c,function(c){var d=a.DB.DIV("option",{data:{value:c.value}},a.DB.DIV("title",{html:c.title}),c.description?a.DB.DIV("description",{html:c.description}):null);this.registerNode(c.value,
d);b.append(d)},this);return b},show:function(){this.render()},registerNode:function(a,c){this.valueToNode[a]=c},getNode:function(a){return this.valueToNode[a]},isValidValue:function(a){if(!this.config.groups)for(var c=0;c<this.config.data.length;c++)if(this.config.data[c].value==a)return!0;return!1}});a.Squarespace.DialogFieldGenerators.email=Class.extend(a.Squarespace.DialogFieldGenerators.text,{initialize:function(a,c,d){this._super(a,c,d)},isValid:function(){for(var a=this.control.get("value"),
c=[this._validateExistence,this._validateFormat],d=!0,f=0;f<c.length;f++){var g=c[f],d=d&&g.call(this,a);if(!d)break}return d},getErrors:function(){var b=this.control.get("value");return[this._validateFormat,this._validateExistence].map(function(a){return a.call(this,b)},this).filter(a.Lang.isString)},_validateExistence:function(a){var c=!0;this.config.required&&""===a&&(c=!1);return!c?"Required field":null},_validateFormat:function(b){return!a.Squarespace.EmailUtils.isValid(b)?"The email address you entered is invalid.":
null}});a.Squarespace.DialogFieldGenerators.numeric=Class.extend(a.Squarespace.DialogFieldGenerators.text,{initialize:function(a,c,d){this._super(a,c,d);void 0===c[a.name]&&void 0!==this.config.defaultValue&&this.setValue(Number(this.config.defaultValue))},didDataChange:function(){return this.initialData[this.getName()]!=Number(this.getValue())},getErrors:function(){var b=this._super();return this.config.required&&(""===this.getValue().trim()||!a.Lang.isNumber(Number(this.getValue())))?["This must be a numeric value."]:
b}});a.Squarespace.DialogFieldGenerators.url=Class.extend(a.Squarespace.DialogFieldGenerators.text,{initialize:function(b,c,d){this._super(b,c,d);this.panel=d;a.DB.DIV("internal-linker",a.DB.DIV("icon"))}})},"1.0.0",{requires:"node datatype-date node-focusmanager anim dd attribute slider datatable json widget node-event-simulate calendar squarespace-gizmo squarespace-dombuilder squarespace-debugger squarespace-toggle squarespace-node-flyout squarespace-structured-input squarespace-mailcheck squarespace-util squarespace-date-utils squarespace-dialog-fields".split(" ")});
